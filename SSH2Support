

!String publicMethods !

findDelimiters: delimiters startingAt: start 
	"Answer the index of the character within the receiver, starting at start, that matches one of the delimiters. If the receiver does not contain any of the delimiters, answer size + 1."

	start to: self size do: [:i |
		delimiters do: [:delim | delim = (self at: i) ifTrue: [^ i]]].
	^ self size + 1!

findTokens: delimiters
	"Answer the collection of tokens that result from parsing self.  Return strings between the delimiters.  Any character in the Collection delimiters marks a border.  Several delimiters in a row are considered as just one separation.  Also, allow delimiters to be a single character."

	| tokens keyStart keyStop separators |

	tokens := OrderedCollection new.
	separators := delimiters class == Character 
		ifTrue: [ Array with: delimiters ]
		ifFalse: [ delimiters ].
	keyStop := 1.
	[keyStop <= self size] whileTrue:
		[keyStart := self skipDelimiters: separators startingAt: keyStop.
		keyStop := self findDelimiters: separators startingAt: keyStart.
		keyStart < keyStop
			ifTrue: [tokens add: (self copyFrom: keyStart to: (keyStop - 1))]].
	^tokens!

skipDelimiters: delimiters startingAt: start 
	"Answer the index character within the receiver, starting at start, that does NOT match one of the delimiters. If the receiver does not contain any of the delimiters, answer size + 1.  Assumes the delimiters to be a non-empty string."

	start to: self size do: [:i |
		delimiters detect: [:delim | delim = (self at: i)]
				ifNone: [^ i]].
	^ self size + 1!

sshLong
	"Answer a 32bit value converted from network order to host order."

	^self sshLongAt: 1!

sshLongAt: anInteger
	"Answer a 32bit value converted from network order to host order."

	| index |
	index := anInteger - 1 * 4.
	^((self uint8At: index) bitShift: 24) + ((self uint8At: index + 1) bitShift: 16) +
		((self uint8At: index + 2) bitShift: 8) + (self uint8At: index + 3)!

sshLongAt: longIndex from: startIndex
	"Answer a 32bit value converted from network order to host order."

	| index |
	index := longIndex - 1 * 4 + startIndex - 1.
	^((self uint8At: index) bitShift: 24) + ((self uint8At: index + 1) bitShift: 16) +
		((self uint8At: index + 2) bitShift: 8) + (self uint8At: index + 3)! !


Object subclass: #CompressionAlgorithm
    instanceVariableNames: ''
    classVariableNames: ''
    poolDictionaries: ''!

!CompressionAlgorithm class publicMethods !

description

	^self subclassResponsibility!

fromDescription: aString

	^(self allSubclasses
			detect: [:each | each description = aString])
				new
		!

isAbstract

	^self == ##(self)! !

!CompressionAlgorithm publicMethods !

compress: aString
	"Answer a string with compressed data of <aString>."

	^self subclassResponsibility! !

CompressionAlgorithm initializeAfterLoad!


CompressionAlgorithm subclass: #NullCompression
    instanceVariableNames: ''
    classVariableNames: ''
    poolDictionaries: ''!

!NullCompression class publicMethods !

description

	^'none'! !

!NullCompression publicMethods !

compress: aString
	"Answer a string with compressed data of <aString>."

	^aString! !

NullCompression initializeAfterLoad!


Object subclass: #DiffieHellman
    instanceVariableNames: ''
    classVariableNames: ''
    poolDictionaries: ''!

!DiffieHellman class publicMethods !

fromDescription: aString

	^(self allSubclasses
			detect: [:each | each description = aString])
				new
		!

isAbstract

	^self == ##(self)! !

!DiffieHellman publicMethods !

byteFromBinary: aString

	| value |
	value := 0.
	aString reverse doWithIndex: [:each :index | 
		each = $1 ifTrue: [value := value + (2 raisedTo: index - 1)]].
	^value asCharacter!

correctKey: aKey
	"Answer a string which represents <aKey> without redundant zeros, adding positive byte flag if neccesary."

	| correctKey |
	"Eliminate redundand 0's."
	correctKey := aKey.
	[correctKey first value = 0] whileTrue: [
		correctKey := correctKey copyFrom: 2 to: correctKey size].
	"Add 0 for positive."
	^(correctKey first value bitAnd: 128) = 0 
		ifTrue: [correctKey]
		ifFalse: [0 asCharacter asString, correctKey]
	!

createNewKeyFor: serverKey randomValue: aNumber
	"Answer a new generated key using <serverKey> and <aNumber>."

	| bytesValue key |
	bytesValue := self integerFromString: serverKey.
	key := self raise: bytesValue toInteger: aNumber modulo: self initialPrime.
	^self correctKey: (self integerToString: key bits: 1024)!

generateKey: keyLength x: x

	| p q g e |
	p := self initialPrime.
	q := 1.
	q := q bitShift: 2 * keyLength.
	q := q - 1.
	g := 2.
	e := self raise: g toInteger: x modulo: p.
	^self correctKey: (self integerToString: e bits: 1032)
	!

initialPrime
	"Answer the initial prime for diffie-hellman key."

	^self initialPrimeHexValue abrAsInteger: 16!

initialPrimeHexValue
	"Answer a string with the representation of the initial prime of the receiver."

	^self subclassResponsibility!

integerFromString: aString
	"Answer the integer represented in <aString> using little endian representation."

	| value char baseIndex |
	value := 0.
	aString reverse doWithIndex: [:each :index | 
		char := each value.
		baseIndex := index - 1 * 8.
		value := value 	+ ((char bitAt: 1) * (2 raisedTo: baseIndex))
										+ ((char bitAt: 2) * (2 raisedTo: baseIndex + 1))
										+ ((char bitAt: 3) * (2 raisedTo: baseIndex + 2))
										+ ((char bitAt: 4) * (2 raisedTo: baseIndex + 3))
										+ ((char bitAt: 5) * (2 raisedTo: baseIndex + 4))
										+ ((char bitAt: 6) * (2 raisedTo: baseIndex + 5))
										+ ((char bitAt: 7) * (2 raisedTo: baseIndex + 6))
										+ ((char bitAt: 8) * (2 raisedTo: baseIndex + 7)) ].
	^value!

integerToString: anInteger
	"Answer a string representing <anInteger> in little endian format, padded to 32 bits."

	^self integerToString: anInteger bits: 32!

integerToString: anInteger bits: aNumber
	"Answer a string representing <anInteger> in little endian format, padded to <aNumber> bits."

	| stream index binary |
	binary := ''.
	stream := ReadWriteStream on: ''.
	index := 0.

	(anInteger printStringRadix: 2 padTo: aNumber) reverse do: [:each | 
		index := index + 1.
		binary := binary, each asString.
		index = 8 ifTrue: [
			index := 0. 
			stream nextPut: (self byteFromBinary: binary reverse).
			binary := '' ]].

	index > 0 ifTrue: [
		1 to: 8 - index do: [:each | binary := $0 asString, binary].
		stream nextPut: (self byteFromBinary: binary)].
	
	^stream contents reverse
	!

raise: aNumber toInteger: t1 modulo: t2 
	"Modular exponentiation of <aNumber> to <t1> modulous <t2>."

	t1 = 0 ifTrue: [^1].
	t1 even	ifTrue: [^(self raise: aNumber toInteger: t1 // 2 modulo: t2) squared \\ t2].
	^aNumber * (self raise: aNumber toInteger: t1 - 1 modulo: t2) \\ t2! !

DiffieHellman initializeAfterLoad!


DiffieHellman subclass: #DiffieHellmanGroup1
    instanceVariableNames: ''
    classVariableNames: ''
    poolDictionaries: ''!

!DiffieHellmanGroup1 class publicMethods !

description

	^'diffie-hellman-group1-sha1'! !

!DiffieHellmanGroup1 publicMethods !

initialPrimeHexValue
	"Answer a string with the representation of the initial prime of the receiver."

	^'FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74', 
	 '020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F1437', 
	 '4FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED', 
	 'EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE65381FFFFFFFFFFFFFFFF'! !

DiffieHellmanGroup1 initializeAfterLoad!


DiffieHellman subclass: #DiffieHellmanGroup14
    instanceVariableNames: ''
    classVariableNames: ''
    poolDictionaries: ''!

!DiffieHellmanGroup14 class publicMethods !

description

	^'diffie-hellman-group14-sha1'!

isAbstract

	^self == ##(self)! !

!DiffieHellmanGroup14 publicMethods !

initialPrimeHexValue
	"Answer a string with the representation of the initial prime of the receiver."

	^'FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74',
   '020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F1437',
	 '4FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED',
	 'EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF05',
	 '98DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB',
	 '9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3B',
	 'E39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF695581718',
	 '3995497CEA956AE515D2261898FA051015728E5A8AACAA68FFFFFFFFFFFFFFFF'! !

DiffieHellmanGroup14 initializeAfterLoad!


Object subclass: #EncryptionAlgorithm
    instanceVariableNames: ''
    classVariableNames: ''
    poolDictionaries: ''!

!EncryptionAlgorithm class publicMethods !

description

	^self subclassResponsibility!

fromDescription: aString

	^(self allSubclasses
			detect: [:each | each description = aString])
				new
		!

isAbstract

	^self == ##(self)! !

!EncryptionAlgorithm publicMethods !

decrypt: aString

	^self subclassResponsibility!

encrypt: aString

	^self subclassResponsibility! !

EncryptionAlgorithm initializeAfterLoad!


EncryptionAlgorithm subclass: #NullEncryption
    instanceVariableNames: ''
    classVariableNames: ''
    poolDictionaries: ''!

!NullEncryption class publicMethods !

description

	^'none'! !

!NullEncryption publicMethods !

decrypt: aString

	^aString!

encrypt: aString

	^aString! !

NullEncryption initializeAfterLoad!


EncryptionAlgorithm subclass: #RC4Encryption
    instanceVariableNames: 'key encryptStream decryptStream encryptIndex decryptIndex '
    classVariableNames: ''
    poolDictionaries: ''!

!RC4Encryption class publicMethods !

defaultKey

	^(1 to: self defaultKeyLength) 
		inject: '' 
		into: [:total :each | total, $a asString]!

defaultKeyLength

	^32!

description

	^'arcfour256'!

new

	^super new
		initialize! !

!RC4Encryption publicMethods !

decrypt: aString

	| i j keyStream newText aux |
	keyStream := decryptStream.
	i := decryptIndex at: 1.
	j := decryptIndex at: 2.
	newText := String new: aString size.

	aString doWithIndex: [:each :index |
		i := i + 1 bitAnd: 255.
		j := (j + (keyStream at: i + 1)) bitAnd: 255. 
		aux := keyStream at: i + 1.
		keyStream at: i + 1 put: (keyStream at: j + 1).
		keyStream at: j + 1 put: aux.
		aux := keyStream at: (((keyStream at: i + 1) + (keyStream at: j + 1)) bitAnd: 255) + 1.
		newText at: index put: (each value bitXor: aux) asCharacter].

	decryptStream := keyStream.
	decryptIndex at: 1 put: i.
	decryptIndex at: 2 put: j.
	^newText
	
	!

defaultKeyLength

	^self class defaultKeyLength!

encrypt: aString

	| i j keyStream newText aux |
	keyStream := encryptStream.
	i := encryptIndex at: 1.
	j := encryptIndex at: 2.
	newText := String new: aString size.

	aString doWithIndex: [:each :index |
		i := i + 1 bitAnd: 255.
		j := (j + (keyStream at: i + 1)) bitAnd: 255. 
		aux := keyStream at: i + 1.
		keyStream at: i + 1 put: (keyStream at: j + 1).
		keyStream at: j + 1 put: aux.
		aux := keyStream at: (((keyStream at: i + 1) + (keyStream at: j + 1)) bitAnd: 255) + 1.
		newText at: index put: (each value bitXor: aux) asCharacter].

	encryptStream := keyStream.
	encryptIndex at: 1 put: i.
	encryptIndex at: 2 put: j.
	^newText
	
	!

initialize
	"Initialize the receiver."

	self key: self class defaultKey!

key

	^key!

key: aByteArray

	| keySize keyStream aux j a b|
	key := aByteArray.
	keySize := key size.
	keyStream := Array new: 256.

	0 to: 255 do: [:i | keyStream at: i + 1 put: i].
	j := 0.
	0 to: 255 do: [:i | 
		a := (keyStream at: i + 1).
		b := (aByteArray at: (i rem: keySize) + 1) value.

		j := j + a + b bitAnd: 255.
		aux := keyStream at: i + 1.
		keyStream at: i + 1 put: (keyStream at: j + 1).
		keyStream at: j + 1 put: aux].

	encryptIndex := Array with: 0 with: 0.
	decryptIndex := Array with: 0 with: 0.
	encryptStream := keyStream.
	decryptStream := keyStream!

keyLength

	^self key size! !

RC4Encryption initializeAfterLoad!


Object subclass: #HMACAlgorithm
    instanceVariableNames: ''
    classVariableNames: ''
    poolDictionaries: ''!

!HMACAlgorithm class publicMethods !

description

	^self subclassResponsibility!

fromDescription: aString

	^(self allSubclasses
			detect: [:each | each description = aString])
				new
		!

isAbstract

	^self == ##(self)! !

!HMACAlgorithm publicMethods !

keyLength
	"Answer key length for the receiver."

	^self subclassResponsibility! !

HMACAlgorithm initializeAfterLoad!


HMACAlgorithm subclass: #HMACSHA1
    instanceVariableNames: 'key ipad opad l b shaEngine '
    classVariableNames: ''
    poolDictionaries: ''!

!HMACSHA1 class publicMethods !

defaultKeyLength
	
	^20!

description

	^'hmac-sha1'!

new

	^super new
		initialize! !

!HMACSHA1 publicMethods !

basicHash: aString
	"Answer a string with <aString> hashed contents."	 

	^String withAll: 
		((shaEngine digest: aString asByteArray) 
			collect: [:each | each asCharacter])


!

bitwiseXor: aString with: anotherString
	"Answer the result of bitwise xor operation of <aString> with <anotherString>."

	| stream value |
	stream := ReadWriteStream on: ''.
	1 to: aString size do: [:each | 
		value := (aString at: each) value bitXor: (anotherString at: each) value.
		stream nextPut: value asCharacter].
	^stream contents




	!

hash: aString
	"Answer a string with <aString> hashed contents."	 

	| newKey temp output |
	newKey := key size > b ifTrue: [self basicHash: key] ifFalse: [key].
	newKey := self pad: key.	
	temp := self bitwiseXor: ipad with: newKey.
	temp := temp, aString.
	temp := self basicHash: temp.
	output := self bitwiseXor: opad with: newKey.
	output := output, temp.
	^(self basicHash: output) copyFrom: 1 to: l

!

initialize
	"Initialize the receiver."

	l := 20.
	b := 64.
	ipad := ''.
	opad := ''.
	1 to: b do: [:each | ipad := ipad, 54 asCharacter asString]. 
	1 to: b do: [:each | opad := opad, 92 asCharacter asString].
	shaEngine := PumaShaEngine new.
	key := ''.
	self class defaultKeyLength timesRepeat: [key := key, ' ']


	

	!

key
	
	^key!

key: aString
	
	key := aString!

keyLength
	"Answer key length for the receiver."

	^key size!

pad: aString
	"Answer <aString> padded for the receiver."

	^aString, (String withAll: ((1 to: b) collect: [:each | 0 asCharacter]))
		copyFrom: 1 to: b! !

HMACSHA1 initializeAfterLoad!







!Integer publicMethods !

sshBit32Shift: offset

	offset = 0 ifTrue: [^self].
	^offset < 0
		ifTrue: [(self bitAnd: 16rFFFFFFFF) bitShift: offset]
		ifFalse: [(self bitShift: offset) bitAnd: 16rFFFFFFFF]! !


Object subclass: #PumaNetClient
    instanceVariableNames: 'connectInfo socket responseCode lastResponse pendingResponses '
    classVariableNames: ''
    poolDictionaries: ''!

!PumaNetClient class publicMethods !

hostName: aString
		"Devuelve una instancia inicializada, pero sin conectar."

	^self new
		hostName: aString;
		yourself!

loginSpec: aPumaRemoteConnectionSpec
		"Devuelve una instancia inicializada, pero sin conectar."

	^self new
		connectionInfo: aPumaRemoteConnectionSpec;
		yourself! !

!PumaNetClient publicMethods !

checkForPendingError
	"If data is waiting, check it to catch any error reports.
	In case the response is not an error, push it back."

	(self socket notNil and: [ self socket isDataAvailable ])
		ifFalse: [ ^self ].
	self fetchNextResponse.
	self
		checkResponse: self lastResponse
		onError: [ :response | Error signal: response ]
		onWarning: [:response | Warning signal: response ].
	"if we get here, it wasn't an error"
	self pushResponse: self lastResponse!

checkResponse
	"Get the response from the server and check for errors."

	self
		checkResponseOnError: [ :response | Error signal: response ]
		onWarning: [ :response | Warning signal: response ].!

checkResponse: aResponse onError: errorBlock onWarning: warningBlock
	"Get the response from the server and check for errors. Invoke one of the blocks if an error or warning is encountered. See class comment for classification of error codes."

	self responseIsError
		ifTrue: [ errorBlock value: aResponse ].
	self responseIsWarning
		ifTrue: [ warningBlock value: aResponse ].!

checkResponseOnError: errorBlock onWarning: warningBlock
	"Get the response from the server and check for errors. Invoke one of the blocks if an error or warning is encountered. See class comment for classification of error codes."

	self fetchPendingResponse.
	self checkResponse: self lastResponse onError: errorBlock onWarning: warningBlock!

close
	self socket isNil
		ifFalse: [
			self socket close.
			socket := nil ].
	responseCode := lastResponse := nil.
	!

connect
		"Conecta el socket y devuelve self."

	self socket isNil
		ifTrue: [
			self socket: (AbtSocketStream createClientSocketToHost: self hostName port: self defaultPortNumber) ].
	^self!

connectionInfo
	connectInfo ifNil: [connectInfo := PumaRemoteConnectionSpec new].
	^connectInfo!

connectionInfo: aPumaRemoteConnectionSpec

	connectInfo := aPumaRemoteConnectionSpec!

defaultPortNumber

	^self class defaultPortNumber!

determineResponseCode
	self lastResponse size >= 3
		ifFalse: [^0].
	^[(self lastResponse copyFrom: 1 to: 3) asNumber]
		on: Error
		do: [:ex | ex return: 0]!

ensureConnection
		"Crea el socket y establece la conexión."

	| procesoConexion rc timeout limitTime |

	timeout := 120000.
	limitTime := (DateAndTime now) + (Duration milliseconds: timeout).

	self isConnected ifTrue: [ ^self ].
	self socket notNil	ifTrue: [ self socket close ].

	procesoConexion := [
		self connect.
		self checkResponse.
		rc := self login ] fork.

	[ DateAndTime now <= limitTime ] whileTrue: [
			(Delay forSeconds: 1) wait.
			rc isNil ifFalse: [ ^rc ] ].

	rc isNil ifTrue: [
		Processor terminate: procesoConexion.
		rc := AbtError errorText: 'Error de timeout conectando al FTP' ].

	^rc!

fetchNextResponse
	"The telnet protocol allows multiple line replies."

	| response result |
	self socket isNil
		ifTrue: [ ^self ].

	result := WriteStream on: ''.
	[response := self socket nextLineCrOrLf.
	self responseIsContinuation: response]
		whileTrue: [result nextPutAll: response; cr].
	result nextPutAll: response.
	self lastResponse: result contents!

fetchPendingResponse
	^pendingResponses isNil
		ifTrue: [self fetchNextResponse; lastResponse]
		ifFalse: [self popResponse]!

hostName
	^self connectionInfo hostname!

hostName: aHostName
	^self connectionInfo hostname: aHostName!

isConnected
	^socket notNil
		and: [socket socket isClosed not]!

lastResponse
	^lastResponse!

lastResponse: aString

	lastResponse := aString.
	responseCode := self determineResponseCode!

lookForCode: code
	"We are expecting a certain code next."

	self
		lookForCode: code
		ifDifferent: [:response | (Error signal: response)]
!

lookForCode: code ifDifferent: handleBlock
	"We are expecting a certain code next."

	self fetchNextResponse.
	self responseCode == code
		ifFalse: [handleBlock value: self lastResponse]
!

password
	^self connectionInfo password!

password: aString
	^self connectionInfo password: aString!

pendingResponses
	pendingResponses isNil
		ifTrue: [pendingResponses := OrderedCollection new].
	^pendingResponses!

popResponse
	| pendingResponse |
	pendingResponse := self pendingResponses removeFirst.
	pendingResponses isEmpty
		ifTrue: [pendingResponses := nil].
	^pendingResponse!

pushResponse: aResponse
	self pendingResponses add: aResponse!

responseCode
	^responseCode!

responseIsContinuation
		"Verificamos si lo que hay en el buffer sigue o no. Si en la cuarta posición
			hay un -, es porque la respuesta tiene varias lineas."

	^(self lastResponse size > 3
		and: [(self lastResponse at: 4) == $-])!

responseIsContinuation: response
		"Verificamos si lo que hay en el buffer sigue o no. Si en la cuarta posición
			hay un -, es porque la respuesta tiene varias lineas."

	^((response size > 3
		and: [(response at: 4) == $-]) or: [
			response asNumber = 0 ])!

responseIsError
	^self responseCode between: 500 and: 599!

responseIsWarning
	^self responseCode between: 400 and: 499!

sendCommand: aString
		"Envía el comando."

	self socket
		nextPutAll: aString;
		nextPutAll: (Character cr asString, Character lf asString).
	self socket flush!

socket
	^socket!

socket: aSocketStream
	socket := aSocketStream!

user
	^self connectionInfo userid!

user: aString
	^self connectionInfo userid: aString! !

PumaNetClient initializeAfterLoad!


PumaNetClient subclass: #PumaFTPClient
    instanceVariableNames: 'dataSocket datosTransferidos fileSize '
    classVariableNames: ''
    poolDictionaries: ''!

!PumaFTPClient class publicMethods !

defaultPortNumber
	^21!

rawResponseCodes
	^#(200 'Command okay.'
	500 'Syntax error, command unrecognized. This may include errors such as command line too long.'
	501 'Syntax error in parameters or arguments.'
	202 'Command not implemented, superfluous at this site.'
	502 'Command not implemented.'
	503 'Bad sequence of commands.'
	504 'Command not implemented for that parameter.'
	110 'Restart marker reply. In this case, the text is exact and not left to the particular implementation; it must read: MARK yyyy = mmmm Where yyyy is User-process data stream marker, and mmmm server''s equivalent marker (note the spaces between markers and "=").'
	211 'System status, or system help reply.'
	212 'Directory status.'
	213 'File status.'
	214 'Help message. On how to use the server or the meaning of a particular non-standard command. This reply is useful only to the human user.'
	215 'NAME system type. Where NAME is an official system name from the list in the Assigned Numbers document.'
	120 'Service ready in nnn minutes.'

	220 'Service ready for new user.'
	221 'Service closing control connection. Logged out if appropriate.'
	421 'Service not available, closing control connection. This may be a reply to any command if the service knows it must shut down.'
	125 'Data connection already open; transfer starting.'
	225 'Data connection open; no transfer in progress.'
	425 'Can''t open data connection.'
	226 'Closing data connection. Requested file action successful (for example, file transfer or file abort).'
	426 'Connection closed; transfer aborted.'
	227 'Entering Passive Mode (h1,h2,h3,h4,p1,p2).'

	230 'User logged in, proceed.'
	530 'Not logged in.'
	331 'User name okay, need password.'
	332 'Need account for login.'
	532 'Need account for storing files.'
	150 'File status okay; about to open data connection.'
	250 'Requested file action okay, completed.'
	257 '"PATHNAME" created.'
	350 'Requested file action pending further information.'
	450 'Requested file action not taken. File unavailable (e.g., file busy).'
	550 'Requested action not taken. File unavailable (e.g., file not found, no access).'
	451 'Requested action aborted. Local error in processing.'
	551 'Requested action aborted. Page type unknown.'
	452 'Requested action not taken. Insufficient storage space in system.'
	552 'Requested file action aborted. Exceeded storage allocation (for current directory or dataset).'
	553 'Requested action not taken. File name not allowed.')! !

!PumaFTPClient publicMethods !

abortDataConnection
	self sendCommand: 'ABOR'.
	self closeDataSocket!

appendFileNamed: filePath as: fileNameOnServer
	"FTP a file to the server."


	| file rc |
	(file := CfsReadFileStream open: filePath) isCfsError
		ifTrue: [ ^(Error signal: file message)  ].
	rc := (self appendFileStreamContents: file as: fileNameOnServer).
	file close.
	^rc!

appendFileStreamContents: fileStream as: fileNameOnServer
	"FTP a file to the server."


	self binary.
	self openPassiveDataConnection.
	self sendCommand: 'APPE ', fileNameOnServer.

	fileStream reset.
	fileSize := fileStream size.

	[self sendStreamContents: fileStream]
		ensure: [self closeDataSocket].

	self checkResponse.
	self checkResponse.!

ascii
	self sendCommand: 'TYPE A'.
	self lookForCode: 200!

binary
	self sendCommand: 'TYPE I'.
	self lookForCode: 200!

changeDirectoryTo: newDirName
	self sendCommand: 'CWD ' , newDirName.
	self checkResponse.
!

close
		"Cierra la conexión."

	self closeDataSocket.
	^super close!

closeDataSocket
	self dataSocket isNil
		ifFalse: [
			self dataSocket disconnect.
			self dataSocket: nil]
!

dataSocket
	^dataSocket!

dataSocket: aSocket
	dataSocket := aSocket!

dataSocketSize

	dataSocket isNil
		ifTrue: [ 0 ]
		ifFalse: [ dataSocket ]!

datosTransferidos

	datosTransferidos isNil
		ifTrue: [ datosTransferidos := (WriteStream on: ByteArray new) ].

	^datosTransferidos!

datosTransferidos: aByteArray
	datosTransferidos := aByteArray!

deleteDirectory: dirName
	self sendCommand: 'RMD ' , dirName.
	self checkResponse.
!

deleteFileNamed: fileName
	self sendCommand: 'DELE ' , fileName.
	self checkResponse.
!

fileSize

	^fileSize!

get: limit dataInto: dataStream
	"Reel in data until the server closes the connection or the limit is reached.
	At the same time, watch for errors on otherSocket."

	| buf bytesRead currentlyRead |
	currentlyRead := 0.
	buf _= String new: 4000.
	[currentlyRead < limit and: 
	[self dataSocket isConnected "or: [self dataSocket dataAvailable]"]]
		whileTrue: [
			"self checkForPendingError."
			bytesRead := self dataSocket receiveAndWaitDataComplete.
			1 to: (bytesRead min: (limit - currentlyRead)) do: [:ii | dataStream nextPut: (buf at: ii)].
			currentlyRead := currentlyRead + bytesRead].
	dataStream reset.	"position: 0."
	^ dataStream!

getData
	"Reel in all data until the server closes the connection.  At the same time, watch for errors on otherSocket.  Don't know how much is coming.  Put the data on the stream."

	| rc byteArray |
	datosTransferidos := nil.

	[ self dataSocket isNil or: [ (rc := self dataSocket primReceiveWithFlags: 0 usingBuffer: self dataSocket buffer) isCommunicationsError
		or: [rc = 0 ] ] ]
		whileFalse: [ self datosTransferidos nextPutAll: (self dataSocket buffer asByteArrayFrom: 0 to: rc - 1) ].

	self checkForPendingError.
	self closeDataSocket.
	byteArray := self datosTransferidos contents.
	datosTransferidos := nil.
	^byteArray!

getDataInto: dataStream
	"Reel in all data until the server closes the connection.  At the same time, watch for errors on otherSocket.  Don't know how much is coming.  Put the data on the stream."

	^(self dataSocket	receiveAndWaitDataComplete)
			buffer asByteArray!

getDirectory
	| dirList |
	self openPassiveDataConnection.
	self sendCommand: 'LIST'.
	dirList := self getData.
	self checkResponse.
	self checkResponse.
	^dirList
!

getFile: remoteFileName
		"Obtiene el archivo remoto."

	| data |
	self openPassiveDataConnection.
	self sendCommand: 'RETR ', remoteFileName.
	[self checkResponse]
		on: Exception
		do: [:ex | self closeDataSocket. Transcript cr; show: 'Error FTP' ].

	data := self getData.
	self checkResponse.
	^data!

getFileNamed: remoteFileName

	| data |

	fileSize := self getFileSize: remoteFileName.
	self binary.
	self openPassiveDataConnection.
	self sendCommand: 'RETR ', remoteFileName.
	[self checkResponse]
		on: Exception
		do: [:ex | self closeDataSocket. Transcript cr; show: 'Error FTP' ].

	[ data := self getData ] fork.
	(Delay forSeconds: 0.2) wait.
	[ self dataSocket isNil ] whileFalse: [
		Transcript cr; show: self datosTransferidos size printString, '/', fileSize printString.
		(Delay forSeconds: 0.1) wait ].

	self checkResponse.
	^data!

getFileNamed: remoteFileName to: fullPath
		"Recupera el archivo y lo guarda en el archivo."

	| file data |
	data := self getFileNamed: remoteFileName.
	file := CfsReadWriteFileStream openEmpty: fullPath.
	file nextPutAll: (data contents).
	file close.!

getFileSize: aFileName

	self sendCommand: 'SIZE ', aFileName.
	self lookForCode: 213.
	^((self lastResponse findTokens: ' ') at: 2) asNumber!

login

	self user isNil ifTrue: [^(AbtError errorText: 'Error FTP. El usuario no puede ser nil')].

	self isConnected ifFalse: [ self connect ].

	self sendCommand: 'USER ', self user.

	"331 Password required"
	self lookForCode: 331.
	"will ask user, if needed"
	self sendCommand: 'PASS ', self password.

	"230 User logged in"
	[ self lookForCode: 230 ]
		whenExceptionDo: [ ^(AbtError errorText: self lastResponse) rc: self responseCode ]!

loginUser: userName password: passwdString

	self user: userName.
	self password: passwdString.

	self login!

openDataSocket: remoteHostAddress port: dataPort

	| connSpec |
	connSpec :=
		AbtTCPConnectionSpec new
			hostId: remoteHostAddress asIPAddress;
			port: dataPort;
			bufferLength: 100;
			blocking: false;
			yourself.

	dataSocket := AbtSocket new.
	dataSocket connectUsing: connSpec.!

openPassiveDataConnection
	| portInfo list dataPort remoteHostAddress |
	self sendCommand: 'PASV'.
	self lookForCode: 227 ifDifferent: [:response | Error signal: ('Could not enter passive mode: ' , response)].

	portInfo := (self lastResponse findTokens: '()') at: 2.
	list := portInfo findTokens: ','.
	remoteHostAddress := ByteArray
		with: (list at: 1) asNumber
		with: (list at: 2) asNumber
		with: (list at: 3) asNumber
		with: (list at: 4) asNumber.
	dataPort := (list at: 5) asNumber * 256 + (list at: 6) asNumber.
	self openDataSocket: remoteHostAddress port: dataPort!

passive
	self sendCommand: 'PASV'.
	self lookForCode: 227!

porcentajeProgreso
	"Devuelve el porcentaje del progreso de download."

	^(self datosTransferidos size * 100 / self fileSize) asScaledDecimal integerPart asInteger!

putFile: aStream as: fileNameOnServer
	"FTP a file to the server."

	self putFile: aStream as: fileNameOnServer onProgress: nil!

putFile: aStream as: fileNameOnServer onProgress: aProgress
	"FTP a file to the server."

	self openPassiveDataConnection.
	self sendCommand: 'STOR ', fileNameOnServer.

	aStream reset.
	fileSize := aStream size.

	[ [self sendStreamContents: aStream]
		ensure: [self closeDataSocket] ] fork.

	[ self dataSocket isNil ] whileFalse: [
		| porcentaje |
		porcentaje := self porcentajeProgreso.
		aProgress isNil ifFalse: [ aProgress fractionComplete: (porcentaje / 100) ].
		(Delay forSeconds: 0.1) wait ].

	self checkResponse.
	self checkResponse.!

putFileNamed: filePath as: fileNameOnServer
	"FTP a file to the server."


	| file rc |
	(file := CfsReadFileStream open: filePath) isCfsError
		ifTrue: [ ^(Error signal: file message)  ].
	rc := (self putFileStreamContents: file as: fileNameOnServer).
	file close.
	^rc!

putFileStreamContents: fileStream as: fileNameOnServer
	"FTP a file to the server."


	self binary.
	self openPassiveDataConnection.
	self sendCommand: 'STOR ', fileNameOnServer.

	fileStream reset.
	fileSize := fileStream size.

	[self sendStreamContents: fileStream]
		ensure: [self closeDataSocket].

	self checkResponse.
	self checkResponse.!

pwd
	| result |
	self sendCommand: 'PWD'.
	self lookForCode: 257.
	result := self lastResponse.
	^result copyFrom: (result indexOf: $")+1 to: (result lastIndexOf: $")-1!

quit
	self sendCommand: 'QUIT'.
	self close!

sendStreamContents: aStream

	| socketStream bufferSize q |
	socketStream := AbtSocketStream on: self dataSocket sciSocket.
	bufferSize := 4000.
	[ aStream atEnd ] whileFalse: [
		| partial |
		partial := (aStream size - aStream position) > bufferSize
			ifTrue: [ aStream next: bufferSize ]
			ifFalse: [ aStream upToEnd ].
		self datosTransferidos nextPutAll: partial.
		socketStream	nextPutAll: partial.
		socketStream	flush ].
	socketStream close.
	datosTransferidos := nil.! !

PumaFTPClient initializeAfterLoad!


PumaNetClient subclass: #PumaTelnetClient
    instanceVariableNames: ''
    classVariableNames: ''
    poolDictionaries: ''!

!PumaTelnetClient class publicMethods !

defaultPortNumber
	^23! !

PumaTelnetClient initializeAfterLoad!


Object subclass: #PumaShaEngine
    instanceVariableNames: 'aa bb cc dd ee w count '
    classVariableNames: ''
    poolDictionaries: ''!

!PumaShaEngine publicMethods !

countMask

	^64 - 1!

digest: bytes

	self reset.
	self updateBytes: bytes.
	^self engineDigest!

engineDigest

	| result bits |
	bits := count bitShift: 3.
	self updateBytes: #[16r80] from: 1.
	[(count bitAnd: self countMask) ~= 56] whileTrue: [self updateBytes: #[16r0] from: 1].

	w at: 15 put: (bits sshBit32Shift: -32).
	w at: 16 put: (bits bitAnd: 16rFFFFFFFF).

	count := count + 8.
	self processBlock.

	result := Array new: 20.
	result at: 1 put: ((aa sshBit32Shift: -24) bitAnd: 255).
	result at: 2 put: ((aa sshBit32Shift: -16) bitAnd: 255).
	result at: 3 put: ((aa sshBit32Shift: -8) bitAnd: 255).
	result at: 4 put: (aa bitAnd: 255).

	result at: 5 put: ((bb sshBit32Shift: -24) bitAnd: 255).
	result at: 6 put: ((bb sshBit32Shift: -16) bitAnd: 255).
	result at: 7 put: ((bb sshBit32Shift: -8) bitAnd: 255).
	result at: 8 put: (bb bitAnd: 255).

	result at: 9 put: ((cc sshBit32Shift: -24) bitAnd: 255).
	result at: 10 put: ((cc sshBit32Shift: -16) bitAnd: 255).
	result at: 11 put: ((cc sshBit32Shift: -8) bitAnd: 255).
	result at: 12 put: (cc bitAnd: 255).

	result at: 13 put: ((dd sshBit32Shift: -24) bitAnd: 255).
	result at: 14 put: ((dd sshBit32Shift: -16) bitAnd: 255).
	result at: 15 put: ((dd sshBit32Shift: -8) bitAnd: 255).
	result at: 16 put: (dd bitAnd: 255).

	result at: 17 put: ((ee sshBit32Shift: -24) bitAnd: 255).
	result at: 18 put: ((ee sshBit32Shift: -16) bitAnd: 255).
	result at: 19 put: ((ee sshBit32Shift: -8) bitAnd: 255).
	result at: 20 put: (ee bitAnd: 255).

	self reset.
	^result!

reset

	aa := 16r67452301.
	bb := 16rEFCDAB89.
	cc := 16r98BADCFE.
	dd := 16r10325476.
	ee := 16rC3D2E1F0.
	w := (Array new: 80) atAllPut: 0.
	count := 0!

updateBytes: bytes

	| index stop |
	1
		to: (stop := bytes size - (bytes size \\ 4))
		by: 4
		do: [:i |
			index := (count bitAnd: self countMask) bitShift: -2.
			w
				at: index + 1
				put: (
					((bytes at: i) bitShift: 24) + ((bytes at: i + 1) bitShift: 16) +
						((bytes at: i + 2) bitShift: 8) + (bytes at: i + 3)).
			count := count + 4.
			(count bitAnd: self countMask) = 0 ifTrue: [self processBlock]].
	self updateBytes: bytes from: stop + 1!

updateBytes: bytes from: start

	start to: bytes size do: [:i | | index offset value |
		index := ((count bitAnd: self countMask) bitShift: -2 ) + 1.
		offset := (count bitInvert bitAnd: 3) bitShift: 3.
		value := ((w at: index) bitAnd: (16rFF bitShift: offset) bitInvert)
			bitOr: ((bytes at: i) bitShift: offset).
		w at: index put: value.
		(count bitAnd: self countMask) = self countMask ifTrue: [self processBlock].
		count := count + 1]! !

!PumaShaEngine privateMethods !

processBlock

	| a b c d e temp |
	17 to: 80 do: [:t |
		temp := (((w at: t - 3) bitXor: (w at: t - 8)) bitXor: (w at: t - 14)) bitXor: (w at: t - 16).
		w at: t put: ((temp sshBit32Shift: 1) bitOr: (temp sshBit32Shift: -31))].

	a := aa.
	b := bb.
	c := cc.
	d := dd.
	e := ee.

	1 to: 20 do: [:i |
		temp := (((a sshBit32Shift: 5) bitOr: (a sshBit32Shift: -27)) +
			((b bitAnd: c) bitOr: (b bitInvert bitAnd: d)) + e + (w at: i) + self round1_kt)
				bitAnd: 16rFFFFFFFF.
		e := d.
		d := c.
		c := (b sshBit32Shift: 30) bitOr: (b sshBit32Shift: -2).
		b := a.
		a := temp].

	21 to: 40 do: [:i |
		temp := (((a sshBit32Shift: 5) bitOr: (a sshBit32Shift: -27)) + ((b bitXor: c) bitXor: d) + e +
			(w at: i) + self round2_kt)
				bitAnd: 16rFFFFFFFF.
		e := d.
		d := c.
		c := (b sshBit32Shift: 30) bitOr: (b bitShift: -2).
		b := a.
		a := temp].

	41 to: 60 do: [:i |
		temp := (((a sshBit32Shift: 5) bitOr: (a sshBit32Shift: -27)) +
			(((b bitAnd: c) bitOr: (b bitAnd: d)) bitOr: (c bitAnd: d)) + e + (w at: i) +
			self round3_kt)
				bitAnd: 16rFFFFFFFF.
		e := d.
		d := c.
		c := (b sshBit32Shift: 30) bitOr: (b sshBit32Shift: -2).
		b := a.
		a := temp].

	61 to: 80 do: [:i |
		temp := (((a sshBit32Shift: 5) bitOr: (a sshBit32Shift: -27)) + ((b bitXor: c) bitXor: d) + e +
			(w at: i) + self round4_kt)
				bitAnd: 16rFFFFFFFF.
		e := d.
		d := c.
		c := (b sshBit32Shift: 30) bitOr: (b sshBit32Shift: -2).
		b := a.
		a := temp].

	aa := aa + a.
	bb := bb + b.
	cc := cc + c.
	dd := dd + d.
	ee := ee + e!

round1_kt

	^16r5A827999!

round2_kt

	^16r6ED9EBA1!

round3_kt

	^16r8F1BBCDC!

round4_kt

	^16rCA62C1D6! !

PumaShaEngine initializeAfterLoad!


Object subclass: #PumaSSH2Connector
    instanceVariableNames: 'hostName portNumber sessionId errors exchangeHash socketStream state sendSequenceNumber getSequenceNumber keyExchangeAlgorithm encryptionAlgorithm decryptionAlgorithm compressionAlgorithm decompressionAlgorithm hmacCheckAlgorithm hmacCreateAlgorithm encryptionEnabled channelStatus channelBuffers serverChannels packetSizesClientToServer windowSizesClientToServer generator randomValueForKey clientConfiguration serverConfiguration '
    classVariableNames: ''
    poolDictionaries: 'SSH2Constants '!

!PumaSSH2Connector class publicMethods !

basicNew
	"Answer a new instance of the receiver."

	^super basicNew 
		initialize!

initializePoolDictionary

	Smalltalk 
		at: #SSH2Constants
		put: (EsPoolDictionary new 
			"Connection constants."
				at: 'SSH_CHANNEL_EXEC' put: 0; 
				at: 'SSH_CHANNEL_SHELL' put: 1;
				at: 'SSH_READ_SIMPLE' put: 1;
				at: 'SSH_READ_REGEX' put: 2;
			"Channel open failure constants."
				at: 'SSH_OPEN_ADMINISTRATIVELY_PROHIBITED' put: 1;
			"Disconnect reasons."
				at: 'SSH_DISCONNECT_HOST_NOT_ALLOWED_TO_CONNECT' put: 1;
				at: 'SSH_DISCONNECT_PROTOCOL_ERROR' put: 2;
				at: 'SSH_DISCONNECT_KEY_EXCHANGE_FAILED' put: 3;
				at: 'SSH_DISCONNECT_RESERVED' put: 4;
				at: 'SSH_DISCONNECT_MAC_ERROR' put: 5;
				at: 'SSH_DISCONNECT_COMPRESSION_ERROR' put: 6;
				at: 'SSH_DISCONNECT_SERVICE_NOT_AVAILABLE' put: 7;
				at: 'SSH_DISCONNECT_PROTOCOL_VERSION_NOT_SUPPORTED' put: 8;
				at: 'SSH_DISCONNECT_HOST_KEY_NOT_VERIFIABLE' put: 9;
				at: 'SSH_DISCONNECT_CONNECTION_LOST' put: 10;
				at: 'SSH_DISCONNECT_BY_APPLICATION' put: 11;
				at: 'SSH_DISCONNECT_TOO_MANY_CONNECTIONS' put: 12;
				at: 'SSH_DISCONNECT_AUTH_CANCELLED_BY_USER' put: 13;
				at: 'SSH_DISCONNECT_NO_MORE_AUTH_METHODS_AVAILABLE' put: 14;
				at: 'SSH_DISCONNECT_ILLEGAL_USER_NAME' put: 15;
			"Message constants."
				at: 'SSH_EXTENDED_DATA_STDERR' put: 1;
			"Channel open failure constants."
				at: 'SSH_MSG_DISCONNECT' put: 1;
				at: 'SSH_MSG_IGNORE' put: 2;
				at: 'SSH_MSG_UNIMPLEMENTED' put: 3;
				at: 'SSH_MSG_DEBUG' put: 4;
				at: 'SSH_MSG_SERVICE_REQUEST' put: 5;
				at: 'SSH_MSG_SERVICE_ACCEPT' put: 6;
				at: 'SSH_MSG_KEXINIT' put: 20;
				at: 'SSH_MSG_NEWKEYS' put: 21;
				at: 'SSH_MSG_KEXDH_INIT' put: 30;
				at: 'SSH_MSG_KEXDH_REPLY' put: 31;
				at: 'SSH_MSG_USERAUTH_REQUEST' put: 50;
				at: 'SSH_MSG_USERAUTH_FAILURE' put: 51;
				at: 'SSH_MSG_USERAUTH_SUCCESS' put: 52;
				at: 'SSH_MSG_USERAUTH_BANNER' put: 53;
				at: 'SSH_MSG_GLOBAL_REQUEST' put: 80;
				at: 'SSH_MSG_REQUEST_SUCCESS' put: 81;
				at: 'SSH_MSG_REQUEST_FAILURE' put: 82;
				at: 'SSH_MSG_CHANNEL_OPEN' put: 90;
				at: 'SSH_MSG_CHANNEL_OPEN_CONFIRMATION' put: 91;
				at: 'SSH_MSG_CHANNEL_OPEN_FAILURE' put: 92;
				at: 'SSH_MSG_CHANNEL_WINDOW_ADJUST' put: 93;
				at: 'SSH_MSG_CHANNEL_DATA' put: 94;
				at: 'SSH_MSG_CHANNEL_EXTENDED_DATA' put: 95;
				at: 'SSH_MSG_CHANNEL_EOF' put: 96;
				at: 'SSH_MSG_CHANNEL_CLOSE' put: 97;
				at: 'SSH_MSG_CHANNEL_REQUEST' put: 98;
				at: 'SSH_MSG_CHANNEL_SUCCESS' put: 99;
				at: 'SSH_MSG_CHANNEL_FAILURE' put: 100;
			"Terminal modes constants."
				at: 'SSH_TTY_OP_END' put: 0;
			yourself)!

new
	"Answer a new instance of the receiver."

	^self error: 'Can´t construct with new'!

onHost: hostName port: portNumber
	"Answer a new instance of the receiver on <hostName> and <portNumber>."

	^self basicNew
		hostName: hostName;
		portNumber: portNumber;
		yourself!

startupOnHost: hostName port: portNumber
	"Answer a new connected instance of the receiver on <hostName> and <portNumber>."

	^(self onHost: hostName port: portNumber)
		startup;
		yourself! !

!PumaSSH2Connector publicMethods !

byteFromBinary: aString

	| value |
	value := 0.
	aString reverse doWithIndex: [:each :index | 
		each = $1 ifTrue: [value := value + (2 raisedTo: index - 1)]].
	^value asCharacter!

check: anObject type: anInteger errorMessage: aString
	"Verify whether <anObject> type is <anInteger>. 
	 When false, signals an error with <aString> description."

	anObject type = anInteger
		ifFalse: [self error: aString]
!

checkConnectionActive
	"Check whether the receiver connection is active. Signals an error if not."

	socketStream atEnd ifTrue: [self error: 'Connection closed by server']





!

checkServerHostKeyAlgorithms
	"Check whether the server host keys are compatible."

	serverConfiguration checkServerHostKeyAlgorithms: clientConfiguration!

close
	"Close the receiver connection."

	self disconnect
!

connectSocket
	"Connect the socket of the receiver."

	socketStream := AbtSocketStream createClientSocketToHost: self hostName port: self portNumber.
	socketStream lastError ifNotNil: [:value | self error: value message]
!

createCookie 
	"Answer a 16 byte random string cookie."

	^(1 to: 16) inject: '' into: [:total :each | total, self randomValue asCharacter asString]
!

decryptBlockSize
	"Answer decrypt block size parameter."

	^8!

describeString: aString
	"Answer a binary representation for <aString>."

	^(self integerToString: aString size), aString


!

determineEncryptionAlgorithms
	"Establish a encryption algorithm for the receiver."

	encryptionAlgorithm := clientConfiguration compatibleEncryptionAlgorithm: serverConfiguration.
	decryptionAlgorithm := clientConfiguration compatibleDecryptionAlgorithm: serverConfiguration

!

determineHMACAlgorithms
	"Establish HMAC creation and HMAC check algorithms for the receiver."

	hmacCreateAlgorithm := clientConfiguration compatibleHMACCreateAlgorithm: serverConfiguration.
	hmacCheckAlgorithm := clientConfiguration compatibleHMACCheckAlgorithm: serverConfiguration


!

determineKeyExchangeAlgorithm
	"Establish a key exchange algorithm for the receiver."

	keyExchangeAlgorithm := clientConfiguration compatibleKeyExchangeAlgorithm: serverConfiguration!

disconnect
	"Disconnect the receiver."

	self disconnect: SSH_DISCONNECT_BY_APPLICATION!

disconnect: anInteger
	"Close the receiver connection with reason <anInteger>."

	state isNil ifFalse: [	
		self sendBinary: (SSH2Message messageDisconnectReason: anInteger).
		state := nil.
		socketStream close]!

encryptBlockSize
	"Answer encrypt block size parameter."

	^8!

encryptionKeyLength
	"Answer a key length suitable for the receiver."

	^(encryptionAlgorithm keyLength max: decryptionAlgorithm keyLength) 
			min: 160!

exchangeKeys
	"Perform the key exchange process. "

	self
		sendKeyExchangeInit;
		determineEncryptionAlgorithms;
		determineKeyExchangeAlgorithm;
		sendKeys;
		readKeyExchangeDHReply;
		initializeExchangeHash;
		checkServerHostKeyAlgorithms;
		sendNewKeys;
		readNewKeys;
		initializeEncryption;
		determineHMACAlgorithms;
		initializeHMAC;
		initializeCompression
	

	


!

executeCommand: aString
	"Execute <aString> shell command, answer results."	

	| value output |
	self 
		sendChannelOpen: SSH_CHANNEL_EXEC;
		getChannelPacket: SSH_CHANNEL_EXEC;
		sendChannelRequest: aString;
		getChannelPacket: SSH_CHANNEL_EXEC.

	channelStatus at: SSH_CHANNEL_EXEC put: SSH_MSG_CHANNEL_DATA.
	output := ReadWriteStream on: ''.
	[(value := (self getChannelPacket: SSH_CHANNEL_EXEC)) = true]	
		whileFalse: [
			value = false ifTrue: [self error: 'Receive error'].
			output nextPutAll: value].
	^output contents
		
	!

filter: aString
	"Filter messages that should be discarded and perform extra processing for some messages."

	| value returnValue |
	returnValue := aString.
	value := aString first asInteger.
	(value = SSH_MSG_KEXINIT) ifTrue: [
	 	sessionId isNil ifFalse: [
  		self reExchangeKeys: returnValue.
			state := nil.
	    returnValue := self getBinary]].
	
	(state = ##logged) ifTrue: [
		value = SSH_MSG_CHANNEL_WINDOW_ADJUST ifTrue: [
			returnValue := self getBinary]].

	^returnValue!

get
	"Answer a new message sent by the server."	

	| value |
	(value := self getBinary) isEmpty 
		ifTrue: [self error: 'Connection closed by server'].
	^self messajeFrom: value!

getBinary
	"Answer the binary message sent by the server."	

	| raw value buffer remainingLength packetLength padding paddingLength payLoad |
	self checkConnectionActive.
	raw := socketStream next: self decryptBlockSize.
	raw isEmpty ifTrue: [^value].
	encryptionEnabled ifTrue: [raw := decryptionAlgorithm decrypt: raw].

	packetLength := raw sshLongAt: 1.
	paddingLength := (raw at: 5) value.
	raw := raw copyFrom: 6 to: raw size.
	remainingLength := packetLength + 4 - 8.
	buffer := ReadWriteStream on: ''.

	[remainingLength > 0]	whileTrue: [
			value := socketStream next: remainingLength.
			buffer nextPutAll: value.
			remainingLength := remainingLength - value size].

	buffer contents isEmpty ifFalse: [
		raw := raw, (encryptionEnabled 
									ifTrue: [decryptionAlgorithm decrypt: buffer contents] 
									ifFalse: [buffer contents])].	
	payLoad := raw copyFrom: 1 to: packetLength - paddingLength - 1.
	padding := raw copyFrom: packetLength - paddingLength to: raw size. 

	hmacCheckAlgorithm notNil ifTrue: [
		| hmac message |
		hmac := socketStream next: hmacCheckAlgorithm keyLength.
		message := (ReadWriteStream on: '')
									nextPutAll: (self integerToString: getSequenceNumber);
									nextPutAll: (self integerToString: packetLength);
									nextPut: paddingLength asCharacter;
									nextPutAll: payLoad;
									nextPutAll: padding;
									contents.
		hmac = (hmacCheckAlgorithm hash: message)
			ifFalse: [self error: 'Invalid HMAC']].

	getSequenceNumber := getSequenceNumber + 1.
	^self filter: payLoad






!

getChannelPacket: aNumber

	| value status message |
	[true] whileTrue: [
		value := self getBinary.
		value isEmpty ifTrue: [^value].
		message := SSH2Message fromBytes: value.

		status := channelStatus at: aNumber.
		status = SSH_MSG_CHANNEL_OPEN ifTrue: [
			message type = SSH_MSG_CHANNEL_OPEN_CONFIRMATION ifTrue: [
				serverChannels at: aNumber put: message serverChannel.
				packetSizesClientToServer at: aNumber put: message packetSize.
				^true].
			self error: 'Unable to open channel'].

		status = SSH_MSG_CHANNEL_REQUEST ifTrue: [
			message type = SSH_MSG_CHANNEL_SUCCESS ifTrue: [^true].
			self error: 'Unable to request a pseudo-terminal'].

		message type = SSH_MSG_CHANNEL_DATA ifTrue: [
			message channel = aNumber ifTrue: [^message data].
			channelBuffers at: aNumber ifAbsentPut: [OrderedCollection new].
			(channelBuffers at: aNumber) add: message data].

		message type = SSH_MSG_CHANNEL_EXTENDED_DATA ifTrue: [
			message channel = aNumber ifTrue: [^message data].
			channelBuffers at: aNumber ifAbsentPut: [OrderedCollection new].
			(channelBuffers at: aNumber) add: message data].

		message type = SSH_MSG_CHANNEL_REQUEST ifTrue: [
			message requestType = 'exit-signal' ifTrue: [
			self logError: 'SSH_MSG_CHANNEL_REQUEST (exit-signal): ' value: message specific]].

		message type = SSH_MSG_CHANNEL_CLOSE ifTrue: [
			self sendChannelClose: aNumber.
			^true].

		((OrderedCollection new 
			add: SSH_MSG_CHANNEL_DATA;
			add: SSH_MSG_CHANNEL_EXTENDED_DATA;
			add: SSH_MSG_CHANNEL_REQUEST;
			add: SSH_MSG_CHANNEL_CLOSE;
			add: SSH_MSG_CHANNEL_EOF;
			yourself)
				includes: message type)
				ifFalse: [self error: 'Error reading channel data']]
	
	!

hash: aString
	"Answer <aString> hashed by SHA1 hash function."

	^String withAll: ((PumaShaEngine new digest: aString asByteArray)
											collect: [:each | each asCharacter])!

hmacKeyLength
	"Answer a key length suitable for the receiver."

	^20!

hostName
	
	^hostName!

hostName: aString
	
	hostName := aString!

initialize
	"Initialize the receiver."

	errors := OrderedCollection new.
	generator := EsRandom new.
	clientConfiguration := SSHHostConfiguration defaultIdentified: 'SSH-2.0-vastseclib_0.2' cookie: self createCookie.
	serverConfiguration := SSHHostConfiguration new.
	getSequenceNumber := 0.
	sendSequenceNumber := 0.
	encryptionEnabled := false.
	channelStatus := Dictionary new.
	channelBuffers := Dictionary new.
	serverChannels := Dictionary new.
	packetSizesClientToServer := Dictionary new.
	windowSizesClientToServer := Dictionary new.
	randomValueForKey := (generator next * (2 raisedTo: 32) + 6666) asInteger
 !

initializeCompression
	"Initialize compression algorithms of the receiver."

	compressionAlgorithm := clientConfiguration compatibleCompressionAlgorithm: serverConfiguration.
	decompressionAlgorithm := clientConfiguration compatibleDecompressionAlgorithm: serverConfiguration


!

initializeEncryption
	"Initializes encryption algorithms of the receiver."

	| key newKey |
	newKey := self describeString: clientConfiguration privateKey.

	"Initialize encryption settings."
	key := self hash: newKey, exchangeHash, 'C', sessionId.
	[encryptionAlgorithm defaultKeyLength > key size] whileTrue: [
		key := key, (self hash: newKey, exchangeHash, key)].
	encryptionAlgorithm 
			key: (key copyFrom: 1 to: encryptionAlgorithm defaultKeyLength); 
			encrypt: (String withAll: ((1 to: 1536) collect: [:each | 0 asCharacter])).

	"Initialize decryption settings."
	key := self hash: newKey, exchangeHash, 'D', sessionId.
	[decryptionAlgorithm defaultKeyLength > key size] whileTrue: [
		key := key, (self hash: newKey, exchangeHash, key)].
	decryptionAlgorithm 
			key: (key copyFrom: 1 to: decryptionAlgorithm defaultKeyLength); 
			decrypt: (String withAll: ((1 to: 1536) collect: [:each | 0 asCharacter]))




!

initializeExchangeHash
	"Initializes exchange hash of the receiver connection."

	exchangeHash :=
		((ReadWriteStream on: '')
			nextPutAll: (self describeString: clientConfiguration identifier);
			nextPutAll: (self describeString: serverConfiguration identifier);
			nextPutAll: (self describeString: clientConfiguration kexInitPayload);
			nextPutAll: (self describeString: serverConfiguration kexInitPayload);
			nextPutAll: (self describeString: serverConfiguration publicKeyData);
			nextPutAll: (self describeString: clientConfiguration publicKey);
			nextPutAll: (self describeString: serverConfiguration publicKey);
			nextPutAll: (self describeString: clientConfiguration privateKey);
			yourself)
				contents.

	exchangeHash := self hash: exchangeHash.
	sessionId := exchangeHash!

initializeHMAC
	"Initializes HMAC algorithms of the receiver."

	| key newKey |
	newKey := self describeString: clientConfiguration privateKey.

	"Initialize HMAC creation."
	key := self hash: newKey, exchangeHash, 'E', sessionId.
	[self hmacKeyLength > key size] whileTrue: [
		key := key, (self hash: newKey, exchangeHash, key)].
	hmacCreateAlgorithm key: (key copyFrom: 1 to: self hmacKeyLength). 

	"Initialize HMAC check."
	key := self hash: newKey, exchangeHash, 'F', sessionId.
	[self hmacKeyLength > key size] whileTrue: [
		key := key, (self hash: newKey, exchangeHash, key)].
	hmacCheckAlgorithm key: (key copyFrom: 1 to: self hmacKeyLength)!

integerToString: anInteger
	"Answer a string representing <anInteger> in little endian format, padded to 32 bits."

	^self integerToString: anInteger bits: 32!

integerToString: anInteger bits: aNumber
	"Answer a string representing <anInteger> in little endian format, padded to <aNumber> bits."

	| stream index binary |
	binary := ''.
	stream := ReadWriteStream on: ''.
	index := 0.

	(anInteger printStringRadix: 2 padTo: aNumber) reverse do: [:each | 
		index := index + 1.
		binary := binary, each asString.
		index = 8 ifTrue: [
			index := 0. 
			stream nextPut: (self byteFromBinary: binary reverse).
			binary := '' ]].

	index > 0 ifTrue: [
		1 to: 8 - index do: [:each | binary := $0 asString, binary].
		stream nextPut: (self byteFromBinary: binary)].
	
	^stream contents reverse
	!

isServerIdentifier: aString

	^'SSH-*-*' match: aString


!

logError: anObject value: aString
	"Log a status error for <anObject> and <aString> description."

	errors add: anObject -> aString.
	self error: aString

!

login: username password: password
	"Login the receiver with <username> and <password>."

	state = ##initialized ifFalse: [self error: 'Not connected'].
	self 
		sendLoginRequest;
		check: self get type: SSH_MSG_SERVICE_ACCEPT errorMessage: 'Expected SSH_MSG_SERVICE_ACCEPT';
		sendUserAuthorization: username password: password;
		check: self get type: SSH_MSG_USERAUTH_SUCCESS errorMessage: 'Expected SSH_MSG_USERAUTH_SUCCESS'.
	state := ##logged

!

messajeFrom: aString
	"Answer a new SSH2message instance built from <aString>."

	^SSH2Message fromBytes: aString

	!

portNumber
	
	^portNumber!

portNumber: anInteger
	
	portNumber := anInteger!

randomValue
	"Answer a random integer value in range [0, 255]."

	^(generator next * 255) asInteger!

readKeyExchangeDHReply

	| value |	
	value := self get.
	self check: value type: SSH_MSG_KEXDH_REPLY errorMessage: 'Expected SSH_MSG_KEXDH_REPLY'.
	serverConfiguration configureFromDHReply: value.
	"Calculate new key."
	clientConfiguration privateKey: (keyExchangeAlgorithm createNewKeyFor: serverConfiguration publicKey randomValue: randomValueForKey)
!

readNewKeys

	self check: self get type: SSH_MSG_NEWKEYS errorMessage: 'Expected SSH_MSG_NEWKEYS'!

readServerIdentifier

	| value extraLines |
	"#TODO: Register the FTP extra lines - SEE EDITIONS."
	extraLines := OrderedCollection new.
	[socketStream atEnd or: [self isServerIdentifier: value]] whileFalse: [	
		value := socketStream nextLineCrOrLf.
		extraLines add: value].
	serverConfiguration identifier: value
!

reExchangeKeys: response
	"Perform the key exchange process. "

	serverConfiguration configureFromKeyExchangeInit: response.
	self exchangeKeys


!

registerServerData
	"Register data sent by KEXINIT message on receiver serverConfiguration."

	| response |
	response := self get.
	self check: response type: SSH_MSG_KEXINIT errorMessage: 'Expected SSH_MSG_KEXINIT'.
	serverConfiguration configureFromKeyExchangeInit: response!

send: aSSH2Message
	"Send <aSSH2Message> to server host."

	^self sendBinary: aSSH2Message contents!

sendBinary: aCollection
	"Send binary data on <aCollection> to server host."

	| packet packetLength paddingLength padding hmac |
	self checkConnectionActive.
	packetLength := aCollection size + 9.
	packetLength :=	packetLength + (((self encryptBlockSize - 1) * packetLength) \\ self encryptBlockSize).
	
	"Add random padding."
	paddingLength := packetLength - aCollection size - 5.
	padding := ''.	
	paddingLength timesRepeat: [padding := (padding ifNil: ['']), self randomValue asCharacter asString].

	packet := (self integerToString: packetLength - 4),
						paddingLength asCharacter asString,
						aCollection,
						padding.

	"Calculate HMAC hash."
	hmac := hmacCreateAlgorithm isNil
		ifTrue: ['']
		ifFalse: [hmacCreateAlgorithm hash: (self integerToString: sendSequenceNumber), packet].	
 
	sendSequenceNumber := sendSequenceNumber + 1.
	encryptionEnabled ifTrue: [packet := encryptionAlgorithm encrypt: packet].
	^socketStream nextPutAll: packet, hmac; flush


	!

sendChannelClose: aNumber
	"Send close message for channel <aNumber> to server host."

	self send: (SSH2Message messageCloseChannel: (serverChannels at: aNumber))


!

sendChannelOpen: aNumber
	"Send open message for channel <aNumber> to server host."

	self send: (SSH2Message messageOpenChannelSession: aNumber windowSize: self windowSize packetSize: 16384).
	channelStatus at: aNumber put: SSH_MSG_CHANNEL_OPEN

!

sendChannelRequest: command
	"Send request message for <command> on channel SSH_CHANNEL_EXEC to server host."

	self send: (SSH2Message messageChannelRequest: SSH_CHANNEL_EXEC command: command).
	channelStatus at: SSH_CHANNEL_EXEC put: SSH_MSG_CHANNEL_REQUEST!

sendKeyExchangeInit
	"Send key exchange init message to server host."

	self send: clientConfiguration messageForKeyExchange
	

!

sendKeys
	"Send key exchange dh init message to server host."

	clientConfiguration publicKey: (keyExchangeAlgorithm generateKey: self encryptionKeyLength x: randomValueForKey).
	self send: (SSH2Message messageKeyExchangeDHInit: clientConfiguration publicKey)
!

sendLoginRequest
	"Send login request message to server host."

	self send: SSH2Message messageSSHLoginRequest


	

	

	
!

sendNewKeys
	"Send new key message to server host."

	self send: SSH2Message messageNewKeys
!

sendString: aString
	"Send <aString> binary message to server host."

	socketStream
		nextPutAll: aString;
		nextPut: Character lf;
		flush!

sendUserAuthorization: username password: password
	"Send user authorization request message to server host for <username> and <password>."

	self send: (SSH2Message messageAuthorizationRequestUser: username password: password)

	
	

	

	
!

setInitialized
	"Finalize conection startup process of the receiver."

	state := ##initialized.
	encryptionEnabled := true
!

startup
	"Start up the connection of the receiver."

	self 
		connectSocket;
		readServerIdentifier;
		checkConnectionActive;
		validateServerIdentifier;
		sendString: clientConfiguration identifier;
		registerServerData;
		exchangeKeys;
		setInitialized





!

validateServerIdentifier
	"Validates server identifier. Signal an error if not valid."

	serverConfiguration identifier trimBlanks isEmpty
		ifTrue: [self error: 'Server identification failed'].

	(('SSH-2.0-*' match: serverConfiguration identifier) or: 
		['SSH-1.99-*' match: serverConfiguration identifier])
			ifFalse: [self error: 'Server version not compatible'].		
!

windowSize
	"Answer the maximum window size parameter of the receiver."

	^2147483647! !

PumaSSH2Connector initializeAfterLoad!


PumaSSH2Connector subclass: #PumaSFTPClient
    instanceVariableNames: 'packetBuffer requestId extensions version pwd '
    classVariableNames: ''
    poolDictionaries: 'SFTPConstants '!

!PumaSFTPClient class publicMethods !

initializePoolDictionary

	Smalltalk 
		at: #SFTPConstants
		put: (EsPoolDictionary new 
			at: 'SSH_FXP_CHANNEL' put: 2;
		"Commands constants"
			at: 'SSH_FXP_INIT' put: 1;
			at: 'SSH_FXP_VERSION' put: 2;
			at: 'SSH_FXP_OPEN' put: 3;
			at: 'SSH_FXP_CLOSE' put: 4;
			at: 'SSH_FXP_READ' put: 5;
			at: 'SSH_FXP_WRITE' put: 6;
			at: 'SSH_FXP_LSTAT' put: 7;
			at: 'SSH_FXP_SETSTAT' put: 9;
			at: 'SSH_FXP_OPENDIR' put: 11;
			at: 'SSH_FXP_READDIR' put: 12;
			at: 'SSH_FXP_REMOVE' put: 13;
			at: 'SSH_FXP_MKDIR' put: 14;
			at: 'SSH_FXP_RMDIR' put: 15;
			at: 'SSH_FXP_REALPATH' put: 16;
			at: 'SSH_FXP_STAT' put: 17;
			at: 'SSH_FXP_RENAME' put: 18;
			at: 'SSH_FXP_STATUS' put: 101;
			at: 'SSH_FXP_HANDLE' put: 102;
			at: 'SSH_FXP_DATA' put: 103;
			at: 'SSH_FXP_NAME' put: 104;
			at: 'SSH_FXP_ATTRS' put: 105;
			at: 'SSH_FXP_EXTENDED' put: 200;
		"Status constants"
			at: 'SSH_FXP_STATUS_OK' put: 0;
			at: 'SSH_FXP_STATUS_EOF' put: 1;
			at: 'SSH_FXP_STATUS_NO_SUCH_FILE' put: 2;
			at: 'SSH_FXP_STATUS_PERMISSION_DENIED' put: 3;
			at: 'SSH_FXP_STATUS_FAILURE' put: 4;
			at: 'SSH_FXP_STATUS_BAD_MESSAGE' put: 5;
			at: 'SSH_FXP_STATUS_NO_CONNECTION' put: 6;
			at: 'SSH_FXP_STATUS_CONNECTION_LOST' put: 7;
			at: 'SSH_FXP_STATUS_OP_UNSUPPORTED'put: 8;
		"Attributes flag constants"
			at: 'SSH_FXP_ATTR_SIZE' put: 1;
			at: 'SSH_FXP_ATTR_UIDGID' put: 2;
			at: 'SSH_FXP_ATTR_PERMISSIONS'  put: 4;
			at: 'SSH_FXP_ATTR_ACCESSTIME'  put: 8;
		"Open flag constants"
			at: 'SSH_FXP_OPEN_READ'  put: 1;
			at: 'SSH_FXP_OPEN_WRITE'  put: 2;
			at: 'SSH_FXP_OPEN_CREATE'  put: 8;
			at: 'SSH_FXP_OPEN_TRUNCATE' put: 10;
		"Type flag constants"
			at: 'SSH_FXP_TYPE_REGULAR' put: 1;
			at: 'SSH_FXP_TYPE_DIRECTORY' put: 2;
			at: 'SSH_FXP_TYPE_SYMLINK' put: 3;
			at: 'SSH_FXP_TYPE_SPECIAL' put: 4;
			yourself)! !

!PumaSFTPClient publicMethods !

baseName: aString
	"Answer the file name of path name in <aString>."

	^aString!

changeDirectory: aString
	"Set current directory of the receiver to <aString>."

	| dir response handle |
	dir := aString.
	dir first ~= $/ ifTrue: [dir := dir, '/'].
	dir := self realPath: dir.
	self sendSFTP: (SFTPMessage messageOpenDir: dir).
	response := self getSFTP.
	handle := self processHandleRequest: response.
	self sendSFTP: (SFTPMessage messageCloseHandle: response handle).
	response := self getSFTP.
	self processStatusRequestOk: response.
	pwd := dir.
	^true


!

checkWindowAdjust: windowSize channel: aNumber
	"Check whether window adjust should be done and performs it if so."

	(windowSizesClientToServer at: aNumber) < 0	ifTrue: [
		self send: (SSH2Message messageWindowAdjust: (serverChannels at: aNumber) size: windowSize).
		windowSizesClientToServer at: aNumber put: (windowSizesClientToServer at: aNumber) + windowSize]




	
	
	!

dirName: aString
	"Answer the directory name of path name in <aString>."

	^'.'!

getFile: aString
	"Answer a string with file contents refered by <aString>."

	^self getFile: aString progress: [:object | ]
	
	
	
!

getFile: aString in: localPath
	"Write a file in <localPath> with file contents refered by <aString>."

	| file |
	[(file := CfsWriteFileStream open: localPath)
			nextPutAll: (self getFile: aString);
			flush] ensure: [file close]


!

getFile: aString in: localPath progress: aMonadicValuable
	"Write a file in <localPath> with file contents refered by <aString>.
	Updates <aProgress> value while downloading."

	| file |
	[(file := CfsWriteFileStream open: localPath)
			nextPutAll: (self getFile: aString progress: aMonadicValuable);
			flush] ensure: [file close]!

getFile: aString progress: aMonadicValuable
	"Answer a string with file contents refered by <aString>.
	Updates <aMonadicValuable> value while downloading."

	| size remoteFile file handle |
	remoteFile := self realPath: aString.
	size := self remoteFileSize: remoteFile.
	self sendChannelRead: remoteFile.
	handle := self processHandleRequest: self getSFTP.
	file := self readFile: handle size: size progress: aMonadicValuable.
	self sendClose: handle.
	^file
	
	
	
!

getSFTP
	"Read and answer a SFTPMessage instance from server host."

	| temp length tempLength packet result |
	[packetBuffer size < 4] whileTrue: [
		temp := self getChannelPacket: SSH_FXP_CHANNEL.
		temp = true ifTrue: [packetBuffer := ''. ^false].
		packetBuffer := packetBuffer, temp].

	length := packetBuffer sshLongAt: 1.
	packetBuffer := packetBuffer copyFrom: 5 to: packetBuffer size.
	tempLength := length - packetBuffer size.

	[tempLength > 0] whileTrue: [
		temp := self getChannelPacket: SSH_FXP_CHANNEL.
		temp = true ifTrue: [packetBuffer := ''. ^false].
		packetBuffer := packetBuffer, temp.
		tempLength := tempLength - temp size].

	result := packetBuffer copyFrom: 1 to: length.
	packetBuffer := packetBuffer copyFrom: length + 1 to: packetBuffer size.
	^SFTPMessage fromBytes: result requestId: requestId!

initialize
	"Initialize the receiver."

	super initialize.
	packetBuffer := ''.
	extensions := Dictionary new!

login: username password: password
	"Login the receiver with <username> and <password>."

	super login: username password: password.
	windowSizesClientToServer at: SSH_FXP_CHANNEL put: 16384.
	self 
		sendChannelOpen: SSH_FXP_CHANNEL;
		getChannelPacket: SSH_FXP_CHANNEL;
		sendChannelRequest: SSH_FXP_CHANNEL;
		getChannelPacket: SSH_FXP_CHANNEL;
		sendFTPInit!

processAttributes: response
	"Perform actions when dealing with an attributes request on <response>.
	 Answer attributes of false if error."

	response type = SSH_FXP_ATTRS 
		ifTrue: [^response attributes].
	response type = SSH_FXP_STATUS 
		ifTrue: [self logError: response status value: response message. ^false].
	self error: 'Expected SSH_FXP_ATTRS or SSH_FXP_STATUS'
	
!

processHandleRequest: response
	"Perform actions when dealing with a handle request on <response>.
	 Answer handle or nil if error."

	response type = SSH_FXP_HANDLE 
		ifTrue: [^response handle].
	response type = SSH_FXP_STATUS 
		ifTrue: [self logError: response status value: response message. ^nil].
	self error: 'Expected SSH_FXP_HANDLE or SSH_FXP_STATUS'

!

processName: response
	"Perform actions when dealing with single name request on <response>.
	 Answer name or '' if error."

	response type = SSH_FXP_NAME 
		ifTrue: [^response names first key].
	response type = SSH_FXP_STATUS 	
		ifTrue: [self logError: response status value: response message. ^''].
	self error: 'Expected SSH_FXP_NAME or SSH_FXP_STATUS'


!

processNextStatusRequestOk: response
	"Perform actions to check next status on <response> is ok.
	 Answer whether next status is ok."

	^response nextStatus = SSH_FXP_STATUS_OK 
		ifTrue: [true]
		ifFalse: [self logError: response status value: response message.	false]



!

processReadHandle: response
	"Perform actions when dealing with a data request on <response>.
	 Answer data from <response>."

	response type = SSH_FXP_DATA
		 ifTrue: [^response data].
	response type = SSH_FXP_STATUS 
		ifTrue: [self logError: response status value: response message. ^false]
		ifFalse: [self error: 'Expected SSH_FXP_DATA or SSH_FXP_STATUS']
!

processStatusRequestOk: response
	"Perform actions to check an ok status request on <response>.
	 Answer whether check operation is correct."

	response type = SSH_FXP_STATUS
		ifFalse: [self error: 'Expected SSH_FXP_NAME or SSH_FXP_STATUS'. ^false].
	response status = SSH_FXP_STATUS_OK 
		ifFalse: [self logError: response status value: response message. ^false].
	^true


!

putFile: fileName data: data
	"Upload a file to the server host named <fileName> with contents of <data>."

	| remoteFile handle |
	remoteFile := self realPath: fileName.
	remoteFile isNil ifTrue: [^false].
	self sendCreateFile: remoteFile.
	handle := self processHandleRequest: self getSFTP.
	^self sendData: data for: handle



	
	
!

pwd
	"Answer the actual pwd on the server host."

	^pwd!

readFile: handle size: size progress: aMonadicValuable
	"Read and answer <size> bytes of file pointed by <handle>.
	 Updates progress on <aMonadicValuable> while transfering."

	| data read response localFile |
	localFile := ReadWriteStream on: ''.
	read := 0.
	[read < size]	whileTrue: [
		self sendSFTP: (SFTPMessage messageReadHandle: handle read: read from: 0 windowSize: (2 raisedTo: 20)).
		response := self getSFTP.
		data := self processReadHandle: response.
		data isNil ifTrue: [^false].
		read := read + data size.
		localFile nextPutAll: data.
		aMonadicValuable value: (localFile contents size * 100 / size) asScaledDecimal integerPart asInteger].

	self sendSFTP: (SFTPMessage messageCloseHandle: handle).
	response := self getSFTP.
	self processStatusRequestOk: response.
	(self processNextStatusRequestOk: response) ifFalse: [^false].
	^localFile contents
	
!

readPutResponses: anInteger

	| i |
	i := anInteger.
	[i > 0] whileTrue: [
		self processStatusRequestOk: self getSFTP.
		i := i - 1 ].
	^true!

realPath: aString
	"This protocol represents file names as strings. File names are
   assumed to use the slash ('/') character as a directory separator.
   File names starting with a slash are 'absolute', and are relative to
   the root of the file system.  Names starting with any other character
   are relative to the user's default directory (home directory)."

	| file realPath length dir |
	file := ''.
	dir := aString.
	pwd notNil ifTrue: [
		aString last ~= $/ ifTrue: [
			file := self baseName: dir.
			dir := self dirName: dir].
		(dir = '.' or: [dir = pwd]) ifTrue: [^pwd, file].
		dir first ~= $/ ifTrue: [dir := pwd, '/', dir]].

	self sendSFTP: (SFTPMessage messageRealPath: dir).
	realPath := self processName: self getSFTP.
	^realPath, '/', file!

remoteFileSize: aString
	"Answer size in bytes of file refered by <aString>."

	^(self remoteFileStatus: aString) at: 'size'!

remoteFileStatus: aString
	"Answer attributes for file refered by <aString>."

	self sendSFTP: (SFTPMessage messageFileStat: aString).
	^self processAttributes: self getSFTP	!

sendChannelRead: aString
	"Send read data message for <aString> to server host."

	self sendSFTP: (SFTPMessage messageOpenRead: aString)!

sendChannelRequest: aNumber
	"Send request message for channel <aNumber> to server host."
 
	self send: (SSH2Message messageSFTPChannelRequest: (serverChannels at: aNumber)).
	channelStatus at: aNumber put: SSH_MSG_CHANNEL_REQUEST
!

sendClose: handle
	"Send close handle message for <handle> to server host."

	self sendSFTP: (SFTPMessage messageCloseHandle: handle)!

sendCreateFile: aString
	"Send create file <aString> message to server host."

	self sendSFTP: (SFTPMessage messageOpenWriteForced: aString)!

sendData: aString for: handle
	"Send binary data on <aString> to server host throught <handle>."

	| sent size i stream break temp data maxValue message |
	data := aString.
	size := data size.
	break := false.
	sent := 0.
	i := 0.
	
	[sent < size or: [break]] whileTrue: [
		maxValue := self sftpPacketSize min: data size.
		temp := data copyFrom: 1 to: maxValue.
		data := data copyFrom: maxValue + 1 to: data size.
		message := SFTPMessage messageWriteHandle: handle flag: 0 sentBytes: sent bytes: temp.
		self sendSFTP: message.
		sent := sent + message basicContents size.
		i := i + 1.	
		i = 50 ifTrue: [
			(self readPutResponses: i) ifFalse: [break := true].
			i := 0]].

	self readPutResponses: i.
	self sendSFTP: (SFTPMessage messageCloseHandle: handle).
	^self processStatusRequestOk: self getSFTP
!

sendFTPInit
	"Send SFTP init message to server host."

	| response |
	channelStatus at: SSH_FXP_CHANNEL put: SSH_MSG_CHANNEL_DATA.
	self sendSFTP: SFTPMessage messageSFTPInit.
	response := self getSFTP.
	self check: response type: SSH_FXP_VERSION errorMessage: 'Expected SSH_FXP_VERSION'.
	self verifyServerVersion: response.
	requestId := 1.
	pwd := self realPath: '.'
!

sendSFTP: aSFTPMessage
	"Send <aSFTPMessage> to server host."

	requestId notNil ifTrue: [aSFTPMessage requestId: requestId].
	^self sendToChannel: SSH_FXP_CHANNEL data: aSFTPMessage contents

	

	!

sendToChannel: aNumber data: aString
	"Send <aString> data to channel <aNumber>."

	[aString size > (packetSizesClientToServer at: aNumber)] 
		whileTrue: [
			windowSizesClientToServer 
				at: aNumber 
				put: (windowSizesClientToServer at: aNumber) - (packetSizesClientToServer at: aNumber).
			self checkWindowAdjust: self windowSize channel: aNumber.
			self send: (SSH2Message 
										messageChannel: (serverChannels at: aNumber) 
										data: (aString copyFrom: 1 to: (packetSizesClientToServer at: aNumber)))].

	windowSizesClientToServer at: aNumber put: (windowSizesClientToServer at: aNumber) - aString size.
	self checkWindowAdjust: self windowSize channel: aNumber.
	^self send: (SSH2Message messageChannel: (serverChannels at: aNumber) data: aString)

	
	
	
	!

sftpPacketSize
	"Answer the packet size parameter for sftp transfers."

	^4096!

verifyServerVersion: aSFTPMessage
	"Verify server version is compatible, signal an error if else."

	aSFTPMessage version = 3 ifFalse: [self error: 'Incompatible SFTP version'].
	version := aSFTPMessage version! !

PumaSFTPClient initializeAfterLoad!


Object subclass: #SFTPMessage
    instanceVariableNames: 'type requestId '
    classVariableNames: ''
    poolDictionaries: 'SFTPConstants '!

!SFTPMessage class publicMethods !

associatedMessageTypes

	^#()!

fromBytes: aString requestId: requestId
	
	| type dataIndex |
	type := aString first value.
	dataIndex := requestId notNil ifTrue: [6] ifFalse: [2].
	^SFTPMessage fromType: type data: (aString copyFrom: dataIndex to: aString size)!

fromType: type data: aString

	^(self messageFor: type)
			buildFrom: aString;
			yourself!

messageClassFor: aNumber

	^self allSubclasses 
		detect: [:each | each associatedMessageTypes includes: aNumber]
		ifNone: [self]!

messageCloseHandle: handle

	^(self messageFor: SSH_FXP_CLOSE)
		data: handle;
		yourself!

messageFileStat: aString

	^(self messageFor: SSH_FXP_STAT)
		data: aString;
		yourself!

messageFor: aNumber

	^(self messageClassFor: aNumber) new
		type: aNumber;
		yourself!

messageOpenDir: aString 

	^(self messageFor: SSH_FXP_OPENDIR)
		data: aString;
		yourself!

messageOpenRead: aString 

	^(self messageFor: SSH_FXP_OPEN)
		file: aString;
		flags: SSH_FXP_OPEN_READ;
		attributes: 0;
		yourself
!

messageOpenWriteForced: aString 

	^(self messageFor: SSH_FXP_OPEN)
		file: aString;
		flags: ((SSH_FXP_OPEN_WRITE bitOr: SSH_FXP_OPEN_CREATE) bitOr: SSH_FXP_OPEN_TRUNCATE);
		attributes: 0;
		yourself!

messageReadHandle: handle read: bytes from: start windowSize: windowSize
		
	^(self messageFor: SSH_FXP_READ)
		handle: handle;
		start: start;
		read: bytes;
		windowSize: windowSize;
		yourself!

messageRealPath: aString 

	^(self messageFor: SSH_FXP_REALPATH)
		data: aString;
		yourself



!

messageSFTPInit

	^(self messageFor: SSH_FXP_INIT)
		data: 0 asCharacter asString, 0 asCharacter asString, 0 asCharacter asString, 3 asCharacter asString;
		yourself!

messageWriteHandle: handle flag: anInteger sentBytes: sentBytes bytes: aString
		
	^(self messageFor: SSH_FXP_WRITE)
		handle: handle;
		flag: anInteger;
		sent: sentBytes;
		bytes: aString;
		yourself! !

!SFTPMessage publicMethods !

basicContents

	^self binaryDescription inject: '' into: [:total :each | total, (each contentsFor: self)]!

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^OrderedCollection new!

buildFrom: aString
	"Build the receiver from <aString>."

	| stream |
	stream := ReadStream on: aString.
	self binaryDescription do: [:each | each build: self from: stream]!

byteFromBinary: aString

	| value |
	value := 0.
	aString reverse doWithIndex: [:each :index | 
		each = $1 ifTrue: [value := value + (2 raisedTo: index - 1)]].
	^value asCharacter!

contents 
	"Answer a Collection with binary contents of the receiver."	

	^self describeString: type asCharacter asString, self requestIdDescription, self basicContents



!

describeString: aString
	"Answer a binary representation for <aString>."

	^(self integerToString: aString size), aString


!

integerToString: anInteger
	"Answer a string representing <anInteger> in little endian format, padded to 32 bits."

	^self integerToString: anInteger bits: 32!

integerToString: anInteger bits: aNumber
	"Answer a string representing <anInteger> in little endian format, padded to <aNumber> bits."

	| stream index binary |
	binary := ''.
	stream := ReadWriteStream on: ''.
	index := 0.

	(anInteger printStringRadix: 2 padTo: aNumber) reverse do: [:each | 
		index := index + 1.
		binary := binary, each asString.
		index = 8 ifTrue: [
			index := 0. 
			stream nextPut: (self byteFromBinary: binary reverse).
			binary := '' ]].

	index > 0 ifTrue: [
		1 to: 8 - index do: [:each | binary := $0 asString, binary].
		stream nextPut: (self byteFromBinary: binary)].
	
	^stream contents reverse
	!

requestId

	^requestId!

requestId: anObject

	requestId := anObject!

requestIdDescription

	^requestId isNil
		ifTrue: [''] 
		ifFalse: [self integerToString: requestId]!

type

	^type!

type: anObject

	type := anObject! !

SFTPMessage initializeAfterLoad!


SFTPMessage subclass: #SFTPMessageAttributes
    instanceVariableNames: 'attributes '
    classVariableNames: ''
    poolDictionaries: ''!

!SFTPMessageAttributes class publicMethods !

associatedMessageTypes

	^Array 
			with: SSH_FXP_ATTRS
! !

!SFTPMessageAttributes publicMethods !

attributes

	 ^attributes!

buildFrom: aString
	"Build the receiver from <aString>."

	super buildFrom: aString.
	self parseAttributes: aString!

parseAttributes: aString
	"Parse attributes from <aString> and place them into attributes instance variable."

	| flags value upper size |
	value := aString.
	flags := value sshLongAt: 1.
	value := value copyFrom: 5 to: value size.
	attributes := Dictionary new.

	(flags bitAnd: SSH_FXP_ATTR_SIZE) ~= 0 ifTrue: [
		upper := value sshLongAt: 1. 
		size := value sshLongAt: 2. 
		attributes at: 'size' put: 
			(upper ~= 0
				ifTrue: [(2 raisedTo: 32) - 1]
				ifFalse: [size < 0 ifTrue: [(size bitAnd: 2147483647) + 134217728] ifFalse: [size]])]! !

SFTPMessageAttributes initializeAfterLoad!


SFTPMessage subclass: #SFTPMessageData
    instanceVariableNames: 'data '
    classVariableNames: ''
    poolDictionaries: ''!

!SFTPMessageData class publicMethods !

associatedMessageTypes

	^OrderedCollection new 
		add: SSH_FXP_DATA;
		add: SSH_FXP_INIT;
		add: SSH_FXP_REALPATH;
		add: SSH_FXP_OPENDIR;
		add: SSH_FXP_CLOSE;
		add: SSH_FXP_STAT;
		yourself! !

!SFTPMessageData publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection
			with: (SSHMessageFieldString for: #data))!

data

	^data!

data: anObject

	data := anObject! !

SFTPMessageData initializeAfterLoad!


SFTPMessage subclass: #SFTPMessageHandle
    instanceVariableNames: 'handle '
    classVariableNames: ''
    poolDictionaries: ''!

!SFTPMessageHandle class publicMethods !

associatedMessageTypes

	^Array 
			with: SSH_FXP_HANDLE
! !

!SFTPMessageHandle publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection
			with: (SSHMessageFieldString for: #handle))
!

handle

	 ^handle!

handle: anObject

	handle := anObject! !

SFTPMessageHandle initializeAfterLoad!


SFTPMessage subclass: #SFTPMessageName
    instanceVariableNames: 'id names fileName attributes '
    classVariableNames: ''
    poolDictionaries: ''!

!SFTPMessageName class publicMethods !

associatedMessageTypes

	^Array 
			with: SSH_FXP_NAME
! !

!SFTPMessageName publicMethods !

attributes

	^attributes!

attributes: anObject

	attributes := anObject!

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection
			with: (SSHMessageFieldInteger for: #id)
			with: (SSHMessageFieldString for: #fileName)
			with: (SSHMessageFieldString for: #attributes))
!

fileName

	^fileName!

fileName: anObject

	fileName := anObject!

id

	^id!

id: anObject

	id := anObject!

names

	^OrderedCollection with: fileName -> attributes! !

SFTPMessageName initializeAfterLoad!


SFTPMessage subclass: #SFTPMessageOpen
    instanceVariableNames: 'file flags attributes '
    classVariableNames: ''
    poolDictionaries: ''!

!SFTPMessageOpen class publicMethods !

associatedMessageTypes

	^Array 
			with: SSH_FXP_OPEN! !

!SFTPMessageOpen publicMethods !

attributes

	^attributes
!

attributes: anObject

	attributes := anObject
!

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection
			with: (SSHMessageFieldString for: #file)
			with: (SSHMessageFieldInteger for: #flags)
			with: (SSHMessageFieldInteger for: #attributes))

!

file

	^file
!

file: anObject

	file := anObject
!

flags

	^flags
!

flags: anObject

	flags := anObject
! !

SFTPMessageOpen initializeAfterLoad!


SFTPMessage subclass: #SFTPMessageRead
    instanceVariableNames: 'handle read start windowSize '
    classVariableNames: ''
    poolDictionaries: ''!

!SFTPMessageRead class publicMethods !

associatedMessageTypes

	^Array 
			with: SSH_FXP_READ! !

!SFTPMessageRead publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection
			with: (SSHMessageFieldString for: #handle)
			with: (SSHMessageFieldInteger for: #start)
			with: (SSHMessageFieldInteger for: #read)
			with: (SSHMessageFieldInteger for: #windowSize))


!

handle

	^handle!

handle: anObject

	handle := anObject!

read

	^read!

read: anObject

	read := anObject!

start

	^start!

start: anObject

	start := anObject!

windowSize

	^windowSize!

windowSize: anObject

	windowSize := anObject! !

SFTPMessageRead initializeAfterLoad!


SFTPMessage subclass: #SFTPMessageStatus
    instanceVariableNames: 'status message rawData '
    classVariableNames: ''
    poolDictionaries: ''!

!SFTPMessageStatus class publicMethods !

associatedMessageTypes

	^Array 
			with: SSH_FXP_STATUS! !

!SFTPMessageStatus publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection
			with: (SSHMessageFieldInteger for: #status)
			with: (SSHMessageFieldString for: #message))




	!

buildFrom: aString
	"Build the receiver from <aString>."

	super buildFrom: aString.
	rawData := aString
	!

message
	
	^message!

message: anObject
	
	message := anObject!

nextStatus
	
	| str length |
	length := rawData sshLongAt: 2.
	str := rawData copyFrom: 9 + length to: rawData size.
	^str sshLongAt: 1
!

status
	^status!

status: anObject
	
	status := anObject! !

SFTPMessageStatus initializeAfterLoad!


SFTPMessage subclass: #SFTPMessageVersion
    instanceVariableNames: 'version '
    classVariableNames: ''
    poolDictionaries: ''!

!SFTPMessageVersion class publicMethods !

associatedMessageTypes

	^Array 
			with: SSH_FXP_VERSION! !

!SFTPMessageVersion publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection
			with: (SSHMessageFieldInteger for: #version))
!

version
	
	^version!

version: anObject
	
	version := anObject! !

SFTPMessageVersion initializeAfterLoad!


SFTPMessage subclass: #SFTPMessageWrite
    instanceVariableNames: 'handle sent bytes flag '
    classVariableNames: ''
    poolDictionaries: ''!

!SFTPMessageWrite class publicMethods !

associatedMessageTypes

	^Array 
			with: SSH_FXP_WRITE! !

!SFTPMessageWrite publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection 
			with: (SSHMessageFieldString for: #handle)
			with: (SSHMessageFieldInteger for: #flag)
			with: (SSHMessageFieldInteger for: #sent)
			with: (SSHMessageFieldString for: #bytes))


!

bytes
	^bytes!

bytes: anObject
	
	bytes := anObject!

flag
	^flag!

flag: anObject

	flag := anObject!

handle
	^handle!

handle: anObject

	handle := anObject!

sent
	^sent!

sent: anObject

	sent := anObject! !

SFTPMessageWrite initializeAfterLoad!


Object subclass: #SocketEmulator
    instanceVariableNames: 'index readBuffer writeBuffer socket '
    classVariableNames: ''
    poolDictionaries: ''!

!SocketEmulator class publicMethods !

new

	^super new
		initialize!

newSocket: aSocketStream

	^super new
		socket: aSocketStream;
		initialize! !

!SocketEmulator publicMethods !

_data1
	"Flujo de datos para una coneccion, ejecuta pwd y ejecuta ls -la."

	^#(
		#(0 0 3 12 10 20 163 218)
		#(44 233 34 129 219 187 164 107 41 174 240 187 242 76 0 0 0 126 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 45 101 120 99 104 97 110 103 101 45 115 104 97 50 53 54 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 45 101 120 99 104 97 110 103 101 45 115 104 97 49 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 49 52 45 115 104 97 49 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 49 45 115 104 97 49 0 0 0 15 115 115 104 45 114 115 97 44 115 115 104 45 100 115 115 0 0 0 157 97 101 115 49 50 56 45 99 116 114 44 97 101 115 49 57 50 45 99 116 114 44 97 101 115 50 53 54 45 99 116 114 44 97 114 99 102 111 117 114 50 53 54 44 97 114 99 102 111 117 114 49 50 56 44 97 101 115 49 50 56 45 99 98 99 44 51 100 101 115 45 99 98 99 44 98 108 111 119 102 105 115 104 45 99 98 99 44 99 97 115 116 49 50 56 45 99 98 99 44 97 101 115 49 57 50 45 99 98 99 44 97 101 115 50 53 54 45 99 98 99 44 97 114 99 102 111 117 114 44 114 105 106 110 100 97 101 108 45 99 98 99 64 108 121 115 97 116 111 114 46 108 105 117 46 115 101 0 0 0 157 97 101 115 49 50 56 45 99 116 114 44 97 101 115 49 57 50 45 99 116 114 44 97 101 115 50 53 54 45 99 116 114 44 97 114 99 102 111 117 114 50 53 54 44 97 114 99 102 111 117 114 49 50 56 44 97 101 115 49 50 56 45 99 98 99 44 51 100 101 115 45 99 98 99 44 98 108 111 119 102 105 115 104 45 99 98 99 44 99 97 115 116 49 50 56 45 99 98 99 44 97 101 115 49 57 50 45 99 98 99 44 97 101 115 50 53 54 45 99 98 99 44 97 114 99 102 111 117 114 44 114 105 106 110 100 97 101 108 45 99 98 99 64 108 121 115 97 116 111 114 46 108 105 117 46 115 101 0 0 0 105 104 109 97 99 45 109 100 53 44 104 109 97 99 45 115 104 97 49 44 117 109 97 99 45 54 52 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 115 104 97 49 45 57 54 44 104 109 97 99 45 109 100 53 45 57 54 0 0 0 105 104 109 97 99 45 109 100 53 44 104 109 97 99 45 115 104 97 49 44 117 109 97 99 45 54 52 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 115 104 97 49 45 57 54 44 104 109 97 99 45 109 100 53 45 57 54 0 0 0 21 110 111 110 101 44 122 108 105 98 64 111 112 101 110 115 115 104 46 99 111 109 0 0 0 21 110 111 110 101 44 122 108 105 98 64 111 112 101 110 115 115 104 46 99 111 109 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0)
		#(0 0 2 188 10 31 0 0)
		#(1 21 0 0 0 7 115 115 104 45 114 115 97 0 0 0 1 35 0 0 1 1 0 205 30 61 212 42 184 46 116 215 65 206 93 108 3 177 166 115 92 198 9 233 194 248 102 142 15 116 89 51 38 55 207 168 38 30 128 147 159 106 193 181 239 6 209 45 57 198 207 204 135 56 166 231 33 188 217 127 52 165 73 31 129 71 140 107 44 252 48 138 102 92 62 201 142 120 83 144 57 92 247 230 214 26 165 25 231 78 109 55 74 177 93 241 118 237 212 104 61 195 63 91 152 166 114 146 88 232 7 196 133 88 124 249 94 246 163 2 133 224 250 164 71 85 129 44 152 117 43 85 246 105 172 86 89 3 119 197 142 218 40 117 79 172 100 71 12 101 71 161 231 161 70 91 51 173 130 111 71 159 2 18 167 210 215 156 65 7 243 81 111 80 113 255 224 136 94 92 29 80 192 172 197 42 210 73 12 108 87 34 88 23 241 227 58 63 225 159 220 219 186 127 57 229 177 177 152 74 10 172 253 104 229 28 61 105 196 89 248 182 185 86 76 115 247 138 96 200 40 49 74 80 148 73 203 211 179 218 63 107 243 20 248 44 90 111 119 242 83 39 54 180 162 104 157 249 101 0 0 0 128 100 81 222 196 72 76 136 8 87 72 142 12 238 136 199 148 250 152 208 169 142 144 218 187 124 50 127 29 157 211 109 80 25 174 236 26 38 63 153 74 10 240 131 225 178 253 158 102 252 218 166 22 157 49 204 166 74 65 40 40 227 102 133 45 217 170 158 106 21 80 235 138 144 119 227 182 87 5 162 26 188 15 237 11 28 249 92 116 31 26 151 241 230 171 31 201 66 167 203 175 160 4 207 128 157 10 202 126 148 143 243 133 225 236 91 113 212 157 164 75 137 197 244 46 13 60 198 178 0 0 1 15 0 0 0 7 115 115 104 45 114 115 97 0 0 1 0 193 139 207 119 35 214 55 78 86 132 206 206 207 253 49 205 141 3 117 8 154 89 225 10 104 235 6 98 138 220 199 133 222 238 88 2 214 101 230 43 47 158 68 174 23 98 78 20 87 163 126 166 190 239 36 29 169 202 248 176 203 193 228 12 81 81 194 255 57 189 10 129 213 177 153 247 198 209 132 96 122 10 183 54 211 189 215 212 244 54 63 39 12 158 245 249 210 137 38 102 20 20 194 54 69 89 117 43 139 133 122 161 158 233 14 30 73 178 45 151 59 183 191 165 102 114 83 204 221 109 144 250 188 155 120 164 33 249 78 96 16 174 23 218 97 157 114 255 4 173 191 98 137 11 164 223 7 22 55 80 107 199 24 184 193 38 78 55 216 58 228 3 82 202 217 59 243 110 119 183 42 191 87 200 225 24 193 10 249 158 32 188 174 53 32 177 157 183 17 117 69 18 196 53 58 60 208 255 92 133 189 2 206 207 193 162 88 36 124 83 122 206 217 192 47 214 35 25 57 101 196 61 52 152 113 161 238 38 231 251 181 219 247 157 24 221 114 205 65 37 127 35 109 254 9 22 0 0 0 0 0 0 0 0 0 0)
		#(0 0 0 12 10 21 0 0)
		#(0 0 0 0 0 0 0 0)
		#(41 19 183 31 137 26 109 133)
		#(111 0 93 205 104 65 247 57 74 235 213 113 15 102 18 62 122 105 8 208 192 231 157 174)
		#(72 126 153 254 251 244 230 92 31 111 51 158 37 103 37 177 234 117 130 216)
		#(93 228 161 8 106 41 94 187)
		#(40 193 156 49 83 208 134 83)
		#(132 29 57 192 133 61 111 233 249 61 8 22 99 35 254 214 187 174 66 161)
		#(36 120 184 210 215 217 111 188)
		#(55 55 87 245 24 100 219 136 29 98 151 111 230 17 140 27 52 23 163 30 198 1 130 61)
		#(55 104 217 53 65 13 115 130 31 123 162 94 77 116 203 56 149 14 5 207)
		#(125 23 175 91 103 159 172 207)
		#(139 73 251 196 109 15 28 139 232 233 54 23 0 231 2 120)
		#(82 151 149 70 189 224 251 186 38 49 77 35 70 61 117 153 133 1 189 98)
		#(32 248 180 255 112 247 224 167)
		#(253 4 211 248 19 113 35 188)
		#(218 202 76 85 146 2 194 65 240 55 255 221 96 107 233 40 74 154 237 33)
		#(23 188 154 170 253 188 33 114)
		#(37 64 99 95 232 228 230 11 137 52 242 77 8 18 210 253 121 169 5 255 238 246 244 184)
		#(81 139 137 87 206 208 134 233 162 190 79 69 246 147 251 124 247 208 87 22)
		#(217 186 76 220 157 205 3 69)
		#(160 77 44 53 229 34 170 37)
		#(112 89 31 242 78 125 52 139 132 28 191 40 89 195 81 153 50 116 136 83)
		#(31 21 191 55 223 118 14 225)
		#(24 97 121 199 113 64 25 240 214 122 200 183 196 176 24 246 30 246 14 49 166 185 120 83 157 102 48 53 210 104 50 57)
		#(7 73 230 112 102 229 81 67 110 164 5 147 219 251 215 1 97 144 205 137)
		#(46 190 34 159 237 37 242 193)
		#(137 3 161 250 198 85 47 216)
		#(111 211 95 194 33 42 62 200 128 218 152 123 54 245 36 248 37 209 39 16)
		#(176 22 128 226 251 103 102 240)
		#(115 46 245 43 87 102 235 82 72 180 46 112 182 224 87 240 113 212 185 14 1 176 113 36)
		#(165 253 107 106 194 55 5 155 224 3 240 96 78 7 97 111 11 164 62 38)
		#(26 79 216 219 203 219 175 67)
		#(238 186 61 72 255 22 202 152 169 253 128 86 151 88 140 41)
		#(65 104 160 52 241 101 76 56 186 62 41 27 129 211 87 126 78 121 58 89)
		#(247 85 34 110 65 67 141 135)
		#(126 97 64 37 136 110 84 244)
		#(244 161 183 229 159 97 217 22 208 197 41 213 98 80 140 103 56 9 125 244)
		#(156 0 21 232 51 109 72 84)
		#(5 41 20 195 124 196 123 208 99 188 21 10 46 215 65 124 54 220 77 208 92 21 165 4 82 14 147 42 217 126 32 238 196 134 183 14 75 2 178 107 87 249 221 115 26 138 177 55 19 112 247 34 132 61 211 151 147 219 139 232 157 75 150 181 251 79 16 222 209 145 51 227 163 219 1 239 2 180 108 193 71 181 141 53 233 80 130 135)
		#(179 48 203 232 118 29 174 217 252 36 75 133 23 237 110 82 240 125 181 15)
		#(79 87 92 121 243 237 160 110)
		#(46 100 37 46 45 10 45 57 214 246 209 57 191 101 172 34 188 118 190 184 214 3 82 177 182 113 138 165 103 131 215 108 175 238 249 207 15 220 131 20 182 116 72 228 137 3 83 184 6 135 15 96 242 46 145 225 242 8 244 19 248 153 114 215 179 41 168 16 83 181 104 44)
		#(7 73 241 122 157 25 7 16 109 128 180 211 155 151 174 254 110 35 181 86)
		#(114 88 58 113 210 5 101 91)
		#(82 215 240 244 17 17 130 149 31 208 133 247 252 222 252 48 93 219 36 28 191 209 12 210 49 244 132 41 34 66 16 96 76 200 203 216 203 239 146 95 243 244 182 126 136 144 169 130 215 65 118 78 72 127 191 11 233 210 147 136 111 181 210 113 56 160 147 216 242 251 25 180 139 168 102 67 143 186 156 94 90 15 8 108 252 154 101 250 86 253 236 56 81 233 122 85 113 197 202 126 139 129 242 84 98 98 243 4 105 127 61 232 204 255 245 29 26 65 195 172 125 51 45 109 200 103 61 36 83 116 59 227 49 132 7 55 18 14 129 82 227 150 100 173 248 90 124 153 106 77 162 25 137 122 211 2 202 136 161 91 245 187 167 10 92 183 183 66 205 145 79 209 153 149 188 24 227 237 128 10 76 8 165 118 173 252 163 230 223 251 159 162 252 118 102 36 171 233 198 236 221 52 35 68 101 173 143 95)
		#(190 194 210 18 166 160 134 47 241 30 64 18 32 117 183 72 60 66 200 62)
		#(32 231 103 222 3 173 143 237)
		#(239 127 246 43 66 218 144 198 182 100 41 230 252 198 133 149 24 230 203 228 102 199 2 221 239 151 185 78 139 195 187 229 243 143 219 187 217 166 247 169 41 30 41 155 238 226 199 121 214 44 152 146 11 222 169 68 143 55 131 228 197 132 253 159 80 121 41 144 96 222 130 142 57 60 83 170 108 11 209 181 129 251 71 59 138 232 170 0 199 33 54 35 177 165 27 56 28 78 194 211 238 22 238 154 117 15 43 81 250 8 154 73 237 203 60 180 84 16 166 88 107 110 249 176 7 136 240 56 246 76 128 187 166 35 91 69 98 188 72 78 202 106 243 98 48 87 249 52 175 138 157 8 249 216 52 69 132 29 198 151 89 47 177 211 37 118 222 228 173 137 71 190 76 170 243 41 148 112 41 173 229 86 151 255 29 14 156 118 27 121 91 228 31 173 67 202 197 87 155 159 222 123 111 22 110 7 3 52 227 103 147 118 179 152 138 124 105 84 57 61 248 239 22 69)
		#(70 31 215 197 135 41 98 87 171 198 241 220 84 91 163 247 235 152 111 81)
		#(240 65 185 242 167 207 38 20)
		#(155 120 30 20 216 16 158 130 151 28 63 108 40 32 81 138 117 131 77 1 35 137 234 190 20 78 255 120 95 106 202 146 146 100 35 116 60 84 48 160 206 76 149 90 99 42 114 4 177 176 8 69 76 9 55 174 65 64 204 173 121 101 251 68 126 251 247 38 197 177 39 214 25 46 146 56 192 101 191 113 60 206 168 240 129 115 77 169 86 134 59 52 184 51 202 202 220 183 211 200 246 244 190 152 219 22 225 23 124 0 186 12 1 192 160 220 236 65 57 167 168 99 102 106 242 101 254 206 221 66 219 197 32 75 106 230 78 131 215 251 36 90 155 226 10 98 186 212 223 197 228 121 20 94 137 194 206 232 203 253 116 176 210 11 95 3 0 185 205 140 177 38 169 140 4 107 229 170 128 234 203 154 149 3 97 159 132 99 89 144 229 11 225 184 116 245 166 7 253 195 255 83 83 98 127 105 175 73 123 93 231 98 175 75 74 89 254 115 80 163 253 77 154 243 195 60 141 195 139 130 81 90 212 120 32 77 212 224 228 184 137 88 11 225 170 202 18 193 172 12 44 242 175 132 212 248 190 88 42 193 199 57 29 149 247 199 122 133 193 47 103 102 154 32 42 104 192 68 19 49 30 188 2 89 12 55 185 111 64 160 249 133 59 194 29 42 82 31 94 155 88 215 220 181 104 117 123 74 89 90 91 56 204 32 205 80 81 29 60 109 207 5 157 60 112 102 19 65 193 166 76 62 208 107 111 183 143 137 8 54 130 67 82 156 94 153 149 68 233 218 124 233 210 156 250 101 223 21 10 5)
		#(70 17 92 103 197 108 105 189 21 177 247 66 195 74 148 148 125 17 219 151)
		#(35 122 2 206 73 224 120 168)
		#(94 75 113 9 161 189 199 105 146 42 98 234 201 210 18 32 131 26 56 48 217 80 156 199 64 135 122 255 40 165 74 248 121 232 230 79 117 164 16 71 69 183 28 74 237 160 208 109 186 129 4 117 94 65 98 98 198 171 73 222 9 198 97 134 177 210 115 15 34 45 163 155 38 56 17 245 30 119 94 205 246 88 53 206 46 112 2 242 115 31 171 53 60 9 123 138 138 152 158 244 1 152 45 153 12 231 199 39 161 57 51 41 59 13 177 18 247 65 188 113 86 167 235 158 213 214 65 174 250 142 84 114 157 230 228 73 9 123 37 63 109 46 123 140 127 4 197 218 64 201 31 5 177 55 204 109 194 28 175 57 103 37 52 42 19 173 72 228 29 151 71 236 92 138 200 43 70 160 69 195 82 173 151 84 105 146 215 0 66 150 30 229 76 137 105 100 95 61 130 190 120 178 5 179 88 173 120 31 209 33 155 37 117 141 118 81 117 204 131 246 128 96 165 251 253 40 64 159 237 212 251 153 207 39 21 178 161 125 229 99 146 237 51 63 175 252 138 124 183 190 4 210 6 202 100 158 102 175 146 111 189 115 101 128 211 184 10 208 76 157 8 219 99 198 154 86 248 217 137 112 82 124 233 240 141 211 93 126 44 199 44 129 43 62 13 200 45 236 87 92 228 199 22 207)
		#(102 236 149 19 160 21 198 88 149 63 193 179 79 243 57 191 88 218 23 178)
		#(140 55 171 59 207 108 141 40)
		#(143 47 118 5 221 234 198 66 105 104 39 67 55 170 204 177 4 76 114 51 132 132 31 217 249 44 47 248 247 233 193 1 225 218 219 220 235 107 171 66 149 151 202 78 159 33 41 29 233 254 175 92 185 246 78 88 185 22 38 11 66 250 185 183 83 15 108 198 154 68 87 32 43 211 155 237 55 2 95 111 150 76 214 25 68 209 30 70 51 200 216 0 211 24 64 254 33 14 253 89 137 12 152 226 204 30 138 242 214 84 188 191 188 218 100 63 221 205 198 236 144 136 178 196 121 68 6 154 57 244 117 176 184 89 105 134 127 216 160 43 53 227 78 15 15 96 30 220 40 80 85 131 170 38 97 231 228 194 6 130 129 93 2 20 102 232 194 174 253 19 195 133 179 51 167 68 160 128 221 167 234 96 97 69 202 130 175 216 100 31 102 160 102 170 221 90 178 62 79 210 131 68 187 85 203 47 132 101 163 199 83 185 28 178 39 73 244 114 123 224 115 81 167 243 37 95 147 13 15 235 108 112 11 129 208 214 169 137 45 68 122 104 211 231 158 49 217 53 129 186 75 162 201 227 86 241 49 182 219 202 43 111 93 66 84 30 158 154 217 161 9 163 13 188 54 216 86 119 134 171 170 148 65 173 50 161 107 118 51 56 187 190 103 61 223 69 125 250 185 214 42 169 208 93 172 77 111 223 10 46 124 132 255 115 239 208 176 85 74 200 36 103 105 154 4 52 238 126 33 78 149 247 123 45 86 205 193 89 111 55 165 101 28 190 253 32 165 230 216 90 79 247 90 90 20 35 24 235 169 32 185 2 131 43 125 248 38 128)
		#(200 221 34 7 73 47 64 222 230 90 37 251 175 207 22 203 219 56 31 56)
		#(66 134 249 211 237 161 241 82)
		#(24 202 107 65 46 169 76 85 241 216 251 220 87 133 239 98 253 170 214 173 170 141 26 66 12 19 211 145 84 96 163 68 194 123 101 70 40 71 175 78 140 229 182 242 237 87 223 44 141 220 102 244 230 248 62 92 125 90 74 150 108 40 40 4 16 35 17 255 137 76 80 141 74 147 24 141 151 5 132 7)
		#(145 70 92 222 237 223 207 50 188 80 228 43 39 204 201 47 17 79 178 210)
		#(11 108 62 17 146 10 191 122)
		#(156 208 77 133 136 232 129 251 68 150 146 182 115 101 170 249 209 205 208 2 36 234 5 240 178 41 71 138 33 173 14 59 93 83 49 204 54 22 15 82 169 124 75 64 33 100 200 201 139 186 207 194 240 125 248 51 82 78 164 46 214 242 108 231 197 188 237 77 56 82 32 56 140 124 207 90 195 83 114 190 225 132 212 249 15 114 190 105 190 161 139 110 108 124 119 78 139 11 228 203 224 83 221 17 102 181 98 3 128 74 234 192 164 170 52 210 63 72 81 110 59 82 59 119 245 46 120 138 33 96 67 105 164 17 205 100 88 97 189 124 233 242 157 66 66 142 201 176 53 12 5 6 127 153 126 137 78 250 50 84 65 84 26 52 63 32 156 9 54 209 243 237 226 240 23 36 163 221 166 54 35 38 46 53 90 85 149 170 16 47 33 221 18 51 33 252 42 96 250 97 146 240 168 153 78 82 223 203 66 183 16 176 181 64 13 65)
		#(208 124 150 48 88 48 199 117 1 4 78 23 134 160 254 41 186 236 99 65)
		#(70 135 179 119 139 17 50 28)
		#(203 110 124 163 203 134 20 64 189 39 36 6 2 161 87 156 47 53 18 210 12 76 91 130 152 169 105 38 250 11 213 2 83 115 138 186 26 132 73 9 74 82 154 20 100 71 131 99 102 147 237 18 178 194 152 72 134 10 225 201 196 152 6 149 24 216 200 23 228 224 235 81 215 250 228 221 53 44 191 49 121 105 43 216 211 76 53 141 232 157 110 76 97 36 128 183 82 191 194 6 138 73 162 55 11 172 26 140 245 72 18 240 213 49 80 134 109 200 175 46 51 87 149 240 86 204 0 81 31 184 212 2 135 135 250 107 11 62 94 4 173 15 98 236 152 185 216 173 252 70 56 22 93 178 78 89 57 54 249 154 154 90 100 94 253 31 86 30 120 72 136 57 60 69 105 4 218 77 208 26 245 198 109 134 241 116 244 115 175 250 78 193 106 83 246 43 173 91 153 223)
		#(9 149 136 208 80 15 38 219 117 106 38 222 108 56 188 193 138 124 200 238)
		#(63 141 159 110 93 252 190 246)
		#(23 3 41 56 221 211 39 88 94 38 98 143 88 214 21 25 119 42 71 64 44 151 152 25 25 247 154 0 71 111 100 251 124 96 168 60 141 6 22 122 75 96 206 152 150 23 165 70 194 208 78 146 88 118 133 172 159 91 171 13 232 125 152 201 82 49 155 182 47 254 232 151 249 82 130 64 115 244 49 96 63 18 91 230 52 219 14 253 81 202 221 13 244 32 209 38 100 218 37 34 230 27 49 143 125 138 227 183 121 236 5 59 164 27 104 64 129 237 166 155 211 247 109 152 238 94 51 147 0 144 70 77 22 251 239 124 198 133 115 143 100 72 164 227)
		#(157 69 239 42 93 206 13 196 90 15 117 109 8 90 102 78 17 205 146 110)
		#(186 64 202 4 227 194 104 145)
		#(140 139 117 39 212 178 69 170)
		#(245 79 171 254 244 156 88 153 116 64 56 176 62 249 97 35 23 176 180 17)
		#(216 251 179 65 233 148 190 3)
		#(157 65 94 66 138 147 196 31 155 80 26 215 66 205 250 131 171 238 45 194 167 103 213 49 82 109 253 35 145 34 247 75)
		#(200 110 249 167 84 25 224 0 71 136 151 238 73 141 149 17 191 201 82 95)
		#(148 58 216 151 54 201 23 222)
		#(223 129 61 57 94 131 181 25)
		#(218 141 253 190 134 6 11 49 46 238 232 87 93 114 117 72 203 120 46 3)
		)!

_data2
	
	^#(#(0 0 3 12 10 20 134 246)
#(16 74 101 71 62 235 129 159 34 220 211 215 76 59 0 0 0 126 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 45 101 120 99 104 97 110 103 101 45 115 104 97 50 53 54 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 45 101 120 99 104 97 110 103 101 45 115 104 97 49 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 49 52 45 115 104 97 49 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 49 45 115 104 97 49 0 0 0 15 115 115 104 45 114 115 97 44 115 115 104 45 100 115 115 0 0 0 157 97 101 115 49 50 56 45 99 116 114 44 97 101 115 49 57 50 45 99 116 114 44 97 101 115 50 53 54 45 99 116 114 44 97 114 99 102 111 117 114 50 53 54 44 97 114 99 102 111 117 114 49 50 56 44 97 101 115 49 50 56 45 99 98 99 44 51 100 101 115 45 99 98 99 44 98 108 111 119 102 105 115 104 45 99 98 99 44 99 97 115 116 49 50 56 45 99 98 99 44 97 101 115 49 57 50 45 99 98 99 44 97 101 115 50 53 54 45 99 98 99 44 97 114 99 102 111 117 114 44 114 105 106 110 100 97 101 108 45 99 98 99 64 108 121 115 97 116 111 114 46 108 105 117 46 115 101 0 0 0 157 97 101 115 49 50 56 45 99 116 114 44 97 101 115 49 57 50 45 99 116 114 44 97 101 115 50 53 54 45 99 116 114 44 97 114 99 102 111 117 114 50 53 54 44 97 114 99 102 111 117 114 49 50 56 44 97 101 115 49 50 56 45 99 98 99 44 51 100 101 115 45 99 98 99 44 98 108 111 119 102 105 115 104 45 99 98 99 44 99 97 115 116 49 50 56 45 99 98 99 44 97 101 115 49 57 50 45 99 98 99 44 97 101 115 50 53 54 45 99 98 99 44 97 114 99 102 111 117 114 44 114 105 106 110 100 97 101 108 45 99 98 99 64 108 121 115 97 116 111 114 46 108 105 117 46 115 101 0 0 0 105 104 109 97 99 45 109 100 53 44 104 109 97 99 45 115 104 97 49 44 117 109 97 99 45 54 52 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 115 104 97 49 45 57 54 44 104 109 97 99 45 109 100 53 45 57 54 0 0 0 105 104 109 97 99 45 109 100 53 44 104 109 97 99 45 115 104 97 49 44 117 109 97 99 45 54 52 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 115 104 97 49 45 57 54 44 104 109 97 99 45 109 100 53 45 57 54 0 0 0 21 110 111 110 101 44 122 108 105 98 64 111 112 101 110 115 115 104 46 99 111 109 0 0 0 21 110 111 110 101 44 122 108 105 98 64 111 112 101 110 115 115 104 46 99 111 109 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0)
#(0 0 2 188 9 31 0 0)
#(1 21 0 0 0 7 115 115 104 45 114 115 97 0 0 0 1 35 0 0 1 1 0 205 30 61 212 42 184 46 116 215 65 206 93 108 3 177 166 115 92 198 9 233 194 248 102 142 15 116 89 51 38 55 207 168 38 30 128 147 159 106 193 181 239 6 209 45 57 198 207 204 135 56 166 231 33 188 217 127 52 165 73 31 129 71 140 107 44 252 48 138 102 92 62 201 142 120 83 144 57 92 247 230 214 26 165 25 231 78 109 55 74 177 93 241 118 237 212 104 61 195 63 91 152 166 114 146 88 232 7 196 133 88 124 249 94 246 163 2 133 224 250 164 71 85 129 44 152 117 43 85 246 105 172 86 89 3 119 197 142 218 40 117 79 172 100 71 12 101 71 161 231 161 70 91 51 173 130 111 71 159 2 18 167 210 215 156 65 7 243 81 111 80 113 255 224 136 94 92 29 80 192 172 197 42 210 73 12 108 87 34 88 23 241 227 58 63 225 159 220 219 186 127 57 229 177 177 152 74 10 172 253 104 229 28 61 105 196 89 248 182 185 86 76 115 247 138 96 200 40 49 74 80 148 73 203 211 179 218 63 107 243 20 248 44 90 111 119 242 83 39 54 180 162 104 157 249 101 0 0 0 129 0 196 83 236 226 228 154 182 118 120 100 143 165 49 139 141 145 89 26 245 154 190 82 102 96 199 66 131 22 6 83 12 48 133 178 147 195 30 28 26 110 102 92 94 77 4 135 58 92 201 32 142 167 72 176 160 24 170 233 171 125 73 44 88 72 189 62 18 150 141 102 118 7 34 104 25 35 233 251 0 195 24 96 176 197 181 236 60 213 18 210 123 174 1 55 135 187 40 179 217 57 63 80 62 149 213 117 67 214 53 207 42 106 248 99 163 83 107 187 68 117 196 36 104 117 108 80 81 144 0 0 1 15 0 0 0 7 115 115 104 45 114 115 97 0 0 1 0 146 185 189 94 114 85 109 134 169 221 71 120 234 116 135 177 191 196 42 144 51 233 102 191 23 136 102 235 152 134 99 63 154 15 78 138 17 63 95 208 98 217 220 39 118 206 115 52 61 151 56 171 4 70 58 131 169 76 232 10 70 173 29 197 28 4 124 183 87 199 115 45 28 66 73 60 9 139 96 113 28 137 131 209 65 208 58 208 78 247 239 176 115 30 83 139 145 171 99 192 249 228 95 67 243 79 6 41 60 141 16 163 194 247 156 85 223 172 131 16 111 55 140 8 200 251 11 219 175 252 203 77 96 169 71 183 41 27 209 50 199 176 34 99 56 90 39 122 54 79 173 219 98 92 28 76 216 23 88 179 13 148 203 90 28 25 224 6 213 27 113 160 16 209 46 128 112 202 77 54 191 92 243 185 139 193 220 79 180 166 244 6 225 59 136 184 56 86 148 17 211 148 160 227 252 225 192 112 202 197 164 165 232 144 207 111 196 87 71 132 7 108 150 134 116 221 99 233 124 13 12 71 104 175 75 108 246 53 93 137 200 168 151 246 224 129 56 126 113 219 225 74 122 26 121 22 0 0 0 0 0 0 0 0 0)
#(0 0 0 12 10 21 0 0)
#(0 0 0 0 0 0 0 0)
#(18 185 1 85 235 134 197 254)
#(133 70 60 238 41 34 4 250 178 6 156 184 225 187 62 225 200 100 67 212 123 58 137 46)
#(163 77 79 93 113 95 219 219 96 187 158 86 250 102 104 79 54 240 226 44)
#(10 213 40 149 204 78 136 111)
#(35 188 16 117 27 44 207 226)
#(184 240 198 247 98 193 118 113 127 233 5 12 198 152 10 36 177 152 234 59)
#(83 76 69 20 105 205 33 56)
#(201 41 29 215 230 30 54 77 205 44 187 232 184 155 204 106 60 93 37 216 86 203 154 229)
#(92 186 245 236 230 186 66 147 234 185 29 16 253 95 91 222 182 210 3 99)
#(182 186 131 24 118 115 18 62)
#(139 158 4 104 20 3 118 150 230 8 241 129 62 47 125 252)
#(26 3 154 10 66 154 37 127 38 45 156 108 192 50 75 111 254 89 14 6)
#(181 109 237 252 108 223 46 98)
#(231 103 79 193 199 107 220 216)
#(111 152 50 238 204 28 126 175 169 167 98 238 216 86 137 27 180 171 138 141)
#(17 159 16 25 174 170 12 78)
#(17 190 26 187 125 210 162 1 9 104 115 164 175 94 176 123 78 31 227 242 139 214 206 54)
#(16 6 206 50 77 87 108 101 145 15 124 201 175 208 158 211 12 206 219 24)
#(187 249 112 244 128 139 233 98)
#(159 35 182 142 147 119 1 85)
#(59 59 152 114 66 238 164 46 89 134 246 32 4 231 216 12 91 196 234 173)
#(176 221 194 147 114 148 188 13)
#(92 95 22 102 6 77 133 154 231 207 223 191 193 211 22 52 147 40 107 167 232 163 81 149 93 74 56 151 153 105 196 178)
#(115 111 196 202 21 106 207 161 142 240 85 8 227 123 210 82 124 196 122 91)
#(189 9 27 55 0 174 111 135)
#(183 148 119 119 180 234 211 26)
#(63 0 122 41 143 149 23 22 229 82 26 26 173 30 40 16 231 14 70 239)
#(174 126 183 229 91 240 62 17)
#(144 152 3 222 142 180 246 147 126 168 132 70 212 205 222 151 56 81 81 17 231 28 212 13)
#(246 233 168 26 162 65 125 197 73 106 149 215 17 75 34 175 248 59 19 7)
#(183 228 126 4 12 194 223 74)
#(228 190 127 145 57 40 89 246 147 45 147 173 134 2 100 0)
#(30 240 129 225 123 61 70 19 47 216 216 190 182 228 93 42 113 103 91 135)
#(224 239 68 227 107 79 106 230)
#(203 2 174 229 87 182 175 39)
#(226 76 197 167 180 110 25 100 96 49 56 240 102 243 35 84 66 224 197 56)
#(24 35 21 70 176 69 93 86)
#(88 55 7 140 132 37 95 208 237 14 201 97 175 234 3 76 15 108 187 218 222 88 249 124 99 230 160 90 118 237 156 252 166 164 29 15 1 113 234 65 78 115 14 100 54 119 23 110 241 169 148 101 234 96 99 108 106 255 174 54 82 254 36 121 85 94 209 107 189 182 18 195 193 116 127 53 75 114 25 10 121 157 222 15 72 56 66 63)
#(144 99 138 23 212 104 150 219 204 75 63 143 16 81 21 142 12 119 158 94)
#(157 138 57 187 210 12 15 1)
#(29 2 229 199 97 197 186 121 56 109 99 125 130 125 71 136 10 17 178 15 140 42 99 0 128 236 20 96 7 101 181 112 38 127 61 212 29 65 213 159 255 247 5 163 139 128 211 100 95 193 159 227 22 79 255 10 78 32 73 114 234 135 225 109 13 11 107 26 129 128 130 61)
#(112 185 172 123 204 19 133 182 12 244 233 36 45 194 174 73 19 206 4 183)
#(111 159 143 41 151 134 1 249)
#(255 67 102 197 12 245 224 131 163 221 54 126 38 227 195 235 33 0 216 13 132 48 91 154 60 24 80 249 228 172 0 160 29 140 168 182 119 186 36 78 60 252 184 213 41 166 220 79 140 51 164 187 2 119 213 185 22 204 68 192 52 35 8 136 64 18 157 44 156 69 78 55 150 103 67 230 198 28 238 49 30 68 247 24 219 147 252 56 239 12 151 119 151 98 40 180 106 85 81 236 202 127 45 135 119 180 3 30 125 211 185 107 133 125 130 177 174 147 186 186 53 253 205 184 45 24 231 163 49 209 44 69 210 184 244 83 193 29 126 200 68 6 153 68 25 134 79 151 179 250 165 190 28 153 130 82 233 118 175 183 29 52 196 70 178 9 136 37 51 132 61 167 240 210 2 128 1 241 209 214 75 118 200 242 245 37 142 124 216 125 38 172 227 148 158 157 173 11 145 221 159 25 120 9 126 97 12 132)
#(255 7 188 35 89 193 71 240 114 80 226 48 107 254 202 214 229 247 149 244)
#(52 34 42 60 35 93 179 237)
#(104 232 173 39 22 77 90 41 31 129 53 190 130 217 204 218 99 225 44 233 114 63 19 9 210 208 185 248 151 250 53 36 21 86 98 101 95 156 203 160 147 197 41 167 248 232 84 253 42 71 184 77 112 231 30 59 7 248 48 14 17 142 9 230 184 171 158 91 90 234 104 163 119 227 188 186 59 145 46 207 224 54 38 23 148 47 70 62 62 61 48 225 231 186 162 59 148 225 151 239 70 163 124 209 22 189 174 220 143 116 46 5 58 142 206 15 51 55 18 13 33 142 226 118 75 92 71 121 232 5 220 254 228 109 84 144 95 209 177 27 245 214 66 225 56 65 175 248 143 140 195 242 12 7 153 32 176 79 162 206 124 79 83 225 72 15 236 166 46 207 113 222 249 237 105 99 238 148 233 73 41 196 136 60 115 158 208 121 135 140 20 18 145 168 210 104 201 196 163 20 161 43 224 191 155 72 237 23 136 255 6 145 215 16 17 58 24 235 210 118 0 232 251 157)
#(29 179 206 60 154 228 117 139 231 253 30 171 3 232 188 225 205 76 71 139)
#(239 123 12 62 85 151 86 29)
#(98 69 37 170 74 34 193 63 16 70 223 10 72 8 121 254 152 210 169 143 7 21 64 192 213 165 242 41 81 111 15 255 10 176 86 96 175 104 27 125 42 125 248 82 42 178 250 186 128 182 85 107 141 189 90 112 34 174 85 106 82 13 120 254 6 17 248 145 27 30 252 99 180 129 58 213 109 195 104 254 238 71 203 52 240 183 81 153 62 133 179 151 144 208 20 57 209 153 183 122 126 165 7 254 96 2 115 37 14 165 127 96 197 81 150 249 88 168 104 163 150 180 6 39 132 251 223 129 206 0 242 100 18 211 18 159 250 17 236 137 104 153 0 25 38 64 95 103 23 173 197 9 69 200 108 98 216 31 253 128 218 55 141 126 112 143 99 155 17 80 16 85 137 186 158 62 71 61 158 41 204 93 242 255 182 176 244 241 116 48 128 152 15 241 193 214 79 233 68 204 239 114 135 197 26 226 109 87 39 74 194 189 168 91 233 29 81 240 233 236 140 177 51 204 215 160 193 159 122 182 110 83 235 208 144 229 24 145 138 142 244 148 250 53 63 144 116 59 209 255 161 43 23 173 39 229 222 132 61 85 88 116 88 209 142 112 63 83 65 167 177 38 125 136 242 103 179 211 156 94 61 184 147 139 254 105 79 74 117 252 203 133 202 149 176 31 167 204 204 116 239 161 238 114 140 25 0 72 38 240 64 115 147 225 183 128 20 112 50 106 72 33 185 139 82 247 170 151 97 91 217 18 40 53 182 24 228 215 161 105 232 234 138 227 72 62 106 192 57 3 103 35 22 23 188 32 69 170 171 13)
#(235 99 192 204 245 19 21 167 45 14 124 207 19 187 213 15 3 84 221 143)
#(140 191 116 35 154 196 74 247)
#(200 99 133 127 111 57 10 4 117 149 191 44 223 202 26 182 148 133 167 204 221 155 52 66 161 157 39 9 16 168 177 0 201 116 104 23 223 107 190 208 157 251 217 118 80 101 128 123 66 75 25 79 32 49 132 60 213 159 31 177 241 167 171 149 220 157 207 139 81 188 155 7 42 51 159 209 140 50 120 108 246 84 91 91 11 130 95 176 165 192 85 88 63 21 212 237 84 36 135 55 176 145 71 113 150 222 223 114 215 118 128 75 251 147 67 12 170 49 18 167 171 206 235 195 68 37 105 32 27 139 105 94 195 156 213 95 7 63 29 214 158 75 11 31 141 181 139 160 147 66 69 115 67 191 9 129 11 146 229 114 115 69 234 180 122 83 62 51 69 189 91 21 18 178 122 100 159 100 73 141 215 125 26 49 94 227 111 82 118 71 63 185 186 47 233 98 7 217 31 74 214 117 37 167 3 191 196 177 33 60 143 96 10 150 69 2 37 149 51 157 137 165 226 106 16 121 142 82 170 87 239 229 67 119 204 81 209 2 40 115 125 222 96 204 116 166 223 202 13 224 72 157 51 167 28 216 18 26 113 18 102 174 122 196 151 70 85 171 244 255 104 205 207 88 90 210 104 59 119 27 27 122 125 116 189 170 176 93 250 102 157 142 243 245 161 180 69 84 49 41 205 232 212 214)
#(211 135 107 114 113 217 2 99 20 214 135 40 35 170 149 202 24 72 226 198)
#(245 11 103 211 93 31 231 1)
#(80 174 129 118 117 213 217 171 247 43 231 27 202 72 29 226 169 219 238 156 18 38 140 13 9 74 216 242 157 102 45 177 142 89 198 115 237 128 249 7 238 198 6 250 174 115 143 15 126 21 28 35 190 229 205 19 166 112 45 209 133 219 242 136 219 45 97 243 145 65 43 255 190 107 203 33 178 26 97 103 128 125 238 20 233 17 17 128 85 54 64 215 228 254 206 182 96 65 31 75 225 124 146 242 157 74 79 6 54 166 155 80 204 97 171 57 29 58 40 202 146 101 89 76 36 178 108 52 192 157 41 127 102 39 91 12 254 138 30 165 111 144 57 235 121 222 10 110 32 242 13 111 203 154 93 99 94 154 242 248 230 206 246 119 249 140 150 218 235 30 38 218 109 153 204 32 167 190 79 4 169 52 198 8 152 199 244 84 34 187 159 222 7 248 157 251 103 218 173 252 31 142 27 87 39 156 42 180 242 82 141 143 234 150 46 150 206 140 132 31 214 74 234 21 178 25 14 108 213 100 242 128 211 175 171 97 128 99 10 115 100 221 122 241 66 245 114 87 198 74 54 100 195 12 170 206 30 161 67 192 37 141 24 192 172 49 164 115 7 66 56 224 98 179 144 84 189 75 27 190 228 115 134 123 160 39 79 109 193 206 169 10 152 32 156 13 170 7 85 160 0 29 198 227 50 180 174 69 52 48 37 206 243 199 62 109 249 166 178 142 209 86 150 81 171 106 112 143 191 239 173 195 226 221 243 207 113 35 80 50 180 100 114 138 58 244 3 184 52 253 149 181 247 107 191 101 37 124 237 52 53 52 47 235 178 185 89 107)
#(55 234 162 200 51 110 139 102 234 28 120 27 232 64 14 240 113 242 108 97)
#(50 107 76 74 200 142 64 86)
#(184 0 226 78 105 91 217 206 157 140 49 130 153 16 103 239 9 210 238 113 35 247 237 31 122 161 77 93 50 213 144 249 45 201 153 70 163 5 180 109 124 0 110 86 159 38 140 139 3 250 197 155 184 177 80 172 154 232 136 6 140 60 59 131 146 15 219 204 168 183 186 173 171 190 112 73 4 65 181 2)
#(58 32 105 184 90 82 85 142 64 129 230 37 93 188 191 42 44 46 23 32)
#(239 249 77 29 124 255 178 216)
#(249 228 86 177 57 204 205 100 53 113 104 188 164 79 209 21 244 251 108 103 94 30 228 47 231 87 37 89 140 253 248 3 47 221 159 187 5 245 238 88 68 38 82 54 52 201 226 125 199 163 174 15 193 118 47 178 2 145 190 71 56 205 238 238 70 140 134 19 164 234 185 124 172 1 64 67 28 86 55 219 120 76 232 48 25 59 153 122 212 254 66 178 149 34 184 225 253 179 33 200 179 126 71 155 108 153 111 169 249 129 142 189 14 229 152 102 200 239 129 249 191 153 120 189 175 116 235 74 9 35 73 176 224 201 6 92 200 207 225 75 33 196 168 108 15 195 61 21 151 74 16 196 206 226 91 30 6 100 60 178 147 27 105 166 2 160 161 202 157 15 220 93 102 111 38 255 68 235 175 137 229 11 35 226 6 166 12 86 70 56 222 131 59 45 160 254 174 54 126 82 12 162 124 215 50 132 80 246 12 12 102 8 226 190 118 76)
#(10 187 47 48 198 74 228 106 43 170 220 211 192 200 18 163 79 177 219 82)
#(77 243 80 160 133 44 98 25)
#(114 191 114 75 13 52 56 78 179 87 183 192 243 49 204 62 244 28 100 67 84 134 183 49 58 23 187 232 88 220 156 126 41 19 156 238 38 226 67 8 179 112 39 89 176 12 78 159 179 43 186 205 24 150 192 98 255 32 2 245 48 166 241 61 57 128 117 68 70 2 95 198 59 157 106 89 209 5 124 62 188 217 207 194 101 115 200 123 206 84 156 33 207 46 98 206 228 198 120 39 245 16 25 194 202 88 249 160 115 78 224 82 248 107 189 28 2 22 158 63 211 182 109 45 79 127 239 247 154 85 164 142 120 186 216 61 10 109 77 240 168 139 198 121 33 78 48 30 175 39 24 187 115 47 166 59 249 199 116 90 228 193 65 244 195 37 99 223 242 118 29 190 94 238 110 120 230 64 77 42 191 209 88 217 213 139 239 230 235 154 142 12 77 238 29 246 70 22 80 92)
#(166 153 250 195 46 29 72 143 226 191 62 190 45 241 170 227 91 148 175 99)
#(154 80 142 64 136 130 183 138)
#(168 85 202 228 215 42 190 201 27 205 223 154 69 115 66 191 114 42 168 180 122 162 113 185 232 216 3 90 49 160 235 24 204 50 89 222 126 171 44 188 2 187 95 142 120 166 9 75 43 148 221 175 127 6 27 226 100 219 203 239 93 103 180 41 110 77 48 113 109 205 156 73 35 214 140 35 227 111 202 164 242 143 181 179 149 21 0 30 217 228 172 108 27 119 43 154 53 55 150 26 58 123 112 39 250 216 182 28 10 208 128 1 125 70 8 192 124 108 96 48 130 167 211 114 58 211 27 32 246 226 32 15 101 236 70 209 82 117 201 192 250 163 123 210)
#(129 40 157 123 165 235 139 85 56 242 139 85 232 126 159 208 88 193 223 195)
#(52 22 75 130 165 55 104 2)
#(171 118 126 216 84 140 135 29)
#(80 36 118 183 213 8 204 1 182 222 74 184 133 236 59 180 198 107 172 82)
#(109 254 144 135 76 33 140 235)
#(2 243 160 162 240 77 180 50 30 160 247 8 237 40 29 124 174 156 165 204 43 242 133 10 35 89 111 234 3 186 254 172)
#(38 138 178 141 188 222 113 148 101 248 192 6 2 6 238 47 172 86 109 46)
#(68 207 196 76 169 179 202 195)
#(27 82 232 70 232 235 245 251)
#(16 232 224 16 166 48 136 223 78 180 189 35 127 178 85 91 247 51 6 150)
)!

_data3
	"Flujo de datos para una coneccion, ejecuta pwd y ejecuta ls -la.
   salida1.txt"

	^#(#(0 0 3 12 10 20 135 132 ) 
#(59 68 129 21 131 60 92 249 78 240 154 149 139 252 0 0 0 126 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 45 101 120 99 104 97 110 103 101 45 115 104 97 50 53 54 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 45 101 120 99 104 97 110 103 101 45 115 104 97 49 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 49 52 45 115 104 97 49 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 49 45 115 104 97 49 0 0 0 15 115 115 104 45 114 115 97 44 115 115 104 45 100 115 115 0 0 0 157 97 101 115 49 50 56 45 99 116 114 44 97 101 115 49 57 50 45 99 116 114 44 97 101 115 50 53 54 45 99 116 114 44 97 114 99 102 111 117 114 50 53 54 44 97 114 99 102 111 117 114 49 50 56 44 97 101 115 49 50 56 45 99 98 99 44 51 100 101 115 45 99 98 99 44 98 108 111 119 102 105 115 104 45 99 98 99 44 99 97 115 116 49 50 56 45 99 98 99 44 97 101 115 49 57 50 45 99 98 99 44 97 101 115 50 53 54 45 99 98 99 44 97 114 99 102 111 117 114 44 114 105 106 110 100 97 101 108 45 99 98 99 64 108 121 115 97 116 111 114 46 108 105 117 46 115 101 0 0 0 157 97 101 115 49 50 56 45 99 116 114 44 97 101 115 49 57 50 45 99 116 114 44 97 101 115 50 53 54 45 99 116 114 44 97 114 99 102 111 117 114 50 53 54 44 97 114 99 102 111 117 114 49 50 56 44 97 101 115 49 50 56 45 99 98 99 44 51 100 101 115 45 99 98 99 44 98 108 111 119 102 105 115 104 45 99 98 99 44 99 97 115 116 49 50 56 45 99 98 99 44 97 101 115 49 57 50 45 99 98 99 44 97 101 115 50 53 54 45 99 98 99 44 97 114 99 102 111 117 114 44 114 105 106 110 100 97 101 108 45 99 98 99 64 108 121 115 97 116 111 114 46 108 105 117 46 115 101 0 0 0 105 104 109 97 99 45 109 100 53 44 104 109 97 99 45 115 104 97 49 44 117 109 97 99 45 54 52 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 115 104 97 49 45 57 54 44 104 109 97 99 45 109 100 53 45 57 54 0 0 0 105 104 109 97 99 45 109 100 53 44 104 109 97 99 45 115 104 97 49 44 117 109 97 99 45 54 52 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 115 104 97 49 45 57 54 44 104 109 97 99 45 109 100 53 45 57 54 0 0 0 21 110 111 110 101 44 122 108 105 98 64 111 112 101 110 115 115 104 46 99 111 109 0 0 0 21 110 111 110 101 44 122 108 105 98 64 111 112 101 110 115 115 104 46 99 111 109 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ) 
#(0 0 2 188 9 31 0 0 ) 
#(1 21 0 0 0 7 115 115 104 45 114 115 97 0 0 0 1 35 0 0 1 1 0 205 30 61 212 42 184 46 116 215 65 206 93 108 3 177 166 115 92 198 9 233 194 248 102 142 15 116 89 51 38 55 207 168 38 30 128 147 159 106 193 181 239 6 209 45 57 198 207 204 135 56 166 231 33 188 217 127 52 165 73 31 129 71 140 107 44 252 48 138 102 92 62 201 142 120 83 144 57 92 247 230 214 26 165 25 231 78 109 55 74 177 93 241 118 237 212 104 61 195 63 91 152 166 114 146 88 232 7 196 133 88 124 249 94 246 163 2 133 224 250 164 71 85 129 44 152 117 43 85 246 105 172 86 89 3 119 197 142 218 40 117 79 172 100 71 12 101 71 161 231 161 70 91 51 173 130 111 71 159 2 18 167 210 215 156 65 7 243 81 111 80 113 255 224 136 94 92 29 80 192 172 197 42 210 73 12 108 87 34 88 23 241 227 58 63 225 159 220 219 186 127 57 229 177 177 152 74 10 172 253 104 229 28 61 105 196 89 248 182 185 86 76 115 247 138 96 200 40 49 74 80 148 73 203 211 179 218 63 107 243 20 248 44 90 111 119 242 83 39 54 180 162 104 157 249 101 0 0 0 129 0 226 38 231 238 191 229 174 149 201 8 4 39 232 103 162 202 194 134 9 61 233 157 245 20 190 248 243 216 74 125 179 27 185 42 156 1 139 107 149 86 219 116 195 135 51 189 24 155 16 78 52 241 162 217 139 146 32 74 186 64 29 44 153 212 229 68 84 206 253 76 102 18 241 55 110 51 88 7 125 184 208 77 13 186 117 141 74 247 206 128 7 74 215 70 89 164 236 202 135 250 174 76 173 165 9 156 112 47 137 17 21 81 1 125 36 113 241 164 200 188 110 148 131 252 204 108 222 255 0 0 1 15 0 0 0 7 115 115 104 45 114 115 97 0 0 1 0 89 73 80 231 207 97 168 136 62 80 222 34 226 196 179 184 209 166 79 193 74 127 237 37 39 232 12 2 123 233 158 116 93 11 62 60 208 185 83 166 87 200 28 178 92 164 98 227 222 140 133 36 113 121 202 163 28 225 115 25 94 237 153 32 141 39 143 99 63 227 214 18 33 66 154 134 58 31 4 56 148 125 54 81 162 183 253 22 241 50 28 127 120 243 82 175 18 6 135 176 43 180 134 238 153 226 165 195 245 122 230 60 1 50 139 237 218 117 30 186 97 85 12 97 195 212 198 212 72 182 157 125 26 80 98 176 170 115 26 81 24 103 131 137 223 205 143 89 134 80 141 169 176 239 248 236 208 71 17 181 184 90 233 149 72 102 41 104 138 244 39 60 218 37 245 109 42 148 156 249 204 15 56 61 159 133 231 205 107 45 234 15 141 148 64 19 103 213 43 151 212 9 141 127 114 9 239 99 159 107 177 253 98 184 236 61 217 176 87 248 185 69 191 86 223 114 255 123 42 228 236 1 135 226 223 65 219 23 34 140 218 1 186 204 39 51 194 204 252 157 3 57 204 60 150 70 0 0 0 0 0 0 0 0 0 ) 
#(0 0 0 12 10 21 0 0 ) 
#(0 0 0 0 0 0 0 0 ) 
#(45 239 75 78 180 22 196 210 ) 
#(217 183 69 244 25 100 77 138 169 109 167 125 158 77 177 232 234 224 148 106 97 66 140 49 ) 
#(15 80 100 206 248 22 217 146 84 75 217 225 11 143 42 132 145 64 111 224 ) 
#(4 10 25 237 55 19 73 59 ) 
#(181 145 62 220 207 248 187 68 ) 
#(84 234 61 99 192 179 9 152 126 50 250 95 192 133 34 174 10 139 82 196 ) 
#(11 231 223 195 111 88 248 82 ) 
#(214 171 5 202 51 102 96 240 32 89 155 36 36 246 55 191 53 123 89 14 242 198 26 247 ) 
#(203 206 95 109 156 189 83 113 83 86 19 126 95 122 122 122 244 234 239 249 ) 
#(199 94 69 207 215 56 130 202 ) 
#(164 162 186 190 41 2 208 134 132 163 148 169 178 37 157 172 ) 
#(61 98 233 97 168 120 214 58 98 165 69 176 223 77 108 87 247 101 188 204 ) 
#(213 90 30 121 84 221 204 207 ) 
#(59 84 16 111 73 140 29 165 ) 
#(135 224 155 13 87 220 56 161 64 180 130 58 190 226 191 177 82 83 242 138 ) 
#(16 194 195 51 217 6 38 78 ) 
#(248 202 137 239 78 218 151 196 30 169 41 201 103 36 177 170 1 6 234 69 216 141 44 64 ) 
#(48 153 240 72 158 115 92 226 117 130 55 35 188 136 15 103 70 67 45 7 ) 
#(169 206 149 43 208 162 71 209 ) 
#(212 48 61 20 109 158 151 69 ) 
#(18 190 157 75 140 67 129 58 139 57 31 46 104 161 231 230 112 33 244 196 ) 
#(233 127 38 59 143 107 71 71 ) 
#(126 242 230 83 221 67 236 160 217 61 114 241 91 68 28 168 130 101 33 42 220 108 200 182 1 81 190 254 145 4 157 96 ) 
#(190 38 204 217 2 69 218 162 88 120 211 155 174 42 81 156 26 14 170 125 ) 
#(47 155 22 17 42 16 111 161 ) 
#(136 145 148 113 207 116 39 95 ) 
#(64 179 119 34 235 99 250 48 99 52 120 171 214 41 121 176 191 153 27 75 ) 
#(44 226 50 218 20 110 128 16 ) 
#(11 148 109 38 154 224 97 7 234 191 240 103 221 135 28 113 81 246 233 52 49 142 254 62 ) 
#(137 8 96 227 178 46 168 22 152 89 79 206 90 67 57 203 214 238 102 73 ) 
#(176 125 25 187 158 111 231 17 ) 
#(255 131 66 28 97 213 129 69 97 21 187 189 2 216 122 51 ) 
#(95 4 213 254 52 204 16 255 209 74 115 212 183 85 15 20 229 134 16 155 ) 
#(196 248 155 53 148 161 241 153 ) 
#(225 94 42 146 130 145 190 201 ) 
#(180 191 178 200 106 43 18 128 51 197 31 228 172 142 57 255 238 200 74 6 ) 
#(190 212 157 107 89 46 171 219 ) 
#(239 246 222 146 115 172 3 221 89 84 148 40 246 235 223 86 228 76 135 205 73 104 94 144 168 11 225 16 116 134 81 79 76 231 1 136 125 69 137 48 150 196 156 109 191 164 102 99 174 105 73 226 74 73 1 17 99 172 231 152 158 215 220 191 232 123 66 106 45 121 7 22 76 5 129 77 100 8 225 42 208 239 142 128 218 215 120 51 ) 
#(211 215 47 112 115 243 210 33 3 32 92 54 158 223 149 187 79 113 170 182 ) 
#(172 137 221 12 243 242 39 193 ) 
#(17 114 166 65 110 10 96 191 161 221 249 207 250 190 93 49 147 148 149 7 29 12 176 143 50 147 189 54 101 241 65 178 92 34 154 32 152 66 28 254 252 250 20 83 252 60 217 255 2 227 45 190 140 66 69 53 193 44 26 101 209 203 157 207 232 213 64 53 196 20 6 225 ) 
#(170 188 245 133 224 106 143 173 245 77 146 254 208 239 120 120 222 72 8 78 ) 
#(44 231 201 63 57 122 254 43 ) 
#(8 225 203 63 112 136 5 137 82 33 193 115 16 197 27 161 57 23 45 180 96 133 34 17 38 154 144 195 133 66 32 12 97 181 111 226 96 75 111 31 13 180 226 208 88 37 190 14 151 130 104 173 85 78 7 150 241 230 73 8 201 137 245 176 120 72 214 23 176 15 44 118 94 78 102 197 108 249 76 46 240 129 144 142 11 91 88 186 137 141 26 113 107 35 41 106 53 99 105 114 199 133 157 126 55 75 253 36 173 41 115 26 32 28 230 183 165 20 105 30 194 127 141 111 30 151 226 79 142 112 129 235 221 17 241 169 186 97 127 173 74 252 194 191 206 146 68 16 94 56 227 206 138 164 189 133 92 64 169 209 150 215 75 138 55 64 140 249 58 247 37 253 81 54 238 165 255 115 27 151 186 122 118 39 249 201 242 218 200 222 24 104 1 246 53 10 54 212 253 175 144 78 234 22 6 171 216 71 ) 
#(151 73 153 196 184 235 49 177 199 195 28 21 197 77 82 170 239 89 205 171 ) 
#(126 238 109 108 46 154 37 73 ) 
#(103 190 228 45 115 38 48 128 2 97 222 255 178 179 178 233 207 36 146 20 44 179 166 242 6 42 229 91 62 27 181 232 94 254 200 93 202 201 204 50 152 157 60 173 54 117 130 113 186 204 105 103 122 200 65 109 253 212 95 161 31 52 51 46 254 25 182 81 24 117 139 245 110 188 20 60 176 132 111 44 69 107 50 229 204 107 180 218 197 141 59 136 26 63 176 196 58 140 74 239 214 56 230 53 138 108 106 245 184 238 215 61 68 147 7 246 215 105 212 171 79 249 87 7 200 221 100 135 26 169 78 71 217 38 248 120 21 222 238 196 6 216 89 181 105 121 43 243 3 178 150 236 45 78 82 132 101 80 8 189 191 43 141 237 43 94 190 162 119 168 249 97 248 160 40 102 163 91 236 80 227 63 15 182 30 3 167 192 187 169 123 219 112 171 19 33 55 213 249 170 182 218 237 130 79 51 90 4 17 155 108 157 67 210 147 108 213 209 238 147 209 156 164 69 ) 
#(65 183 65 72 206 171 142 117 34 187 210 205 174 240 33 182 57 136 189 172 ) 
#(46 225 226 104 155 127 199 5 ) 
#(211 175 215 244 253 130 34 160 118 242 194 50 240 175 20 113 119 221 156 65 162 217 53 203 178 210 200 124 170 64 58 188 55 75 174 154 103 2 212 87 161 116 137 43 105 88 177 93 69 42 35 168 59 194 175 203 235 237 181 114 117 90 203 240 73 64 110 183 136 147 144 160 210 151 141 192 104 186 172 235 151 143 175 202 251 41 142 136 235 64 178 48 1 37 228 52 167 101 189 195 1 185 47 117 68 133 204 84 247 49 91 181 215 27 72 11 154 242 24 48 195 195 247 40 240 183 87 45 46 68 127 58 42 42 234 52 253 115 246 29 76 172 22 218 240 94 237 218 138 155 169 170 92 64 88 51 222 38 221 241 187 200 147 174 228 196 229 107 118 124 238 225 140 15 208 20 244 226 50 159 211 221 36 241 8 62 12 140 145 129 194 225 180 119 7 239 217 214 88 64 56 97 40 177 111 189 170 87 204 218 165 225 13 54 206 123 34 171 172 224 58 161 59 134 123 231 153 147 120 173 155 217 15 30 243 24 212 123 250 128 50 10 166 45 175 56 68 109 13 26 139 48 222 156 29 184 134 143 37 34 6 18 213 204 0 139 252 97 126 176 37 223 71 54 134 51 253 114 94 58 222 102 185 145 159 129 30 30 178 90 20 146 189 162 46 27 173 130 247 217 31 118 244 180 40 8 141 199 44 250 203 1 246 111 91 175 182 141 185 128 202 48 179 45 211 109 175 100 67 250 104 181 40 134 170 146 204 47 104 114 158 148 107 1 147 193 211 72 68 25 113 76 32 139 128 145 167 252 203 125 ) 
#(126 191 141 203 131 48 212 86 68 17 217 23 132 197 14 197 14 216 0 73 ) 
#(92 241 18 93 34 145 51 7 ) 
#(127 194 143 20 38 18 165 191 206 99 71 217 159 181 130 192 138 164 48 238 171 168 239 61 41 91 250 4 214 154 93 87 181 19 229 130 137 102 16 111 203 89 96 236 116 202 194 62 66 71 48 165 148 138 175 189 7 51 11 13 119 67 191 123 25 110 125 59 239 245 31 66 218 209 94 70 240 223 132 176 245 70 218 21 162 26 126 61 180 159 204 162 137 111 171 166 251 175 113 155 147 68 192 14 159 191 79 213 156 14 235 133 250 153 223 237 208 137 197 219 200 109 184 249 147 171 151 87 121 80 56 163 161 25 101 126 196 244 128 23 215 54 212 155 230 26 183 181 88 131 51 232 49 44 238 48 18 155 39 240 162 134 152 141 116 252 46 49 58 140 86 210 174 218 70 202 201 23 15 7 140 105 115 15 76 52 67 5 245 249 157 57 184 169 14 154 112 118 10 231 236 94 11 56 20 58 239 28 134 247 68 37 138 30 192 188 190 214 213 146 163 121 115 68 229 216 182 151 149 166 3 5 43 159 179 152 183 7 231 88 226 172 249 209 207 81 145 0 29 17 232 253 202 174 110 208 34 218 162 181 63 193 134 33 221 178 14 22 239 100 17 44 148 130 98 68 115 221 77 147 57 22 31 150 169 253 3 236 43 19 123 34 187 156 247 165 216 79 236 189 82 149 11 207 ) 
#(38 86 88 205 109 132 249 117 21 179 183 21 128 163 132 27 49 216 72 21 ) 
#(166 184 162 162 208 89 251 143 ) 
#(187 153 230 42 247 73 230 139 157 234 164 106 165 78 57 57 236 249 222 172 73 2 17 116 104 29 33 248 201 197 218 234 242 208 9 234 99 130 103 141 80 58 164 201 63 87 100 176 126 61 146 181 66 119 160 123 57 185 36 31 165 109 187 180 109 91 104 244 128 146 193 249 103 211 177 7 49 238 239 15 120 200 11 118 102 38 14 176 11 111 254 155 146 175 85 228 239 161 191 210 60 241 68 100 121 29 41 146 1 60 11 76 92 20 170 177 199 68 140 222 148 238 170 89 58 83 19 104 76 166 147 118 22 30 42 132 89 246 249 63 28 25 59 42 150 73 219 62 250 240 128 67 123 46 73 181 162 25 100 172 94 196 82 154 73 184 80 57 155 3 91 217 60 3 74 240 199 19 159 58 43 21 242 238 220 192 106 85 111 158 19 14 241 172 159 248 235 223 148 141 14 149 112 112 182 214 159 22 93 90 242 20 30 210 109 126 45 206 219 193 17 188 144 219 250 25 14 132 183 212 71 149 61 103 174 210 169 13 85 46 121 47 111 97 80 83 204 244 84 85 124 81 129 250 204 228 42 237 104 250 210 96 217 184 235 181 99 172 49 188 228 44 5 224 146 243 47 225 255 44 91 143 203 108 38 127 50 2 18 22 40 175 214 135 149 123 131 6 120 28 200 84 254 7 239 21 241 158 19 154 18 53 167 28 10 122 101 178 200 184 107 89 229 88 58 145 240 225 10 161 112 133 200 43 92 173 108 74 145 225 84 250 91 4 126 188 67 159 62 12 213 61 9 94 246 158 202 49 221 47 110 113 4 75 91 255 224 163 ) 
#(176 164 20 247 158 163 8 123 115 16 41 249 61 255 59 97 203 26 189 113 ) 
#(165 205 77 51 131 233 131 89 ) 
#(80 130 136 252 126 206 70 214 87 70 231 30 69 82 170 180 244 193 14 190 10 217 102 207 75 30 36 41 242 12 88 141 242 192 3 62 24 103 185 168 238 5 237 149 107 108 211 195 223 150 222 245 204 44 14 239 1 238 31 46 75 75 250 142 185 222 42 181 85 87 241 37 191 40 26 59 212 104 75 180 ) 
#(87 255 115 214 76 205 117 228 76 248 222 229 45 151 115 28 196 130 93 118 ) 
#(106 143 212 186 32 213 65 254 ) 
#(38 217 64 6 150 20 173 90 22 150 148 94 234 72 137 171 227 28 205 74 91 16 218 75 238 244 198 137 205 101 75 227 77 209 0 134 80 182 98 218 107 190 170 117 23 18 106 48 226 197 200 35 132 45 32 100 6 121 115 49 33 160 179 170 13 255 81 170 167 133 13 115 12 201 120 48 190 39 253 167 232 187 157 30 6 115 8 76 108 242 138 131 118 73 28 219 150 4 253 155 244 110 49 95 130 111 204 116 49 53 232 235 248 8 236 73 143 67 133 203 29 33 196 190 1 60 43 144 207 21 69 77 196 184 15 21 246 229 0 232 10 175 102 255 94 130 189 127 241 195 225 66 41 59 76 24 119 220 33 155 222 99 237 191 136 33 143 225 118 130 62 182 99 167 131 210 140 6 166 85 201 57 142 121 239 9 5 72 242 89 123 91 128 75 160 157 135 80 37 233 234 231 32 0 108 68 161 172 7 176 192 225 14 244 177 242 ) 
#(199 242 218 112 76 94 11 135 230 251 209 177 78 246 182 121 125 30 66 170 ) 
#(23 231 78 128 140 20 180 152 ) 
#(133 217 216 32 32 174 41 9 29 234 27 79 220 54 236 126 78 187 71 109 141 99 85 193 102 52 11 176 85 63 107 244 38 140 221 218 18 135 128 238 73 201 197 152 225 192 44 198 26 36 216 227 151 222 239 73 135 242 139 72 94 85 43 117 82 134 178 210 82 247 244 118 138 255 0 87 51 125 51 80 77 168 50 162 172 220 58 26 151 41 239 132 149 108 73 73 145 243 87 236 236 176 113 13 63 79 172 126 171 230 181 243 157 254 56 88 187 73 7 103 111 241 83 101 178 34 119 60 119 223 40 22 211 89 161 30 188 128 62 212 34 45 214 99 172 72 247 100 142 186 254 73 142 192 162 146 165 108 240 33 5 113 182 64 220 118 24 82 223 144 154 249 224 84 254 120 240 160 230 219 47 184 245 11 122 211 166 2 28 31 149 101 154 22 45 250 133 91 68 186 ) 
#(239 46 21 233 65 110 233 177 220 29 243 119 86 35 67 97 173 130 53 203 ) 
#(150 140 101 90 152 99 83 228 ) 
#(166 221 176 104 160 166 168 62 184 104 120 151 53 245 131 124 41 248 47 152 228 11 174 88 224 186 56 19 32 144 40 94 220 205 29 141 27 175 239 252 48 42 229 193 34 220 211 85 133 102 35 212 49 54 44 154 91 159 184 97 121 191 234 193 198 47 87 103 242 67 7 122 66 221 46 48 15 112 223 203 230 11 125 80 24 47 170 90 149 210 14 141 171 185 102 65 43 212 49 133 227 208 224 131 150 173 208 167 140 41 219 245 180 100 118 232 61 206 199 50 217 34 55 251 171 179 175 33 92 47 174 182 156 40 7 113 39 175 223 65 205 42 173 62 ) 
#(91 112 1 235 152 138 31 227 30 85 144 217 37 49 252 186 163 97 174 45 ) 
#(185 9 116 140 153 4 179 27 ) 
#(221 40 210 157 86 42 95 109 ) 
#(115 182 125 95 231 102 68 119 30 22 103 20 24 7 69 188 184 240 94 92 ) 
#(159 92 134 12 115 215 138 112 ) 
#(7 85 42 244 78 212 250 155 22 213 158 222 110 243 83 2 137 147 178 111 233 162 85 198 233 172 40 31 82 109 173 229 ) 
#(71 183 133 11 205 126 113 141 94 8 184 96 145 165 111 208 48 79 148 98 ) 
#(30 92 77 52 72 40 222 98 ) 
#(179 202 52 225 112 176 16 78 ) 
#(226 44 241 152 150 65 197 34 114 246 27 201 4 185 59 149 254 21 216 59 ) 
)!

_data4
	"Flujo de datos para una coneccion, ejecuta pwd y ejecuta ls -la.
   salida2.txt"

	^#(#(0 0 3 12 10 20 87 16 ) 
#(235 227 94 42 241 36 156 154 191 38 45 115 100 233 0 0 0 126 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 45 101 120 99 104 97 110 103 101 45 115 104 97 50 53 54 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 45 101 120 99 104 97 110 103 101 45 115 104 97 49 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 49 52 45 115 104 97 49 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 49 45 115 104 97 49 0 0 0 15 115 115 104 45 114 115 97 44 115 115 104 45 100 115 115 0 0 0 157 97 101 115 49 50 56 45 99 116 114 44 97 101 115 49 57 50 45 99 116 114 44 97 101 115 50 53 54 45 99 116 114 44 97 114 99 102 111 117 114 50 53 54 44 97 114 99 102 111 117 114 49 50 56 44 97 101 115 49 50 56 45 99 98 99 44 51 100 101 115 45 99 98 99 44 98 108 111 119 102 105 115 104 45 99 98 99 44 99 97 115 116 49 50 56 45 99 98 99 44 97 101 115 49 57 50 45 99 98 99 44 97 101 115 50 53 54 45 99 98 99 44 97 114 99 102 111 117 114 44 114 105 106 110 100 97 101 108 45 99 98 99 64 108 121 115 97 116 111 114 46 108 105 117 46 115 101 0 0 0 157 97 101 115 49 50 56 45 99 116 114 44 97 101 115 49 57 50 45 99 116 114 44 97 101 115 50 53 54 45 99 116 114 44 97 114 99 102 111 117 114 50 53 54 44 97 114 99 102 111 117 114 49 50 56 44 97 101 115 49 50 56 45 99 98 99 44 51 100 101 115 45 99 98 99 44 98 108 111 119 102 105 115 104 45 99 98 99 44 99 97 115 116 49 50 56 45 99 98 99 44 97 101 115 49 57 50 45 99 98 99 44 97 101 115 50 53 54 45 99 98 99 44 97 114 99 102 111 117 114 44 114 105 106 110 100 97 101 108 45 99 98 99 64 108 121 115 97 116 111 114 46 108 105 117 46 115 101 0 0 0 105 104 109 97 99 45 109 100 53 44 104 109 97 99 45 115 104 97 49 44 117 109 97 99 45 54 52 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 115 104 97 49 45 57 54 44 104 109 97 99 45 109 100 53 45 57 54 0 0 0 105 104 109 97 99 45 109 100 53 44 104 109 97 99 45 115 104 97 49 44 117 109 97 99 45 54 52 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 115 104 97 49 45 57 54 44 104 109 97 99 45 109 100 53 45 57 54 0 0 0 21 110 111 110 101 44 122 108 105 98 64 111 112 101 110 115 115 104 46 99 111 109 0 0 0 21 110 111 110 101 44 122 108 105 98 64 111 112 101 110 115 115 104 46 99 111 109 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ) 
#(0 0 2 188 9 31 0 0 ) 
#(1 21 0 0 0 7 115 115 104 45 114 115 97 0 0 0 1 35 0 0 1 1 0 205 30 61 212 42 184 46 116 215 65 206 93 108 3 177 166 115 92 198 9 233 194 248 102 142 15 116 89 51 38 55 207 168 38 30 128 147 159 106 193 181 239 6 209 45 57 198 207 204 135 56 166 231 33 188 217 127 52 165 73 31 129 71 140 107 44 252 48 138 102 92 62 201 142 120 83 144 57 92 247 230 214 26 165 25 231 78 109 55 74 177 93 241 118 237 212 104 61 195 63 91 152 166 114 146 88 232 7 196 133 88 124 249 94 246 163 2 133 224 250 164 71 85 129 44 152 117 43 85 246 105 172 86 89 3 119 197 142 218 40 117 79 172 100 71 12 101 71 161 231 161 70 91 51 173 130 111 71 159 2 18 167 210 215 156 65 7 243 81 111 80 113 255 224 136 94 92 29 80 192 172 197 42 210 73 12 108 87 34 88 23 241 227 58 63 225 159 220 219 186 127 57 229 177 177 152 74 10 172 253 104 229 28 61 105 196 89 248 182 185 86 76 115 247 138 96 200 40 49 74 80 148 73 203 211 179 218 63 107 243 20 248 44 90 111 119 242 83 39 54 180 162 104 157 249 101 0 0 0 129 0 247 203 54 19 153 19 171 180 200 213 81 15 82 47 178 251 173 162 48 158 82 83 94 120 131 15 56 69 90 73 128 248 137 167 168 94 180 23 43 181 247 166 79 24 170 126 79 61 105 161 115 170 24 15 186 20 239 241 84 21 42 122 91 163 138 24 127 31 196 171 25 246 68 1 104 35 51 72 178 176 125 10 98 96 120 29 235 135 200 5 29 128 246 77 118 227 104 90 238 104 223 225 189 10 214 254 31 191 144 212 132 5 19 100 8 190 2 254 240 131 175 165 229 236 196 31 109 138 0 0 1 15 0 0 0 7 115 115 104 45 114 115 97 0 0 1 0 201 128 27 141 123 178 213 47 14 40 161 46 135 211 163 133 235 220 95 43 241 8 114 230 26 71 141 99 137 252 208 113 68 123 120 115 160 45 44 128 194 116 216 186 228 144 194 46 71 153 19 80 107 209 215 36 219 179 176 138 118 98 50 136 34 48 15 14 227 135 38 237 221 8 142 78 76 113 70 15 109 106 4 61 182 189 162 92 240 234 135 217 79 198 141 34 74 162 174 149 192 86 129 3 11 36 128 46 54 236 26 106 157 134 244 4 113 63 149 106 132 70 134 55 121 207 52 134 195 85 166 164 19 62 209 180 228 131 219 18 169 145 123 162 138 171 73 203 85 246 108 229 182 156 29 79 84 5 102 183 26 5 222 7 40 113 116 231 175 94 60 56 24 133 137 135 249 132 167 75 102 212 105 132 227 15 112 93 165 226 248 13 195 117 169 58 208 62 42 204 33 68 142 149 207 100 140 168 226 148 217 179 135 32 0 153 197 12 138 157 218 59 84 17 29 184 144 59 41 86 228 206 176 215 39 195 10 64 201 145 226 188 68 205 137 182 9 166 46 132 226 28 130 86 239 49 0 0 0 0 0 0 0 0 0 ) 
#(0 0 0 12 10 21 0 0 ) 
#(0 0 0 0 0 0 0 0 ) 
#(230 212 254 255 122 252 195 244 ) 
#(112 157 17 242 13 175 117 78 33 103 103 225 41 82 10 141 244 75 21 151 55 202 37 28 ) 
#(11 191 246 187 235 158 55 105 158 43 52 132 108 122 246 58 192 159 83 209 ) 
#(10 149 17 108 24 248 129 95 ) 
#(128 27 160 175 20 14 150 242 ) 
#(11 65 114 13 4 102 202 73 164 21 142 242 39 193 32 136 55 39 137 108 ) 
#(211 83 178 32 183 34 126 163 ) 
#(99 113 156 92 14 175 247 91 42 161 5 197 229 98 235 196 215 254 15 237 64 10 46 12 ) 
#(13 73 233 175 81 243 48 195 52 59 141 189 42 70 254 106 23 68 183 204 ) 
#(101 53 19 201 34 207 203 80 ) 
#(240 164 59 4 23 111 61 198 138 129 165 13 194 118 37 156 ) 
#(252 121 3 18 165 200 187 105 58 70 82 96 155 218 120 190 20 239 38 199 ) 
#(58 36 35 207 209 228 172 168 ) 
#(203 116 44 158 26 94 11 23 ) 
#(219 15 19 24 204 48 142 101 60 106 67 38 126 198 64 141 5 43 197 208 ) 
#(196 22 165 48 46 104 72 108 ) 
#(70 46 86 89 13 118 66 13 191 148 216 214 82 203 42 97 150 166 109 208 31 166 251 140 ) 
#(197 158 241 36 102 240 111 214 208 253 98 134 156 77 83 1 222 22 141 47 ) 
#(139 210 136 228 164 198 49 150 ) 
#(185 38 134 199 17 233 188 130 ) 
#(82 152 169 211 118 108 160 14 160 112 113 17 220 238 123 1 203 12 184 29 ) 
#(233 139 151 88 107 78 240 90 ) 
#(136 179 55 48 254 242 237 85 90 156 113 104 162 174 103 187 183 51 154 223 206 193 210 73 114 69 194 128 41 10 223 210 ) 
#(88 41 71 71 50 245 41 66 92 205 124 125 118 156 199 62 7 15 145 198 ) 
#(66 175 29 134 143 254 33 242 ) 
#(237 143 36 131 137 195 79 239 ) 
#(217 185 107 137 150 168 183 8 172 150 66 47 146 222 87 105 14 230 207 166 ) 
#(113 66 133 154 217 241 69 187 ) 
#(1 73 166 7 23 255 112 98 134 120 27 8 124 231 58 32 185 64 238 98 74 52 217 95 ) 
#(190 79 129 25 207 17 221 160 242 78 37 136 219 114 179 227 211 76 149 58 ) 
#(167 138 40 31 181 83 141 90 ) 
#(187 135 146 10 205 55 67 23 225 5 234 48 87 93 210 226 ) 
#(141 6 97 187 30 203 182 54 83 141 100 212 186 227 32 32 136 167 117 247 ) 
#(199 8 113 23 216 113 97 130 ) 
#(33 92 240 255 83 1 206 190 ) 
#(42 72 151 128 161 61 132 43 90 204 243 189 231 248 255 22 51 103 253 113 ) 
#(71 142 114 106 76 75 216 157 ) 
#(113 11 33 49 209 74 78 28 242 92 136 140 192 38 31 194 22 91 8 220 5 158 38 104 160 67 24 101 238 22 193 174 17 60 144 229 56 132 112 190 38 0 241 18 110 220 239 32 1 93 196 192 20 186 246 253 136 222 245 85 170 156 9 189 115 82 31 227 253 49 81 127 180 251 39 100 162 82 78 4 92 158 130 225 12 102 24 22 ) 
#(249 38 95 171 241 102 94 148 218 139 235 12 89 31 107 66 59 111 4 226 ) 
#(151 46 9 114 70 194 184 150 ) 
#(12 199 212 118 223 109 125 95 191 220 71 33 208 97 51 89 73 196 27 73 164 106 21 79 252 166 168 28 22 218 3 2 74 177 112 188 144 177 170 44 183 206 191 182 76 172 247 246 7 45 71 155 140 114 202 7 203 180 125 160 25 125 171 51 97 69 203 96 47 168 130 138 ) 
#(199 245 131 13 174 244 68 233 69 194 222 10 73 158 139 248 187 93 169 241 ) 
#(96 189 71 20 255 82 238 59 ) 
#(207 19 123 13 98 35 167 39 46 40 172 244 223 237 187 89 223 194 111 48 211 53 54 14 98 88 88 252 82 165 77 210 242 91 203 217 203 108 17 21 162 57 109 139 11 73 27 76 151 26 57 51 139 79 226 214 143 117 170 179 63 240 64 184 200 155 184 171 233 13 177 191 12 178 107 177 213 97 104 12 203 164 216 78 121 20 137 71 191 112 215 106 166 200 50 195 114 142 54 247 6 249 198 180 234 144 21 198 150 137 90 80 35 51 26 18 54 1 183 222 170 56 115 53 98 95 140 254 229 67 111 94 103 217 150 200 25 133 103 152 90 88 77 95 145 183 133 241 179 154 214 165 44 102 112 83 133 146 1 62 53 246 8 61 216 229 119 242 212 253 137 242 19 17 122 32 139 170 211 105 223 82 104 207 156 58 125 3 31 151 126 131 1 152 80 80 249 45 118 4 202 9 63 221 77 5 251 211 ) 
#(50 15 152 221 246 119 206 145 130 17 25 96 11 210 41 206 254 252 249 7 ) 
#(168 101 3 155 244 37 124 232 ) 
#(65 89 23 18 183 33 242 219 62 100 47 214 134 67 169 74 81 241 13 50 201 242 2 21 182 150 237 129 188 66 203 215 137 154 60 203 118 58 93 204 193 115 112 132 5 111 239 246 196 239 72 221 123 126 184 125 219 5 246 254 255 172 144 106 133 113 67 135 66 196 116 37 112 241 154 33 68 143 71 84 150 101 208 191 116 181 232 0 160 248 95 44 247 7 36 20 233 131 249 119 113 8 83 225 243 190 66 120 138 50 17 44 133 155 246 218 171 195 124 130 12 77 192 184 80 86 98 134 34 181 65 49 96 142 4 178 40 105 200 11 140 104 255 241 205 115 247 113 132 126 179 241 168 137 138 17 38 145 86 25 66 150 233 178 114 189 4 85 212 173 59 239 166 84 118 227 59 154 128 197 77 15 101 179 223 91 103 19 223 23 71 21 89 127 125 203 139 74 149 46 71 13 128 170 64 39 88 185 167 6 214 18 249 169 161 100 35 54 74 107 253 40 38 41 ) 
#(84 31 74 242 254 126 184 57 169 69 190 62 121 172 32 75 173 116 201 163 ) 
#(50 137 48 195 5 25 47 61 ) 
#(228 128 223 38 9 193 23 4 61 54 14 0 36 182 113 139 15 199 90 227 154 68 220 121 18 176 43 145 254 187 168 201 84 77 246 255 229 175 170 177 213 144 47 201 123 68 158 61 201 141 131 137 126 95 31 4 161 161 54 29 230 26 180 243 45 163 126 131 125 130 227 170 49 240 59 149 216 48 146 60 2 152 40 252 181 249 243 227 88 124 205 24 101 158 67 244 80 108 238 5 118 103 9 21 0 165 123 178 94 45 93 229 202 12 121 87 71 83 76 139 109 43 7 58 180 193 194 174 157 4 102 177 97 206 194 247 121 66 149 204 190 198 178 39 24 222 198 188 96 162 216 3 99 254 84 250 15 42 21 136 15 42 21 246 67 60 148 192 246 121 245 209 59 127 254 95 22 59 89 202 162 164 226 118 50 194 161 103 139 44 187 115 155 19 28 157 39 216 240 232 124 18 37 69 53 202 101 238 58 179 225 114 134 181 52 14 32 94 57 152 136 172 187 92 101 153 82 141 34 167 86 112 191 136 8 126 244 108 101 111 166 189 114 175 24 164 221 106 229 208 225 62 180 183 225 116 238 235 215 213 176 140 215 181 32 127 238 44 56 138 182 79 132 115 10 129 67 11 109 213 173 128 179 57 31 28 130 250 101 222 147 123 228 157 188 228 6 70 40 110 11 202 178 109 187 61 23 107 83 61 75 63 70 46 167 183 26 130 91 138 51 180 208 253 210 215 231 83 180 89 113 112 68 19 227 139 28 3 32 48 243 209 158 84 52 39 26 54 221 158 232 80 102 115 107 193 1 220 107 63 ) 
#(186 157 68 56 189 233 55 3 77 73 131 59 46 37 44 2 245 117 130 90 ) 
#(48 125 55 149 105 252 30 161 ) 
#(80 90 100 151 163 137 214 101 89 103 217 108 136 160 27 236 62 145 225 26 165 130 47 163 201 91 56 141 100 140 197 96 194 143 23 150 184 187 108 44 2 43 210 88 160 112 78 227 141 255 35 148 47 1 218 211 234 251 158 99 253 3 21 39 87 33 49 22 164 180 60 101 173 137 75 204 253 187 224 142 150 230 186 83 3 222 206 104 251 8 215 32 12 194 204 187 14 225 192 61 120 186 148 19 55 107 132 102 251 34 87 57 58 33 187 168 17 16 42 163 193 123 36 42 252 53 22 145 117 15 185 248 59 28 83 178 162 215 193 6 37 28 168 51 160 90 32 229 41 29 212 78 13 104 92 236 143 217 60 79 170 63 100 255 166 239 242 23 220 247 104 16 169 210 211 81 207 139 81 107 150 230 243 4 211 240 106 195 130 187 146 248 175 180 28 197 237 158 35 242 249 177 189 184 63 139 31 235 106 44 189 239 84 204 66 27 196 14 243 117 146 5 218 18 21 217 233 218 196 117 232 132 60 49 211 234 24 231 217 151 123 228 108 174 32 18 17 216 86 113 121 245 162 138 179 35 211 73 130 196 39 147 214 233 55 97 106 246 35 247 140 52 104 11 8 72 27 249 228 37 42 171 204 131 191 184 97 8 191 126 138 78 53 146 99 79 34 161 252 213 178 197 12 174 215 100 49 45 89 0 20 55 1 234 32 47 158 221 217 48 47 3 240 120 2 47 93 210 137 56 196 183 60 149 157 181 36 213 108 21 227 113 154 75 104 84 197 104 174 184 202 71 115 182 41 253 5 219 75 193 160 36 101 161 58 169 172 236 252 73 227 97 181 139 178 27 202 237 70 150 225 93 146 251 ) 
#(52 41 26 193 87 254 173 75 8 161 157 218 158 138 9 244 78 115 183 0 ) 
#(201 29 42 169 147 172 21 155 ) 
#(217 182 156 15 228 236 140 153 241 21 65 213 136 210 138 35 61 206 33 161 104 74 7 58 8 128 154 41 219 52 147 210 55 82 124 4 168 138 33 184 75 3 241 243 144 58 78 34 140 33 209 150 11 156 229 237 107 7 70 202 238 88 96 29 35 38 151 212 90 255 20 38 65 2 214 135 85 105 73 222 77 119 74 74 169 123 188 199 172 222 116 157 73 110 4 220 232 192 98 174 113 219 23 28 29 237 52 132 204 158 14 68 193 130 90 111 19 154 157 13 106 190 233 226 41 179 92 111 184 176 235 205 242 187 187 236 10 217 62 174 57 178 111 46 14 144 178 111 127 73 120 201 94 71 196 177 177 103 244 25 175 79 95 252 26 164 94 174 90 75 160 66 86 243 233 91 199 73 130 35 57 65 82 16 35 231 72 63 180 127 27 88 85 148 168 146 71 172 165 105 203 157 31 15 167 183 38 68 185 35 6 93 60 138 58 60 102 33 124 15 103 67 255 120 75 164 108 121 23 91 185 151 114 176 166 170 97 196 245 71 133 234 74 50 4 201 6 237 157 23 236 82 7 155 213 52 219 76 84 42 89 28 129 64 46 246 46 206 216 74 136 109 25 206 219 83 167 54 235 152 30 206 11 12 249 165 201 123 31 59 30 194 122 65 232 5 229 21 214 29 201 108 126 239 130 66 215 117 242 241 198 21 51 231 163 56 49 216 202 27 112 152 90 46 189 129 3 235 30 176 160 23 141 45 16 180 15 129 223 8 171 116 198 140 61 48 215 228 24 168 172 83 41 154 146 95 145 168 23 215 ) 
#(212 95 5 210 140 240 180 119 64 108 30 43 51 40 255 98 119 242 199 15 ) 
#(220 224 250 125 99 40 100 151 ) 
#(40 199 196 146 132 89 71 113 191 147 7 115 188 74 67 208 186 195 26 210 233 221 116 94 181 114 251 2 33 3 178 147 108 106 32 210 115 81 83 2 30 28 220 144 101 162 21 235 244 23 29 53 134 170 90 251 190 135 251 89 14 146 118 207 78 230 115 69 83 240 196 152 124 145 224 69 158 214 172 27 4 181 31 35 182 203 58 201 148 13 12 131 79 59 89 210 127 75 20 19 101 179 213 83 238 162 104 93 197 239 47 90 238 121 171 142 216 228 54 66 232 83 121 35 113 49 32 42 253 24 72 85 130 41 102 96 144 43 123 66 202 236 89 174 160 69 194 186 61 174 104 42 23 91 113 114 13 188 227 229 85 162 108 30 254 131 150 160 9 4 212 145 79 215 102 108 239 166 18 204 222 237 189 127 243 105 198 249 152 135 224 9 161 43 37 170 182 102 60 247 216 221 46 131 189 244 67 229 78 248 81 183 169 194 190 44 ) 
#(128 59 89 154 136 162 227 131 166 170 145 214 248 223 123 33 71 181 35 199 ) 
#(203 59 18 114 66 104 2 197 ) 
#(159 231 169 201 100 176 47 71 204 145 247 141 147 128 135 61 190 112 5 136 207 161 139 162 209 251 67 172 28 229 87 84 157 5 31 79 88 220 55 55 33 169 135 169 125 93 131 161 166 96 137 59 78 149 200 168 2 227 91 193 183 214 75 93 115 156 28 95 25 77 204 236 137 58 227 73 63 203 67 115 185 223 187 60 37 104 82 52 236 167 229 168 124 133 32 53 155 234 118 74 229 183 199 28 145 249 109 209 109 212 87 241 17 3 98 138 191 180 211 59 227 157 75 22 36 175 203 60 171 122 79 254 34 157 101 88 164 2 139 86 226 66 38 105 234 239 30 209 65 253 240 249 249 204 14 90 164 37 3 14 201 15 55 41 43 28 247 162 81 128 101 237 152 48 175 214 102 12 124 136 192 47 202 215 251 148 74 67 149 128 197 233 121 44 58 30 75 134 229 5 ) 
#(19 155 112 100 80 246 5 215 41 188 45 100 30 32 52 9 5 184 167 238 ) 
#(128 85 119 89 48 214 69 189 ) 
#(98 248 248 216 155 105 120 53 96 63 146 237 237 207 254 206 60 242 106 33 91 104 3 86 243 72 99 156 114 101 104 190 47 255 198 252 147 194 35 30 177 179 199 35 189 146 148 197 62 47 157 234 38 187 191 145 214 250 91 232 221 33 49 203 130 155 101 160 174 126 26 82 230 46 112 112 190 105 242 58 236 182 14 60 29 222 140 100 229 138 251 171 68 179 249 73 5 134 46 129 36 55 74 77 242 182 52 73 60 194 83 126 83 94 171 73 160 137 43 232 6 44 230 160 0 82 47 177 226 137 37 169 146 36 14 148 114 29 77 155 82 163 136 199 ) 
#(224 243 219 152 120 150 59 180 124 227 185 218 242 93 222 73 165 89 255 71 ) 
#(196 42 145 81 134 62 183 68 ) 
#(46 195 149 182 218 152 109 241 ) 
#(253 178 110 167 239 210 161 250 20 163 136 60 248 202 192 173 117 113 181 93 ) 
#(152 68 196 27 163 56 197 40 ) 
#(119 57 245 226 82 110 219 98 246 242 245 179 130 172 244 55 221 92 177 21 11 97 154 178 206 148 170 109 184 154 118 11 ) 
#(229 224 82 85 137 101 207 120 188 190 24 235 101 112 68 135 255 221 229 173 ) 
#(39 33 136 34 156 136 178 122 ) 
#(206 247 122 52 183 204 115 163 ) 
#(86 223 20 187 224 242 181 144 252 185 185 97 146 231 35 161 165 135 25 148 ) 
)!

_data5
	"Flujo de datos para una coneccion, ejecuta pwd y ejecuta ls -la.
   salida3.txt"

	^#(#(0 0 3 12 10 20 65 121 ) 
#(114 80 26 236 246 218 158 70 99 130 187 76 158 66 0 0 0 126 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 45 101 120 99 104 97 110 103 101 45 115 104 97 50 53 54 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 45 101 120 99 104 97 110 103 101 45 115 104 97 49 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 49 52 45 115 104 97 49 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 49 45 115 104 97 49 0 0 0 15 115 115 104 45 114 115 97 44 115 115 104 45 100 115 115 0 0 0 157 97 101 115 49 50 56 45 99 116 114 44 97 101 115 49 57 50 45 99 116 114 44 97 101 115 50 53 54 45 99 116 114 44 97 114 99 102 111 117 114 50 53 54 44 97 114 99 102 111 117 114 49 50 56 44 97 101 115 49 50 56 45 99 98 99 44 51 100 101 115 45 99 98 99 44 98 108 111 119 102 105 115 104 45 99 98 99 44 99 97 115 116 49 50 56 45 99 98 99 44 97 101 115 49 57 50 45 99 98 99 44 97 101 115 50 53 54 45 99 98 99 44 97 114 99 102 111 117 114 44 114 105 106 110 100 97 101 108 45 99 98 99 64 108 121 115 97 116 111 114 46 108 105 117 46 115 101 0 0 0 157 97 101 115 49 50 56 45 99 116 114 44 97 101 115 49 57 50 45 99 116 114 44 97 101 115 50 53 54 45 99 116 114 44 97 114 99 102 111 117 114 50 53 54 44 97 114 99 102 111 117 114 49 50 56 44 97 101 115 49 50 56 45 99 98 99 44 51 100 101 115 45 99 98 99 44 98 108 111 119 102 105 115 104 45 99 98 99 44 99 97 115 116 49 50 56 45 99 98 99 44 97 101 115 49 57 50 45 99 98 99 44 97 101 115 50 53 54 45 99 98 99 44 97 114 99 102 111 117 114 44 114 105 106 110 100 97 101 108 45 99 98 99 64 108 121 115 97 116 111 114 46 108 105 117 46 115 101 0 0 0 105 104 109 97 99 45 109 100 53 44 104 109 97 99 45 115 104 97 49 44 117 109 97 99 45 54 52 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 115 104 97 49 45 57 54 44 104 109 97 99 45 109 100 53 45 57 54 0 0 0 105 104 109 97 99 45 109 100 53 44 104 109 97 99 45 115 104 97 49 44 117 109 97 99 45 54 52 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 115 104 97 49 45 57 54 44 104 109 97 99 45 109 100 53 45 57 54 0 0 0 21 110 111 110 101 44 122 108 105 98 64 111 112 101 110 115 115 104 46 99 111 109 0 0 0 21 110 111 110 101 44 122 108 105 98 64 111 112 101 110 115 115 104 46 99 111 109 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ) 
#(0 0 2 188 10 31 0 0 ) 
#(1 21 0 0 0 7 115 115 104 45 114 115 97 0 0 0 1 35 0 0 1 1 0 205 30 61 212 42 184 46 116 215 65 206 93 108 3 177 166 115 92 198 9 233 194 248 102 142 15 116 89 51 38 55 207 168 38 30 128 147 159 106 193 181 239 6 209 45 57 198 207 204 135 56 166 231 33 188 217 127 52 165 73 31 129 71 140 107 44 252 48 138 102 92 62 201 142 120 83 144 57 92 247 230 214 26 165 25 231 78 109 55 74 177 93 241 118 237 212 104 61 195 63 91 152 166 114 146 88 232 7 196 133 88 124 249 94 246 163 2 133 224 250 164 71 85 129 44 152 117 43 85 246 105 172 86 89 3 119 197 142 218 40 117 79 172 100 71 12 101 71 161 231 161 70 91 51 173 130 111 71 159 2 18 167 210 215 156 65 7 243 81 111 80 113 255 224 136 94 92 29 80 192 172 197 42 210 73 12 108 87 34 88 23 241 227 58 63 225 159 220 219 186 127 57 229 177 177 152 74 10 172 253 104 229 28 61 105 196 89 248 182 185 86 76 115 247 138 96 200 40 49 74 80 148 73 203 211 179 218 63 107 243 20 248 44 90 111 119 242 83 39 54 180 162 104 157 249 101 0 0 0 128 31 49 54 129 212 218 106 66 181 60 205 5 201 133 62 25 102 164 157 194 153 60 93 91 183 46 168 222 227 102 137 2 213 200 127 209 36 235 62 156 172 204 216 75 216 56 183 150 219 48 233 116 46 129 107 241 53 56 255 72 118 41 51 244 123 128 237 133 231 40 167 42 1 169 184 127 138 142 171 161 240 52 40 83 71 178 249 16 189 226 19 108 33 210 239 44 214 4 165 157 151 73 81 227 79 127 106 22 85 124 10 123 190 21 115 112 144 83 241 49 205 171 103 135 215 232 166 76 0 0 1 15 0 0 0 7 115 115 104 45 114 115 97 0 0 1 0 51 57 210 200 67 51 188 111 48 40 90 111 5 99 228 177 230 43 158 17 35 115 11 94 92 47 165 152 242 134 10 138 6 100 155 122 75 239 165 41 124 213 125 151 155 35 43 243 54 192 93 72 91 108 40 191 213 169 11 219 61 70 222 32 23 24 67 201 97 90 11 121 244 90 65 153 136 202 238 4 41 85 233 233 253 113 55 30 66 110 252 196 112 219 176 52 237 11 48 191 61 103 115 162 13 245 238 46 114 57 26 240 244 204 167 173 221 39 181 245 100 22 182 54 238 31 247 121 96 126 9 123 127 125 174 150 173 59 183 218 217 99 250 225 238 169 91 61 125 16 79 151 160 221 254 65 146 230 60 141 24 42 121 161 201 4 49 199 206 1 239 230 255 241 249 231 97 120 192 88 27 144 19 206 189 41 255 40 130 45 196 239 228 168 10 204 236 12 171 154 14 216 138 85 197 127 186 121 86 153 29 120 87 141 211 163 206 132 140 245 106 243 237 233 155 105 19 251 136 102 71 105 74 241 35 43 147 119 173 236 202 135 77 68 54 70 10 139 200 163 99 155 108 47 255 139 0 0 0 0 0 0 0 0 0 0 ) 
#(0 0 0 12 10 21 0 0 ) 
#(0 0 0 0 0 0 0 0 ) 
#(185 192 161 34 60 34 153 211 ) 
#(216 45 114 175 111 220 168 221 156 196 191 178 175 90 48 93 45 76 46 192 243 157 111 31 ) 
#(238 251 77 109 102 86 241 129 205 102 167 53 109 206 68 231 80 162 8 105 ) 
#(45 237 98 166 70 33 54 129 ) 
#(4 39 209 104 140 160 127 155 ) 
#(50 101 22 81 27 169 15 208 110 225 243 150 34 217 158 74 247 16 216 193 ) 
#(232 197 214 30 13 66 221 220 ) 
#(159 93 193 76 8 8 75 148 245 93 198 14 172 107 117 230 175 88 172 9 18 8 254 151 ) 
#(57 157 242 153 172 214 233 174 105 20 129 164 28 201 250 242 119 209 107 158 ) 
#(210 75 214 48 187 165 195 15 ) 
#(209 21 55 220 36 39 222 84 172 201 68 250 248 125 123 121 ) 
#(158 25 124 43 63 2 147 26 69 212 173 62 137 89 40 117 56 222 186 61 ) 
#(56 195 10 157 243 146 38 137 ) 
#(223 184 142 15 18 114 118 28 ) 
#(40 222 230 17 45 137 193 60 167 243 125 41 174 39 38 206 250 73 164 135 ) 
#(10 105 166 253 81 165 254 151 ) 
#(182 163 29 150 66 90 190 200 102 204 39 166 91 32 201 17 15 185 160 217 45 246 201 240 ) 
#(97 70 82 94 117 205 190 233 190 14 159 253 129 40 28 189 195 236 162 145 ) 
#(26 181 79 169 39 1 77 167 ) 
#(35 152 41 137 135 236 28 48 ) 
#(16 238 24 50 64 180 222 134 75 222 230 189 204 70 43 246 81 190 162 67 ) 
#(91 71 116 7 30 13 173 172 ) 
#(10 140 240 183 245 70 219 81 187 108 97 176 170 209 21 123 77 15 163 190 139 57 51 97 45 212 92 212 98 84 74 189 ) 
#(180 31 84 23 164 82 68 247 209 44 186 249 69 29 184 152 99 174 240 102 ) 
#(169 61 215 28 241 243 8 21 ) 
#(238 155 94 144 233 222 105 227 ) 
#(109 125 219 40 212 154 224 201 10 205 39 164 148 255 255 171 118 154 92 199 ) 
#(190 177 194 233 247 86 225 75 ) 
#(180 203 157 159 14 144 161 206 151 175 52 118 6 180 84 22 202 170 45 25 117 238 138 52 ) 
#(216 112 97 222 54 31 185 159 255 17 187 129 230 251 70 14 12 36 47 32 ) 
#(35 203 33 118 200 168 96 120 ) 
#(140 137 220 174 188 83 25 115 42 221 213 61 78 54 207 212 ) 
#(17 182 252 170 125 180 190 172 188 227 11 82 45 17 51 69 17 211 215 136 ) 
#(29 213 247 59 189 217 20 77 ) 
#(5 78 238 232 247 152 169 209 ) 
#(255 26 22 70 178 68 181 74 98 110 175 188 146 87 37 252 238 188 80 101 ) 
#(230 119 141 63 51 187 178 165 ) 
#(172 76 72 137 36 194 187 114 71 142 189 240 14 155 102 82 50 119 22 244 47 15 164 103 104 0 150 103 250 170 89 161 92 9 108 213 226 253 77 122 72 16 4 128 173 147 226 107 168 188 22 63 224 120 36 126 237 183 66 46 147 58 216 30 16 243 90 183 169 108 168 113 249 158 203 57 231 138 205 233 44 180 24 0 58 228 216 135 ) 
#(237 11 141 246 134 209 99 7 90 252 110 233 255 31 205 40 171 74 190 254 ) 
#(167 190 214 25 194 168 171 25 ) 
#(116 97 118 62 20 71 129 93 26 192 182 51 194 150 157 236 155 82 149 237 230 251 25 214 127 145 55 229 230 160 218 232 141 251 111 113 202 169 12 245 93 205 249 238 87 28 192 97 21 81 127 96 161 242 52 160 109 79 134 85 32 68 138 120 78 160 67 243 223 213 88 123 ) 
#(83 22 101 16 179 246 66 121 207 201 53 218 59 13 107 69 51 164 149 246 ) 
#(46 177 220 131 32 147 21 244 ) 
#(26 87 89 245 244 2 147 181 75 199 104 99 171 13 232 158 137 48 189 124 239 251 147 22 58 44 33 87 79 114 1 248 66 16 16 87 68 205 187 105 45 115 4 106 211 102 192 123 141 211 78 176 128 174 199 101 23 139 60 22 169 167 88 26 98 27 226 92 245 204 235 177 171 184 228 80 61 21 198 75 5 211 208 18 162 85 49 45 53 210 36 41 169 41 108 35 58 129 45 245 4 0 7 245 2 85 176 115 60 173 48 139 159 30 239 67 166 147 154 50 114 223 187 101 207 173 100 230 173 92 113 38 170 252 250 233 94 16 127 172 116 197 2 249 124 179 136 5 191 2 106 37 162 15 208 57 103 162 48 225 166 175 115 250 233 132 6 1 35 170 134 237 182 216 149 102 42 12 202 185 221 112 219 147 59 8 114 80 119 214 50 247 128 168 215 124 212 251 243 93 51 136 10 128 167 89 219 191 ) 
#(21 150 223 155 106 73 238 29 196 130 179 3 101 101 55 199 41 137 135 45 ) 
#(39 20 19 53 247 214 150 124 ) 
#(45 63 195 49 97 244 48 136 187 79 63 213 60 240 219 58 114 239 255 186 221 199 81 220 43 246 95 246 52 190 43 134 191 168 109 220 192 208 92 56 50 217 24 10 217 112 112 187 145 104 174 12 100 179 96 44 141 111 78 212 111 92 107 99 125 30 17 26 109 205 40 11 199 92 193 88 41 37 142 150 229 158 233 237 166 241 81 108 152 219 207 60 124 179 208 239 43 173 57 63 249 210 201 51 157 217 249 229 203 35 224 227 83 117 81 95 208 49 49 246 27 162 55 201 246 96 168 128 250 184 172 122 117 20 196 89 251 33 10 23 7 254 97 207 52 88 30 83 186 172 220 97 67 129 142 153 181 20 17 52 31 127 121 131 4 248 128 223 156 123 44 94 65 28 63 187 50 164 29 171 158 231 160 217 29 169 223 154 75 111 31 25 197 230 90 45 65 245 84 148 220 168 85 212 142 146 116 72 238 199 45 116 252 102 60 78 41 9 205 94 98 34 226 120 ) 
#(149 80 123 107 225 123 227 3 15 45 32 206 1 154 175 200 253 210 93 103 ) 
#(112 218 205 248 227 115 62 189 ) 
#(60 42 172 200 68 200 248 91 80 154 162 62 131 255 87 191 93 243 121 88 8 51 13 139 91 48 72 76 168 197 90 162 190 250 48 188 248 201 255 14 129 14 28 26 183 95 83 241 91 176 29 170 218 6 16 12 129 234 248 229 11 240 177 51 176 202 137 45 88 193 171 7 92 219 123 72 254 170 193 200 188 193 109 164 67 180 115 144 142 200 177 53 43 53 121 154 191 20 136 158 33 50 108 49 227 218 243 40 35 216 70 168 122 161 153 85 60 108 247 153 242 153 229 168 152 95 215 195 45 42 247 154 120 242 5 45 104 29 191 164 55 161 183 70 142 19 222 49 21 173 116 199 215 162 28 122 31 146 151 201 20 66 51 108 210 208 190 3 249 35 100 99 119 72 246 105 62 70 174 25 162 73 42 170 95 179 55 103 138 88 229 179 149 65 236 80 196 126 34 14 48 234 225 10 18 164 136 72 47 240 117 51 26 142 4 137 179 245 201 161 187 184 128 44 214 193 19 79 254 58 229 223 6 18 89 207 188 246 151 197 17 250 170 13 73 135 160 250 2 152 183 50 32 70 51 248 177 227 235 124 142 250 23 199 202 65 235 221 246 224 197 92 45 142 24 162 100 68 201 220 92 63 208 228 128 86 74 233 241 63 223 121 214 87 244 217 206 221 201 55 249 181 152 73 39 150 42 250 50 255 127 22 122 36 96 23 15 174 60 96 146 100 229 106 158 18 224 164 85 208 4 26 86 41 230 226 81 235 94 111 181 105 132 107 46 150 104 126 210 217 108 255 233 155 96 153 103 255 240 136 ) 
#(156 5 101 31 194 158 131 31 124 208 106 20 30 221 47 71 255 235 51 39 ) 
#(157 151 8 208 4 130 142 43 ) 
#(109 112 97 35 176 206 107 61 82 197 206 140 81 149 183 156 209 38 42 158 115 44 66 31 173 29 37 28 253 41 172 216 116 118 149 90 94 137 114 200 190 24 239 200 197 123 248 10 24 172 108 72 45 54 168 159 107 156 202 197 163 24 82 66 244 119 217 189 221 196 96 203 9 65 179 105 188 4 91 254 65 182 128 161 119 144 57 26 174 176 140 119 245 104 135 222 18 253 100 183 0 0 251 12 218 236 194 22 181 23 36 243 143 218 20 103 47 58 93 57 54 0 189 191 115 24 157 213 17 3 84 161 57 68 131 248 179 10 130 43 120 41 202 251 188 133 153 115 217 210 183 181 145 159 16 180 146 178 98 146 184 116 165 157 122 29 12 58 117 248 54 69 25 191 76 126 239 185 168 239 166 85 160 42 0 245 192 19 96 235 12 157 160 129 169 153 55 220 216 21 17 8 183 54 114 254 122 77 110 121 33 195 75 115 211 103 160 245 21 104 79 25 184 201 174 100 168 83 145 118 157 61 116 163 88 217 73 56 50 13 134 12 36 223 154 228 20 220 125 39 114 132 28 183 13 10 61 61 124 53 178 251 64 201 252 155 134 200 206 120 152 147 131 60 7 77 191 24 228 235 34 139 27 115 143 119 194 97 227 139 60 213 183 108 161 110 158 251 108 85 130 179 64 22 ) 
#(36 121 197 171 18 18 12 189 196 219 70 184 103 171 247 211 17 252 218 47 ) 
#(139 112 182 85 29 162 101 166 ) 
#(87 183 175 50 79 206 216 115 30 248 31 176 184 201 250 137 210 182 174 235 152 71 220 153 117 161 196 218 84 83 151 166 78 145 174 193 67 90 11 191 125 120 22 143 9 73 74 69 6 61 202 90 198 237 27 32 109 100 248 236 216 174 53 11 148 55 89 224 186 121 79 41 113 207 220 255 23 59 12 216 156 5 17 169 109 76 198 53 150 191 223 66 37 210 206 20 91 21 245 251 128 140 227 135 43 161 110 4 30 117 58 212 230 212 169 61 121 56 9 180 5 214 140 30 157 138 9 26 178 89 14 100 251 181 0 96 117 145 156 89 79 29 221 198 9 205 192 183 80 140 172 125 93 81 79 45 170 91 20 244 209 27 118 211 231 55 242 173 7 76 111 151 178 25 197 167 226 216 249 234 168 24 219 65 88 12 175 181 68 149 99 162 167 7 7 46 64 69 200 62 109 179 53 28 21 184 92 48 115 184 89 26 6 114 67 127 1 17 117 164 25 177 102 139 109 195 237 130 217 45 228 62 19 30 116 34 64 83 191 167 125 131 221 42 65 55 35 210 109 154 19 70 123 121 54 90 187 100 169 108 204 23 25 230 152 18 100 62 75 95 200 149 56 171 159 146 78 98 65 82 222 130 245 59 202 194 225 120 88 229 133 11 214 150 9 146 224 197 47 196 156 131 29 42 141 19 59 146 240 226 122 150 126 248 106 76 214 94 128 34 117 189 63 94 55 115 244 22 46 199 74 75 239 191 72 236 186 90 13 204 190 110 185 148 144 211 84 183 80 164 133 192 72 34 0 46 123 177 108 214 172 119 219 185 50 111 150 37 ) 
#(210 62 53 49 236 231 253 77 79 123 103 172 19 164 238 186 107 116 233 102 ) 
#(137 225 101 191 134 72 131 122 ) 
#(8 167 175 253 207 35 180 195 8 33 120 130 71 51 30 100 38 236 18 67 55 115 19 117 100 26 79 22 64 12 96 208 177 147 10 167 162 118 187 7 124 124 119 5 193 171 126 246 124 52 249 222 198 190 16 66 158 52 193 234 183 25 204 79 213 245 157 254 34 23 245 74 225 196 139 15 100 60 196 251 ) 
#(105 212 238 129 102 95 10 179 161 160 52 97 178 77 122 143 168 209 156 0 ) 
#(128 49 67 90 69 131 94 218 ) 
#(17 98 239 67 246 250 247 247 239 216 1 216 142 220 41 82 72 137 74 78 175 31 255 78 85 132 60 137 166 101 242 26 130 239 158 112 104 178 69 173 219 213 151 55 241 166 183 109 70 133 164 132 71 49 42 86 119 150 25 236 37 22 160 91 215 138 65 222 84 215 168 200 120 83 120 24 176 170 155 109 78 139 182 110 92 159 4 66 15 180 9 114 21 133 3 5 28 128 28 198 55 0 239 38 238 39 93 139 87 68 99 104 102 229 108 64 211 138 174 192 55 29 106 230 102 125 141 151 57 200 44 34 148 163 111 172 46 207 21 108 175 107 255 18 209 229 234 103 155 77 190 250 31 19 65 143 47 14 199 66 154 149 249 177 164 220 235 139 35 245 131 46 251 246 152 45 198 213 132 189 63 180 157 247 146 174 103 242 164 131 121 77 254 183 175 115 33 211 20 233 185 163 97 124 40 30 64 219 187 63 68 112 73 87 74 3 ) 
#(236 118 125 54 223 187 30 163 97 154 185 178 74 118 94 72 241 25 92 239 ) 
#(243 219 111 206 89 164 174 59 ) 
#(226 245 183 225 101 196 25 239 212 99 18 231 143 133 81 17 224 149 1 233 50 62 228 177 220 21 17 121 162 47 85 0 83 34 135 78 179 94 107 72 146 68 58 198 77 213 249 152 186 253 219 206 143 56 85 82 14 18 254 160 69 113 93 188 250 159 201 153 41 184 121 253 4 41 96 130 98 117 231 236 6 9 116 10 217 163 151 1 221 132 234 158 243 156 87 206 221 95 143 250 138 166 56 129 30 227 204 148 194 100 180 215 63 204 8 152 80 218 33 187 33 207 186 231 141 192 105 68 157 180 115 75 145 220 56 70 195 129 73 68 255 32 85 182 54 121 86 191 230 18 155 29 203 15 115 190 61 20 138 121 171 123 45 118 31 210 202 25 224 228 253 152 47 26 91 239 141 127 201 166 79 34 97 139 97 137 221 173 22 77 94 143 121 0 116 92 38 19 183 76 ) 
#(103 104 11 194 34 81 216 11 210 255 60 27 184 9 213 58 11 139 49 84 ) 
#(255 64 30 254 58 56 244 13 ) 
#(93 23 208 10 137 134 227 244 141 145 138 109 116 27 188 197 192 5 254 36 176 253 184 182 114 207 189 139 43 95 93 118 99 103 17 1 193 135 212 20 119 31 194 112 238 244 244 24 153 151 211 146 4 171 209 18 83 66 221 227 206 226 178 68 196 27 93 171 27 4 147 179 255 68 222 196 127 129 253 94 87 68 71 81 120 233 142 56 133 69 100 169 167 202 185 98 121 180 144 72 165 19 130 6 47 106 170 22 15 68 49 233 179 0 92 24 236 176 21 83 243 53 235 114 84 226 202 24 167 212 151 231 126 232 232 244 24 139 180 114 30 100 19 41 ) 
#(16 74 239 164 190 140 180 151 199 130 219 15 127 153 171 227 32 79 134 96 ) 
#(6 254 136 47 80 192 215 4 ) 
#(228 223 182 140 28 222 189 12 ) 
#(159 137 247 37 10 7 88 167 157 166 101 56 63 79 98 133 235 153 249 31 ) 
#(42 195 194 243 61 96 71 204 ) 
#(91 20 122 165 65 40 137 44 166 95 44 90 19 168 97 153 149 178 215 106 246 230 17 148 123 191 26 195 242 228 43 2 ) 
#(119 202 207 255 107 35 143 17 86 6 136 250 236 229 181 84 209 12 97 163 ) 
#(76 1 12 193 91 105 249 54 ) 
#(93 193 49 124 40 22 147 116 ) 
#(18 177 57 53 181 57 247 154 138 13 109 184 109 50 139 231 27 99 87 86 ) 
)!

_data6
	"Flujo de datos para una coneccion, ejecuta pwd y ejecuta ls -la.
   salida4.txt"

	^#(#(0 0 3 12 10 20 194 90 ) 
#(35 19 16 66 145 11 100 160 13 49 192 160 177 148 0 0 0 126 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 45 101 120 99 104 97 110 103 101 45 115 104 97 50 53 54 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 45 101 120 99 104 97 110 103 101 45 115 104 97 49 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 49 52 45 115 104 97 49 44 100 105 102 102 105 101 45 104 101 108 108 109 97 110 45 103 114 111 117 112 49 45 115 104 97 49 0 0 0 15 115 115 104 45 114 115 97 44 115 115 104 45 100 115 115 0 0 0 157 97 101 115 49 50 56 45 99 116 114 44 97 101 115 49 57 50 45 99 116 114 44 97 101 115 50 53 54 45 99 116 114 44 97 114 99 102 111 117 114 50 53 54 44 97 114 99 102 111 117 114 49 50 56 44 97 101 115 49 50 56 45 99 98 99 44 51 100 101 115 45 99 98 99 44 98 108 111 119 102 105 115 104 45 99 98 99 44 99 97 115 116 49 50 56 45 99 98 99 44 97 101 115 49 57 50 45 99 98 99 44 97 101 115 50 53 54 45 99 98 99 44 97 114 99 102 111 117 114 44 114 105 106 110 100 97 101 108 45 99 98 99 64 108 121 115 97 116 111 114 46 108 105 117 46 115 101 0 0 0 157 97 101 115 49 50 56 45 99 116 114 44 97 101 115 49 57 50 45 99 116 114 44 97 101 115 50 53 54 45 99 116 114 44 97 114 99 102 111 117 114 50 53 54 44 97 114 99 102 111 117 114 49 50 56 44 97 101 115 49 50 56 45 99 98 99 44 51 100 101 115 45 99 98 99 44 98 108 111 119 102 105 115 104 45 99 98 99 44 99 97 115 116 49 50 56 45 99 98 99 44 97 101 115 49 57 50 45 99 98 99 44 97 101 115 50 53 54 45 99 98 99 44 97 114 99 102 111 117 114 44 114 105 106 110 100 97 101 108 45 99 98 99 64 108 121 115 97 116 111 114 46 108 105 117 46 115 101 0 0 0 105 104 109 97 99 45 109 100 53 44 104 109 97 99 45 115 104 97 49 44 117 109 97 99 45 54 52 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 115 104 97 49 45 57 54 44 104 109 97 99 45 109 100 53 45 57 54 0 0 0 105 104 109 97 99 45 109 100 53 44 104 109 97 99 45 115 104 97 49 44 117 109 97 99 45 54 52 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 44 104 109 97 99 45 114 105 112 101 109 100 49 54 48 64 111 112 101 110 115 115 104 46 99 111 109 44 104 109 97 99 45 115 104 97 49 45 57 54 44 104 109 97 99 45 109 100 53 45 57 54 0 0 0 21 110 111 110 101 44 122 108 105 98 64 111 112 101 110 115 115 104 46 99 111 109 0 0 0 21 110 111 110 101 44 122 108 105 98 64 111 112 101 110 115 115 104 46 99 111 109 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ) 
#(0 0 2 188 10 31 0 0 ) 
#(1 21 0 0 0 7 115 115 104 45 114 115 97 0 0 0 1 35 0 0 1 1 0 205 30 61 212 42 184 46 116 215 65 206 93 108 3 177 166 115 92 198 9 233 194 248 102 142 15 116 89 51 38 55 207 168 38 30 128 147 159 106 193 181 239 6 209 45 57 198 207 204 135 56 166 231 33 188 217 127 52 165 73 31 129 71 140 107 44 252 48 138 102 92 62 201 142 120 83 144 57 92 247 230 214 26 165 25 231 78 109 55 74 177 93 241 118 237 212 104 61 195 63 91 152 166 114 146 88 232 7 196 133 88 124 249 94 246 163 2 133 224 250 164 71 85 129 44 152 117 43 85 246 105 172 86 89 3 119 197 142 218 40 117 79 172 100 71 12 101 71 161 231 161 70 91 51 173 130 111 71 159 2 18 167 210 215 156 65 7 243 81 111 80 113 255 224 136 94 92 29 80 192 172 197 42 210 73 12 108 87 34 88 23 241 227 58 63 225 159 220 219 186 127 57 229 177 177 152 74 10 172 253 104 229 28 61 105 196 89 248 182 185 86 76 115 247 138 96 200 40 49 74 80 148 73 203 211 179 218 63 107 243 20 248 44 90 111 119 242 83 39 54 180 162 104 157 249 101 0 0 0 128 113 140 33 135 81 245 44 242 234 48 18 58 218 5 142 237 168 122 89 26 123 23 157 34 73 16 93 92 105 104 113 36 144 136 108 131 55 218 225 23 0 135 231 243 145 203 98 215 56 202 200 14 30 31 156 93 160 130 106 155 144 68 201 220 231 20 77 134 31 112 239 53 76 173 78 107 143 112 167 241 236 252 180 236 147 84 213 120 79 160 238 129 197 253 144 124 125 131 158 46 148 144 77 20 222 96 139 63 189 165 233 9 180 107 255 191 1 79 226 166 23 195 247 191 81 144 140 192 0 0 1 15 0 0 0 7 115 115 104 45 114 115 97 0 0 1 0 180 130 111 246 253 88 154 194 199 203 188 138 115 111 100 209 86 44 51 58 87 134 31 92 60 153 48 191 156 180 243 112 207 34 45 18 225 229 27 160 31 193 3 93 140 5 117 195 157 198 215 254 250 218 196 33 138 115 180 26 131 216 123 107 250 100 97 62 110 12 105 194 212 167 223 92 28 70 91 180 251 29 254 83 226 176 99 200 100 252 11 173 193 82 33 199 123 4 250 45 133 149 241 153 71 240 116 13 131 51 208 237 192 145 146 243 95 125 137 174 15 23 173 9 122 175 127 74 155 157 12 148 35 7 151 46 91 57 209 31 81 217 146 96 219 139 174 198 226 70 176 218 127 235 60 170 60 190 239 44 122 136 15 44 254 77 171 181 225 208 34 145 199 150 17 106 18 102 51 49 254 55 114 147 191 208 155 141 181 3 16 157 7 213 187 226 61 26 185 30 218 223 173 117 106 150 216 254 61 160 204 143 2 92 16 44 117 189 59 157 94 100 5 207 25 109 54 70 229 114 12 121 143 126 104 227 187 137 4 43 84 166 248 217 208 86 87 157 179 237 159 174 184 143 209 197 0 0 0 0 0 0 0 0 0 0 ) 
#(0 0 0 12 10 21 0 0 ) 
#(0 0 0 0 0 0 0 0 ) 
#(163 199 234 239 131 121 128 8 ) 
#(50 185 81 107 111 13 144 191 169 194 64 241 0 83 64 209 107 7 78 11 119 130 175 249 ) 
#(186 126 11 216 119 65 180 213 122 229 210 56 7 145 44 232 58 122 208 152 ) 
#(125 206 54 216 112 152 125 247 ) 
#(240 12 228 60 228 222 34 136 ) 
#(174 28 148 95 197 112 179 238 77 1 25 56 87 88 97 114 103 144 62 223 ) 
#(35 122 126 218 99 185 150 126 ) 
#(238 244 220 110 95 216 199 218 133 150 70 248 221 208 149 199 17 40 127 67 197 107 47 96 ) 
#(196 112 174 173 53 192 22 63 17 234 185 142 24 159 222 164 94 91 84 244 ) 
#(199 241 32 132 237 44 117 17 ) 
#(226 234 192 111 48 100 210 108 129 157 59 196 183 4 150 239 ) 
#(236 130 56 253 30 118 103 251 121 248 218 173 226 58 34 48 102 16 58 115 ) 
#(161 11 161 103 255 239 190 255 ) 
#(47 235 9 76 215 100 59 135 ) 
#(144 184 6 174 36 173 24 58 77 41 21 248 164 81 122 121 62 211 205 220 ) 
#(131 155 176 136 152 16 67 35 ) 
#(150 231 67 251 114 241 183 100 16 240 254 9 189 201 11 59 229 167 130 77 108 97 238 227 ) 
#(16 114 248 232 98 249 4 219 116 41 151 226 15 132 203 67 183 55 237 186 ) 
#(162 138 63 122 129 34 80 198 ) 
#(94 90 24 185 74 122 106 200 ) 
#(241 144 205 167 4 101 14 87 50 187 47 16 195 147 155 105 74 229 115 120 ) 
#(228 215 58 175 34 240 33 175 ) 
#(180 129 196 217 2 68 237 195 112 111 28 254 210 41 38 129 238 122 66 195 9 63 44 197 225 156 104 169 200 137 99 141 ) 
#(67 17 141 240 151 203 78 97 223 175 215 120 0 62 83 88 217 224 66 226 ) 
#(173 0 220 28 126 56 162 72 ) 
#(174 129 238 118 215 149 144 33 ) 
#(217 109 242 212 15 153 239 181 192 25 82 78 153 231 89 123 61 19 75 26 ) 
#(213 39 174 206 15 68 58 233 ) 
#(221 72 163 104 15 130 66 148 196 74 170 186 27 229 1 183 202 3 34 125 106 76 41 146 ) 
#(60 119 134 159 41 252 167 105 1 174 235 236 54 17 185 75 85 212 125 209 ) 
#(27 115 168 41 86 93 244 223 ) 
#(62 190 164 5 74 5 227 108 52 149 186 139 116 30 163 101 ) 
#(174 80 91 104 112 102 20 114 171 108 6 75 233 99 183 17 65 240 14 131 ) 
#(63 25 32 18 175 137 130 101 ) 
#(237 148 238 66 48 206 120 203 ) 
#(151 90 234 197 73 177 161 198 252 48 221 226 50 66 194 111 97 218 142 158 ) 
#(125 226 35 14 200 175 37 67 ) 
#(138 36 240 7 26 252 237 51 248 157 218 208 124 34 215 249 90 181 76 118 196 116 10 132 163 102 140 209 80 185 97 208 115 77 189 255 55 151 77 14 93 7 46 0 57 201 179 33 243 14 245 180 50 24 156 8 184 239 157 192 110 66 247 185 80 90 216 150 34 26 85 37 133 36 72 44 64 170 185 113 31 140 246 153 197 6 90 61 ) 
#(73 95 85 216 254 201 242 14 165 208 74 157 207 17 182 11 136 16 34 124 ) 
#(110 213 89 194 199 189 96 246 ) 
#(110 74 22 240 139 175 40 124 101 195 164 168 67 147 168 102 224 55 207 219 23 222 41 42 149 20 67 222 63 2 200 82 105 109 14 28 149 143 244 241 81 1 161 7 154 121 73 19 204 2 132 54 172 44 120 94 175 63 127 105 8 122 41 36 101 191 24 108 241 10 231 155 ) 
#(229 169 229 6 138 189 54 70 13 89 145 135 159 79 198 4 218 101 33 158 ) 
#(114 205 106 181 145 191 179 113 ) 
#(92 7 104 196 241 224 96 22 110 131 68 68 25 139 255 125 129 93 132 149 99 2 243 110 67 199 12 54 197 19 129 146 206 162 237 94 86 89 133 53 59 254 220 246 156 200 124 233 34 6 53 207 37 71 171 16 155 79 248 21 6 11 123 44 21 150 124 36 11 227 30 217 229 250 33 87 40 126 189 194 225 39 219 219 10 45 81 251 152 0 93 7 46 102 189 54 130 232 36 208 9 171 183 80 1 52 130 184 98 93 111 188 172 126 78 182 23 45 73 248 142 236 114 11 229 187 237 38 254 95 100 110 179 95 183 21 47 97 207 111 239 67 199 9 54 240 128 3 143 213 48 154 244 209 85 198 177 136 193 25 244 8 103 88 17 173 20 8 179 162 51 91 70 180 165 195 21 32 195 129 151 167 58 110 184 56 18 90 147 121 108 170 239 138 212 243 58 61 217 178 228 181 116 29 80 89 109 10 ) 
#(17 242 161 8 97 180 209 255 103 46 103 220 57 126 25 187 253 25 31 59 ) 
#(213 144 62 122 18 38 246 65 ) 
#(193 97 55 91 73 130 122 112 107 175 235 131 219 252 207 68 88 44 55 120 75 48 51 189 247 236 163 54 91 142 165 135 207 9 43 50 102 185 255 240 76 49 90 21 218 236 74 218 54 112 127 96 236 98 136 161 21 138 51 88 129 250 35 140 73 151 39 89 28 59 92 142 166 213 94 108 249 29 8 86 50 219 253 54 190 127 236 245 94 142 213 69 27 255 116 96 139 147 216 71 201 98 180 144 250 226 112 3 117 7 37 204 233 109 176 235 32 58 245 135 207 61 200 99 138 189 130 49 59 122 121 175 107 15 40 225 46 154 10 245 26 130 252 147 233 65 219 255 55 230 86 190 33 164 93 52 210 10 231 132 135 199 152 21 163 31 113 235 149 90 242 14 175 123 58 253 32 63 159 7 17 115 2 107 168 186 194 221 88 241 7 207 135 24 154 206 61 149 72 63 111 44 157 111 245 46 247 251 247 103 124 75 136 38 206 44 160 26 68 12 43 137 145 49 ) 
#(3 123 151 121 119 77 150 19 224 159 226 63 36 135 75 203 217 204 243 64 ) 
#(60 106 71 91 128 170 229 120 ) 
#(53 176 2 209 12 150 74 28 11 17 53 69 42 158 222 78 182 182 193 16 131 38 68 139 85 168 36 172 34 167 40 253 165 111 170 85 76 25 236 141 238 125 239 71 239 57 213 58 255 11 118 100 112 239 249 76 116 201 143 122 0 160 175 221 103 170 110 30 253 70 108 11 236 249 173 102 173 99 181 64 209 217 182 213 164 69 37 195 60 143 251 232 165 195 20 155 183 153 234 210 19 239 162 59 181 126 84 189 231 186 154 53 90 83 56 139 116 90 30 75 164 7 136 87 112 81 38 24 59 115 205 35 89 61 243 52 77 22 120 235 131 135 66 31 86 187 123 35 233 107 224 246 104 97 137 178 112 137 216 86 108 26 40 238 207 218 201 27 182 51 252 213 127 195 120 216 115 222 14 74 186 143 130 0 138 75 42 210 87 231 10 94 125 160 99 46 143 16 157 12 1 242 80 180 26 127 35 139 47 219 76 131 221 209 165 91 237 115 209 204 95 186 206 19 117 94 244 11 21 193 109 37 38 57 105 140 121 213 223 134 133 180 73 15 196 82 196 225 243 231 224 147 59 224 216 182 37 253 87 216 105 26 38 158 174 130 80 91 155 114 118 237 6 70 7 62 102 234 192 34 48 96 139 59 253 91 113 80 209 220 166 232 0 96 166 119 26 254 208 183 115 168 175 210 88 107 58 134 129 42 95 73 221 155 56 48 18 40 183 62 224 199 94 183 212 13 106 106 214 197 9 8 193 249 120 54 96 226 46 64 63 96 117 72 210 189 133 207 162 218 76 78 240 73 78 70 17 157 68 30 115 187 225 89 188 25 138 12 59 117 189 76 129 243 248 45 34 128 135 168 87 119 218 195 17 227 94 15 80 31 23 163 108 20 154 50 131 51 16 94 62 13 74 87 13 118 57 20 254 238 188 236 231 254 208 250 136 64 127 176 61 8 129 215 135 58 202 118 138 44 47 16 151 114 25 74 133 107 90 199 212 203 205 93 24 48 163 134 ) 
#(143 61 217 121 175 204 33 97 39 88 255 0 75 161 111 174 132 29 69 77 ) 
#(32 26 31 138 158 9 76 18 ) 
#(113 38 180 246 238 203 131 200 100 183 138 30 207 212 180 108 245 220 191 157 26 153 99 223 146 81 244 66 108 156 169 168 129 25 37 69 230 16 238 115 84 25 90 156 49 51 190 153 27 182 123 205 30 186 68 249 170 183 10 86 160 220 3 63 239 202 198 214 10 37 136 226 52 104 11 144 25 179 34 178 40 208 137 47 39 32 245 120 90 173 10 125 100 224 140 89 153 85 201 168 231 158 82 219 221 49 182 172 234 185 194 154 188 89 167 3 143 91 227 130 245 227 138 184 42 213 136 126 165 26 169 195 239 4 226 107 205 179 85 126 233 16 55 45 67 183 6 114 111 152 7 182 182 122 235 15 97 168 171 70 137 15 193 148 215 86 37 109 150 194 119 72 86 12 87 183 220 199 31 52 193 151 124 200 222 229 18 167 186 220 161 115 212 226 90 150 131 2 135 45 174 227 94 138 220 251 57 7 23 246 19 112 127 240 244 129 152 154 42 25 64 184 254 82 58 151 173 157 100 186 18 32 122 167 172 164 91 23 217 47 144 219 60 188 152 179 45 245 170 33 3 147 25 139 95 136 74 100 65 167 222 157 71 66 167 133 10 110 251 184 56 39 108 118 152 11 48 110 17 169 238 91 230 89 127 165 201 215 156 165 207 54 25 90 30 174 70 64 41 197 229 50 187 41 148 242 218 154 65 104 200 189 210 9 119 122 120 146 165 116 251 31 183 154 255 245 238 138 129 193 199 228 132 31 170 19 128 132 47 129 139 221 139 153 192 152 254 125 191 150 10 52 13 78 29 14 4 249 167 15 155 190 106 56 6 147 202 59 89 88 77 231 94 127 70 16 ) 
#(56 107 197 158 135 7 214 117 238 206 29 52 236 179 79 223 37 86 35 96 ) 
#(41 232 11 92 115 186 3 21 ) 
#(63 42 45 81 138 153 82 82 185 42 19 44 144 138 26 160 194 145 14 76 128 137 241 66 75 142 179 125 94 96 111 55 36 252 12 139 171 65 166 74 243 110 253 238 99 199 117 79 133 114 149 99 31 194 217 156 234 237 203 17 172 191 126 248 87 249 100 83 244 75 225 72 189 81 110 83 49 242 118 216 148 210 32 105 38 159 86 95 86 73 155 209 208 159 95 21 88 10 44 95 4 62 135 56 62 52 181 213 48 166 172 44 19 56 255 166 184 247 8 114 17 140 159 188 89 90 21 98 166 152 93 31 241 255 189 157 122 144 53 3 68 227 59 57 106 39 150 140 89 135 204 241 175 72 105 80 163 223 195 116 221 3 119 131 230 184 9 211 28 165 135 105 244 126 81 177 15 12 192 23 154 182 80 241 143 39 46 131 72 8 10 4 119 17 164 75 78 183 71 99 58 210 197 180 254 213 201 242 217 174 147 205 13 55 42 65 190 229 113 75 54 67 101 147 61 68 87 199 5 56 80 25 164 21 17 191 204 92 124 100 218 86 253 123 150 9 100 192 46 90 72 175 172 47 144 78 112 47 90 9 103 4 219 112 37 64 220 90 141 16 236 197 102 76 81 26 98 115 123 251 ) 
#(26 231 151 227 115 209 62 194 132 4 32 64 237 140 144 71 60 45 64 77 ) 
#(123 125 24 24 220 123 56 27 ) 
#(44 88 110 231 59 186 154 104 243 58 213 221 206 193 21 110 46 139 66 251 78 117 184 69 6 31 100 98 152 67 23 225 214 112 209 252 162 182 121 251 232 16 198 17 126 165 52 23 215 127 6 65 83 57 40 67 166 186 115 86 250 62 164 9 0 91 52 202 183 75 122 90 113 6 54 188 233 18 217 213 99 25 189 75 237 85 181 117 85 144 8 178 244 179 9 75 245 187 239 224 147 23 0 20 61 221 215 191 163 1 148 47 208 94 145 120 34 218 55 148 198 33 187 216 8 76 8 105 216 67 17 20 74 54 191 252 85 6 32 176 64 106 48 83 144 208 12 57 239 69 43 202 104 178 15 120 8 92 106 173 168 193 234 124 73 174 155 121 191 85 43 201 2 209 117 203 130 219 145 177 185 134 108 118 63 189 25 217 78 71 42 123 5 191 238 120 103 52 192 101 65 236 108 133 9 150 89 125 252 70 37 215 149 176 78 91 ) 
#(208 74 217 80 157 212 39 13 255 233 93 35 10 144 12 26 103 25 104 213 ) 
#(0 237 171 138 13 145 238 182 ) 
#(5 47 22 62 237 58 69 97 173 205 131 106 38 147 83 178 51 190 216 71 206 231 169 146 23 221 67 99 104 38 48 106 126 242 103 139 175 206 189 30 231 122 25 253 13 221 90 61 137 240 246 20 181 84 179 37 239 241 225 37 81 52 24 183 26 78 239 105 182 166 195 239 234 53 168 133 89 183 79 210 92 206 75 74 218 140 125 119 170 101 48 253 155 79 0 159 27 152 60 7 38 130 136 156 198 161 22 212 48 75 29 74 39 228 82 52 126 232 107 194 162 129 117 24 10 64 101 155 153 2 36 90 36 38 168 119 226 136 26 117 152 25 192 152 9 235 74 198 64 36 60 209 186 57 7 1 221 174 40 76 95 120 34 175 202 117 188 232 198 121 1 40 102 79 26 254 144 21 95 188 244 48 162 237 200 191 131 0 101 134 47 234 78 204 124 93 196 165 111 223 ) 
#(19 75 95 176 214 255 90 160 69 144 128 63 173 82 36 36 61 89 111 247 ) 
#(131 17 22 145 111 134 132 132 ) 
#(250 62 73 57 222 64 105 132 62 174 253 104 234 115 53 41 230 102 43 201 113 107 233 9 133 33 153 57 235 207 208 74 175 41 87 183 36 78 187 0 236 195 195 40 43 1 20 131 50 175 50 129 70 5 170 198 154 111 59 213 190 64 252 35 202 45 196 140 141 22 134 85 102 130 139 100 177 53 210 159 29 110 43 81 55 46 45 94 51 143 0 83 81 213 224 137 32 112 30 238 99 121 141 86 178 37 191 206 101 253 72 158 92 159 32 107 12 119 192 101 16 2 135 20 0 18 52 208 17 252 247 147 190 189 160 200 24 7 134 133 26 187 11 93 ) 
#(151 137 227 3 92 7 174 239 153 132 220 208 196 203 158 249 2 217 124 140 ) 
#(101 224 192 227 216 222 100 158 ) 
#(247 169 201 27 237 4 119 62 ) 
#(204 26 252 137 221 141 28 185 97 102 234 228 32 208 206 189 211 244 241 34 ) 
#(218 66 50 45 246 140 108 38 ) 
#(44 155 173 189 40 92 255 64 71 100 22 103 86 211 177 232 104 230 204 180 90 62 145 65 182 184 17 123 47 27 204 6 ) 
#(121 180 113 252 1 55 56 96 182 126 12 222 180 13 93 222 75 41 141 145 ) 
#(215 16 186 81 64 110 69 55 ) 
#(237 33 23 36 148 194 142 120 ) 
#(121 160 61 27 207 148 13 231 119 92 183 157 221 60 140 126 219 155 253 29 ) 
)!

atEnd

	^false!

data
	
	^self _data3!

flush!

initialize

	writeBuffer := OrderedCollection new.
	index := 0!

next: anInteger

	^self read!

nextPutAll: aString

	self write: aString!

read

	index := index + 1.
	^String withAll: ((self data at: index) collect: [:each | each asCharacter])!

socket

	^socket!

socket: anObject

	socket := anObject!

write: aString

	writeBuffer add: aString! !

SocketEmulator initializeAfterLoad!


Object subclass: #SSH2Message
    instanceVariableNames: 'type '
    classVariableNames: ''
    poolDictionaries: 'SSH2Constants '!

!SSH2Message class publicMethods !

associatedMessageTypes

	^#()!

fromBytes: aString

	^(self messageFor: aString first value)
			buildFrom: aString;
			yourself!

messageAuthorizationRequestUser: username password: password
	"Answer a new SSH_MSG_USERAUTH_REQUEST username/password message authorization with <username> and <password>."
	
	^(SSH2Message messageFor: SSH_MSG_USERAUTH_REQUEST)
		user: username;
		service: 'ssh-connection'; 
		method: 'password';
		wantReply: false;
		password: password;
		yourself!

messageChannel: anInteger data: aString
	"Answer a new SSH_MSG_CHANNEL_DATA message for channel <anInteger>."
	
	^(SSH2Message messageFor: SSH_MSG_CHANNEL_DATA)
		channel: anInteger;
		data: aString;
		yourself!

messageChannelRequest: aNumber command: aString
	"Answer a new SSH_MSG_CHANNEL_REQUEST message for channel <anInteger>."
	
	^(SSH2MessageChannelRequest messageFor: SSH_MSG_CHANNEL_REQUEST)
		channel: aNumber;
		requestType: 'exec';
		wantReply: true;
		commandDescription: aString;
		yourself!

messageClassFor: aNumber

	^self allSubclasses 
		detect: [:each | each associatedMessageTypes includes: aNumber]
		ifNone: [self]!

messageCloseChannel: anInteger
	"Answer a new SSH_MSG_CHANNEL_CLOSE message for channel <anInteger>."
	
	^(SSH2MessageChannel messageFor: SSH_MSG_CHANNEL_CLOSE)
		channel: anInteger;
		yourself!

messageDisconnectReason: anInteger
	"Answer a new SSH_MSG_DISCONNECT message for reason <anInteger>."
	
	^(SSH2Message messageFor: SSH_MSG_DISCONNECT)
		reason: anInteger;
		description: '';
		languajeTag: '';
		yourself
!

messageFor: aNumber

	^(self messageClassFor: aNumber) new
		type: aNumber;
		yourself!

messageKexInitCookie: cookieString 
keyExchangeAlgorithms: keyExchangeAlgorithms
serverHostKeyAlgorithms: serverHostAlgorithms
encryptionClientToServerAlgorithms: encryptionAlgorithmsClient
encryptionServerToClientAlgorithms: encryptionAlgorithmsServer
macAlgorithmsClientToServer: macAlgorithmsServer
macAlgorithmsServerToClient: macAlgorithmsClient
compressionAlgorithmsClientToServer: compressionAlgorithmsClient
compressionAlgorithmsServerToClient: compressionAlgorithmsServer
languajesClientToServer: languajesClient
languajesServerToClient: languajesServer	

	^(SSH2Message messageFor: SSH_MSG_KEXINIT)
		cookie: cookieString;
		keyExchangeAlgorithms: keyExchangeAlgorithms;
		serverHostKeyAlgorithms: serverHostAlgorithms;
		encryptionAlgorithmsClientToServer: encryptionAlgorithmsClient;
		encryptionAlgorithmsServerToClient: encryptionAlgorithmsServer;
		macAlgorithmsClientToServer: macAlgorithmsServer;
		macAlgorithmsServerToClient: macAlgorithmsClient;
		compressionAlgorithmsClientToServer: compressionAlgorithmsClient;
		compressionAlgorithmsServerToClient: compressionAlgorithmsServer;
		languajesClientToServer: languajesClient;
		languajesServerToClient: languajesServer;
		yourself
!

messageKeyExchangeDHInit: aString
	"Answer a new SSH_MSG_KEXDH_INIT message for key <aString>."
	
	^(SSH2MessageData messageFor: SSH_MSG_KEXDH_INIT)
		data: aString;
		yourself!

messageNewKeys
	"Answer a new SSH_MSG_NEWKEYS message."
	
	^SSH2Message messageFor: SSH_MSG_NEWKEYS
!

messageOpenChannelSession: anInteger windowSize: windowSize packetSize: packetSize
	"Answer a new SSH_MSG_CHANNEL_OPEN message for channel <anInteger> in mode 'session'."
	
	^(SSH2Message messageFor: SSH_MSG_CHANNEL_OPEN)
		channel: anInteger;
		sessionType: 'session';
		windowSize: windowSize;
		packetSize: packetSize;
		yourself!

messageSFTPChannelRequest: aNumber
	"Answer a new SSH_MSG_CHANNEL_REQUEST message for channel <anInteger>."
	
	^(SSH2Message messageFor: SSH_MSG_CHANNEL_REQUEST)
		channel: aNumber;
		requestType: 'subsystem';
		wantReply: true;
		commandDescription: 'sftp';
		yourself!

messageSSHLoginRequest
	"Answer a new SSH_MSG_SERVICE_REQUEST message for reason <anInteger>."
	
	^(SSH2MessageData messageFor: SSH_MSG_SERVICE_REQUEST)
		data: 'ssh-userauth';
		yourself

!

messageWindowAdjust: channel size: size
	"Answer a new SSH_MSG_CHANNEL_CLOSE message for channel <anInteger>."
	
	^(SSH2Message messageFor: SSH_MSG_CHANNEL_WINDOW_ADJUST)
		channel: channel;
		size: size;
		yourself! !

!SSH2Message publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^OrderedCollection with: (SSHMessageFieldByte for: #type)!

buildFrom: aString
	"Build the receiver from <aString>."

	| stream |
	stream := ReadStream on: aString.
	self binaryDescription do: [:each | each build: self from: stream]

!

contents 
	"Answer a Collection with binary contents of the receiver."	

	^self binaryDescription 
		inject: '' 
		into: [:total :each | total, (each contentsFor: self)]!

type

	^type!

type: aNumber

	type := aNumber! !

SSH2Message initializeAfterLoad!


SSH2Message subclass: #SSH2MessageAuthorizationRequest
    instanceVariableNames: 'user service method wantReply specific '
    classVariableNames: ''
    poolDictionaries: ''!

!SSH2MessageAuthorizationRequest class publicMethods !

associatedMessageTypes

	^Array 
		with: SSH_MSG_USERAUTH_REQUEST
! !

!SSH2MessageAuthorizationRequest publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection new
			add: (SSHMessageFieldString for: #user);
			add: (SSHMessageFieldString for: #service);
			add: (SSHMessageFieldString for: #method);
			add: (SSHMessageFieldHole for: 0 asCharacter asString);
			add: (SSHMessageFieldString for: #specific);
			yourself)!

method
	
	^method!

method: anObject
	
	method := anObject!

password: anObject
	"Set specific data for password on the receiver to <anObject>."

	self specific: anObject!

service
	
	^service!

service: anObject
	
	service := anObject!

specific
	
	^specific!

specific: anObject
	
	specific := anObject!

user
	
	^user!

user: anObject
	
	user := anObject!

wantReply
	
	^wantReply!

wantReply: anObject
	
	wantReply := anObject! !

SSH2MessageAuthorizationRequest initializeAfterLoad!


SSH2Message subclass: #SSH2MessageChannel
    instanceVariableNames: 'channel '
    classVariableNames: ''
    poolDictionaries: ''!

!SSH2MessageChannel class publicMethods !

associatedMessageTypes

	^Array 
		with: SSH_MSG_CHANNEL_CLOSE
! !

!SSH2MessageChannel publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection
			with: (SSHMessageFieldInteger for: #channel))!

channel

	^channel!

channel: anObject

	channel := anObject! !

SSH2MessageChannel initializeAfterLoad!


SSH2Message subclass: #SSH2MessageChannelData
    instanceVariableNames: 'channel data '
    classVariableNames: ''
    poolDictionaries: ''!

!SSH2MessageChannelData class publicMethods !

associatedMessageTypes

	^Array 
		with: SSH_MSG_CHANNEL_DATA
! !

!SSH2MessageChannelData publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection
			with: (SSHMessageFieldInteger for: #channel)
			with: (SSHMessageFieldString for: #data))!

channel

	^channel!

channel: anObject

	channel := anObject!

data

	^data!

data: anObject

	data := anObject! !

SSH2MessageChannelData initializeAfterLoad!


SSH2Message subclass: #SSH2MessageChannelExtendedData
    instanceVariableNames: 'channel dataType data '
    classVariableNames: ''
    poolDictionaries: ''!

!SSH2MessageChannelExtendedData class publicMethods !

associatedMessageTypes

	^Array 
		with: SSH_MSG_CHANNEL_EXTENDED_DATA
! !

!SSH2MessageChannelExtendedData publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection
			with: (SSHMessageFieldInteger for: #channel)
			with: (SSHMessageFieldInteger for: #dataType)
			with: (SSHMessageFieldString for: #data))
!

channel

	^channel!

channel: anObject

	channel := anObject!

data

	^data!

data: anObject

	data := anObject!

dataType

	^dataType!

dataType: anObject

	dataType := anObject! !

SSH2MessageChannelExtendedData initializeAfterLoad!


SSH2Message subclass: #SSH2MessageChannelOpen
    instanceVariableNames: 'channel sessionType windowSize packetSize specific '
    classVariableNames: ''
    poolDictionaries: ''!

!SSH2MessageChannelOpen class publicMethods !

associatedMessageTypes

	^Array 
		with: SSH_MSG_CHANNEL_OPEN
! !

!SSH2MessageChannelOpen publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection
			with: (SSHMessageFieldString for: #sessionType)
			with: (SSHMessageFieldInteger for: #channel)
			with: (SSHMessageFieldInteger for: #windowSize)
			with: (SSHMessageFieldInteger for: #packetSize))!

channel

	^channel!

channel: anObject

	channel := anObject!

packetSize

	^packetSize!

packetSize: anObject

	packetSize := anObject!

sessionType

	^sessionType!

sessionType: anObject

	sessionType := anObject!

specific

	^specific!

specific: anObject

	specific := anObject!

windowSize

	^windowSize!

windowSize: anObject

	windowSize := anObject! !

SSH2MessageChannelOpen initializeAfterLoad!


SSH2Message subclass: #SSH2MessageChannelOpenConfirmation
    instanceVariableNames: 'channel serverChannel packetSize '
    classVariableNames: ''
    poolDictionaries: ''!

!SSH2MessageChannelOpenConfirmation class publicMethods !

associatedMessageTypes

	^Array 
		with: SSH_MSG_CHANNEL_OPEN_CONFIRMATION
! !

!SSH2MessageChannelOpenConfirmation publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection
			with: (SSHMessageFieldInteger for: #channel)
			with: (SSHMessageFieldInteger for: #serverChannel)
			with: (SSHMessageFieldHole for: '    ')
			with: (SSHMessageFieldInteger for: #packetSize))!

channel

	^channel
!

channel: anObject
	
	channel := anObject
!

packetSize

	^packetSize
!

packetSize: anObject

	packetSize := anObject
!

serverChannel

	^serverChannel
!

serverChannel: anObject

	serverChannel := anObject

! !

SSH2MessageChannelOpenConfirmation initializeAfterLoad!


SSH2Message subclass: #SSH2MessageChannelRequest
    instanceVariableNames: 'channel requestType wantReply specific '
    classVariableNames: ''
    poolDictionaries: ''!

!SSH2MessageChannelRequest class publicMethods !

associatedMessageTypes

	^Array 
		with: SSH_MSG_CHANNEL_REQUEST! !

!SSH2MessageChannelRequest publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection
			with: (SSHMessageFieldInteger for: #channel)
			with: (SSHMessageFieldString for: #requestType)
			with: (SSHMessageFieldBoolean for: #wantReply)
			with: (SSHMessageFieldString for: #specific))

!

channel 

	^channel
!

channel: anObject

	channel := anObject
!

commandDescription: aString
	"Set specific data for a command description on the receiver to <aString>."

	self specific: aString!

requestType 

	^requestType

!

requestType: anObject

	requestType := anObject
!

specific

	^specific
!

specific: anObject

	specific := anObject
!

wantReply 

	^wantReply

!

wantReply: anObject

	wantReply := anObject

! !

SSH2MessageChannelRequest initializeAfterLoad!


SSH2Message subclass: #SSH2MessageData
    instanceVariableNames: 'data '
    classVariableNames: ''
    poolDictionaries: ''!

!SSH2MessageData class publicMethods !

associatedMessageTypes

	^Array 
		with: SSH_MSG_KEXDH_INIT
		with: SSH_MSG_SERVICE_REQUEST
! !

!SSH2MessageData publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection
			with: (SSHMessageFieldString for: #data))
!

data

	^data!

data: anObject

	data := anObject! !

SSH2MessageData initializeAfterLoad!


SSH2Message subclass: #SSH2MessageDisconnect
    instanceVariableNames: 'reason description languajeTag '
    classVariableNames: ''
    poolDictionaries: ''!

!SSH2MessageDisconnect class publicMethods !

associatedMessageTypes

	^Array 
		with: SSH_MSG_DISCONNECT! !

!SSH2MessageDisconnect publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection
			with: (SSHMessageFieldString for: #description)
			with: (SSHMessageFieldString for: #reason)
			with: (SSHMessageFieldString for: #languajeTag))
!

description

	^description
!

description: anObject

	description := anObject
!

languajeTag

	^languajeTag
!

languajeTag: anObject

	languajeTag := anObject
!

reason

	^reason
!

reason: anObject

	reason := anObject
! !

SSH2MessageDisconnect initializeAfterLoad!


SSH2Message subclass: #SSH2MessageKexDHReply
    instanceVariableNames: 'serverKey serverPublicKeyData f hashSignature publicKeyFormat '
    classVariableNames: ''
    poolDictionaries: ''!

!SSH2MessageKexDHReply class publicMethods !

associatedMessageTypes

	^Array 
		with: SSH_MSG_KEXDH_REPLY
! !

!SSH2MessageKexDHReply publicMethods !

buildFrom: aString
	"Build the receiver from <aString>."

	| value bytes publicKeyData signatureData signatureFormat length |	
	super buildFrom: aString.
	value := aString copyFrom: 2 to: aString size.
	length := value sshLongAt: 1.
	value := value copyFrom: 5 to: value size.
	serverPublicKeyData := value copyFrom: 1 to: length.
	publicKeyData := serverPublicKeyData.
	value := value copyFrom: length + 1 to: value size.

	length := publicKeyData sshLongAt: 1.
	publicKeyData := publicKeyData copyFrom: 5 to: publicKeyData size.
	publicKeyFormat := publicKeyData copyFrom: 1 to: length.

	length := value sshLongAt: 1.
	value := value copyFrom: 5 to: value size.
	serverKey := value copyFrom: 1 to: length.
	value := value copyFrom: length + 1 to: value size.

	length := value sshLongAt: 1.
	value := value copyFrom: 5 to: value size.	
	signatureData := value copyFrom: 1 to: length.
	value := value copyFrom: length + 1 to: value size.

	length := signatureData sshLongAt: 1.
	signatureData := signatureData copyFrom: 5 to: signatureData size.
	signatureFormat := signatureData copyFrom: 1 to: length. 
	signatureData := signatureData copyFrom: length + 1 to: signatureData size

	!

f

	^f!

f: anObject

	f := anObject!

hashSignature

	^hashSignature!

hashSignature: anObject

	hashSignature := anObject!

publicKeyFormat

	^publicKeyFormat!

publicKeyFormat: anObject

	publicKeyFormat := anObject!

serverKey

	^serverKey!

serverKey: anObject

	serverKey := anObject!

serverPublicKeyData

	^serverPublicKeyData! !

SSH2MessageKexDHReply initializeAfterLoad!


SSH2Message subclass: #SSH2MessageKexInit
    instanceVariableNames: 'cookie keyExchangeAlgorithms serverHostKeyAlgorithms encryptionAlgorithmsClientToServer encryptionAlgorithmsServerToClient macAlgorithmsClientToServer macAlgorithmsServerToClient compressionAlgorithmsClientToServer compressionAlgorithmsServerToClient languajesClientToServer languajesServerToClient firstKexPacketFollows reserved payload '
    classVariableNames: ''
    poolDictionaries: ''!

!SSH2MessageKexInit class publicMethods !

associatedMessageTypes

	^Array 
		with: SSH_MSG_KEXINIT
! !

!SSH2MessageKexInit publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection new
			add: (SSHMessageFieldFixedString for: #cookie size: 16);
			add: (SSHMessageFieldStringCollection for: #keyExchangeAlgorithms);
			add: (SSHMessageFieldStringCollection for: #serverHostKeyAlgorithms);
			add: (SSHMessageFieldStringCollection for: #encryptionAlgorithmsClientToServer);
			add: (SSHMessageFieldStringCollection for: #encryptionAlgorithmsServerToClient);
			add: (SSHMessageFieldStringCollection for: #macAlgorithmsClientToServer);
			add: (SSHMessageFieldStringCollection for: #macAlgorithmsServerToClient);
			add: (SSHMessageFieldStringCollection for: #compressionAlgorithmsClientToServer);
			add: (SSHMessageFieldStringCollection for: #compressionAlgorithmsServerToClient);
			add: (SSHMessageFieldStringCollection for: #languajesClientToServer);
			add: (SSHMessageFieldStringCollection for: #languajesServerToClient);
			add: (SSHMessageFieldHole for: (String withAll: (#(0 0 0 0 0) collect: [:each | each asCharacter])));
			yourself)
!

buildFrom: aString
	"Build the receiver from <aString>."

	payload := aString.
	super buildFrom: aString

!

compressionAlgorithmsClientToServer

	^compressionAlgorithmsClientToServer!

compressionAlgorithmsClientToServer: anObject

	compressionAlgorithmsClientToServer := anObject!

compressionAlgorithmsServerToClient

	^compressionAlgorithmsServerToClient!

compressionAlgorithmsServerToClient: anObject

	compressionAlgorithmsServerToClient := anObject!

cookie

	^cookie!

cookie: anObject

	^cookie := anObject
!

encryptionAlgorithmsClientToServer

	^encryptionAlgorithmsClientToServer!

encryptionAlgorithmsClientToServer: anObject

	encryptionAlgorithmsClientToServer := anObject!

encryptionAlgorithmsServerToClient

	^encryptionAlgorithmsServerToClient!

encryptionAlgorithmsServerToClient: anObject

	encryptionAlgorithmsServerToClient := anObject
!

firstKexPacketFollows   

	^firstKexPacketFollows   !

keyExchangeAlgorithms

	^keyExchangeAlgorithms!

keyExchangeAlgorithms: anObject

	keyExchangeAlgorithms := anObject!

languajesClientToServer 

	^languajesClientToServer !

languajesClientToServer: anObject

	languajesClientToServer := anObject!

languajesServerToClient  

	^languajesServerToClient  !

languajesServerToClient: anObject

	languajesServerToClient := anObject!

macAlgorithmsClientToServer

	^macAlgorithmsClientToServer!

macAlgorithmsClientToServer: anObject

	macAlgorithmsClientToServer := anObject!

macAlgorithmsServerToClient

	^macAlgorithmsServerToClient!

macAlgorithmsServerToClient: anObject

	macAlgorithmsServerToClient := anObject!

payload

	^payload!

serverHostKeyAlgorithms

	^serverHostKeyAlgorithms!

serverHostKeyAlgorithms: anObject

	serverHostKeyAlgorithms := anObject! !

SSH2MessageKexInit initializeAfterLoad!


SSH2Message subclass: #SSH2MessageWindowAdjust
    instanceVariableNames: 'channel size '
    classVariableNames: ''
    poolDictionaries: ''!

!SSH2MessageWindowAdjust class publicMethods !

associatedMessageTypes

	^Array 
		with: SSH_MSG_CHANNEL_WINDOW_ADJUST
! !

!SSH2MessageWindowAdjust publicMethods !

binaryDescription
	"Answer a Collection of fields which describes the binary contents of the receiver."

	^super binaryDescription, 
		(OrderedCollection
			with: (SSHMessageFieldInteger for: #channel)
			with: (SSHMessageFieldInteger for: #size))
!

channel

	^channel!

channel: anObject

	channel := anObject!

size

	^size!

size: anObject

	size := anObject! !

SSH2MessageWindowAdjust initializeAfterLoad!


Object subclass: #SSHHostConfiguration
    instanceVariableNames: 'identifier publicKey publicKeyFormat publicKeyData privateKey cookie kexInitPayload keyExchangeAlgorithms serverHostKeysAlgorithms encryptionClientToServerAlgorithms encryptionServerToClientAlgorithms macClientToServerAlgorithms macServerToClientAlgorithms compressionClientToServerAlgorithms compressionServerToClientAlgorithms languajesClientToServer languajesServerToClient '
    classVariableNames: ''
    poolDictionaries: ''!

!SSHHostConfiguration class publicMethods !

defaultIdentified: aString cookie: anotherString

	^self new
		identifier: aString;
		cookie: anotherString;
		keyExchangeAlgorithms: self possibleKeyExchangeAlgorithms;
		serverHostKeysAlgorithms: self possibleServerHostKeyAlgorithms;
		encryptionClientToServerAlgorithms: self possibleEncryptionAlgorithms;
		encryptionServerToClientAlgorithms: self possibleEncryptionAlgorithms;
		macClientToServerAlgorithms: self possibleMacAlgorithms;
		macServerToClientAlgorithms: self possibleMacAlgorithms;
		compressionClientToServerAlgorithms: self possibleCompressionAlgorithms;
		compressionServerToClientAlgorithms: self possibleCompressionAlgorithms;
		languajesClientToServer: '';
		languajesServerToClient: '';
		yourself!

possibleCompressionAlgorithms
	"Answer a collection with possible compression algorithms descriptions."

	^(CompressionAlgorithm allSubclasses 
		reject: [:each | each isAbstract])
			collect: [:each | each description]
!

possibleEncryptionAlgorithms 
	"Answer a collection with possible encryption algorithms descriptions."

	^(EncryptionAlgorithm allSubclasses 
		reject: [:each | each isAbstract])
			collect: [:each | each description]!

possibleKeyExchangeAlgorithms
	"Answer a collection with possible key exchange algorithms descriptions."

	^(DiffieHellman allSubclasses 
		reject: [:each | each isAbstract])
			collect: [:each | each description]!

possibleMacAlgorithms
	"Answer a collection with possible MAC algorithms descriptions."

	^(HMACAlgorithm allSubclasses 
		reject: [:each | each isAbstract])
			collect: [:each | each description]!

possibleServerHostKeyAlgorithms
	"Answer a collection with possible server host key algorithms descriptions."

	^OrderedCollection
		with: 'ssh-rsa'
		with: 'ssh-dss'! !

!SSHHostConfiguration publicMethods !

checkServerHostKeyAlgorithms: aSSHHostConfiguration

	| algorithms |
	algorithms := serverHostKeysAlgorithms intersection: aSSHHostConfiguration serverHostKeysAlgorithms.
	algorithms isEmpty ifTrue: [self error: 'No compatible server host key algorithms found'].
	publicKeyFormat = algorithms first ifFalse: [self error: 'Sever host key algorithm mismatch']!

compatibleCompressionAlgorithm: aSSHHostConfiguration

	| algorithms |
	algorithms := compressionClientToServerAlgorithms intersection: aSSHHostConfiguration compressionClientToServerAlgorithms.
	algorithms isEmpty ifTrue: [self error: 'No compatible compression algorithms found'].
	^CompressionAlgorithm fromDescription: algorithms first

!

compatibleDecompressionAlgorithm: aSSHHostConfiguration

	| algorithms |
	algorithms := compressionServerToClientAlgorithms intersection: aSSHHostConfiguration compressionServerToClientAlgorithms.
	algorithms isEmpty ifTrue: [self error: 'No compatible compression algorithms found'].
	^CompressionAlgorithm fromDescription: algorithms first


!

compatibleDecryptionAlgorithm: aSSHHostConfiguration 
	"Answer a compatible decryption algorithm for the receiver and <aSSHHostConfiguration>."

	| algorithms |
	algorithms := encryptionServerToClientAlgorithms intersection: aSSHHostConfiguration encryptionServerToClientAlgorithms.
	algorithms isEmpty ifTrue: [self error: 'No compatible client to server encryption algorithm found'].
	^EncryptionAlgorithm fromDescription: algorithms first
!

compatibleEncryptionAlgorithm: aSSHHostConfiguration 
	"Answer a compatible decryption algorithm for the receiver and <aSSHHostConfiguration>."

	| algorithms |
	algorithms := encryptionClientToServerAlgorithms intersection: aSSHHostConfiguration encryptionClientToServerAlgorithms.
	algorithms isEmpty ifTrue: [self error: 'No compatible client to server encryption algorithm found'].
	^EncryptionAlgorithm fromDescription: algorithms first

!

compatibleHMACCheckAlgorithm: aSSHHostConfiguration

	| algorithms |
	algorithms := macServerToClientAlgorithms intersection: aSSHHostConfiguration macServerToClientAlgorithms.
	algorithms isEmpty ifTrue: [self error: 'No compatible HMAC server to client found'].
	^HMACAlgorithm fromDescription: algorithms first
!

compatibleHMACCreateAlgorithm: aSSHHostConfiguration

	| algorithms |
	algorithms := macClientToServerAlgorithms intersection: aSSHHostConfiguration macClientToServerAlgorithms.
	algorithms isEmpty ifTrue: [self error: 'No compatible HMAC client to server found'].
	^HMACAlgorithm fromDescription: algorithms first!

compatibleKeyExchangeAlgorithm: aSSHHostConfiguration 
	"Answer a compatible key exchange algorithm for the receiver and <aSSHHostConfiguration>."

	| algorithms |
	algorithms := keyExchangeAlgorithms intersection: aSSHHostConfiguration keyExchangeAlgorithms.
	algorithms isEmpty ifTrue: [self error: 'No compatible key exchange algorithm found'].
	^DiffieHellman fromDescription: algorithms first
!

compressionClientToServerAlgorithms

	^compressionClientToServerAlgorithms!

compressionClientToServerAlgorithms: anObject

	compressionClientToServerAlgorithms := anObject!

compressionServerToClientAlgorithms

	^compressionServerToClientAlgorithms!

compressionServerToClientAlgorithms: anObject

	compressionServerToClientAlgorithms := anObject!

configureFromDHReply: aSSH2Message

	publicKey := aSSH2Message serverKey.
	publicKeyFormat := aSSH2Message publicKeyFormat.
	publicKeyData := aSSH2Message serverPublicKeyData!

configureFromKeyExchangeInit: aSSH2Message

	kexInitPayload := aSSH2Message payload.
	keyExchangeAlgorithms := aSSH2Message keyExchangeAlgorithms.
	serverHostKeysAlgorithms := aSSH2Message serverHostKeyAlgorithms.
	encryptionClientToServerAlgorithms := aSSH2Message encryptionAlgorithmsClientToServer.
	encryptionServerToClientAlgorithms := aSSH2Message encryptionAlgorithmsServerToClient.
	macClientToServerAlgorithms := aSSH2Message macAlgorithmsClientToServer.
	macServerToClientAlgorithms := aSSH2Message macAlgorithmsServerToClient.
	compressionClientToServerAlgorithms := aSSH2Message compressionAlgorithmsClientToServer.
	compressionServerToClientAlgorithms := aSSH2Message compressionAlgorithmsServerToClient.
	languajesClientToServer := aSSH2Message languajesClientToServer.
	languajesServerToClient := aSSH2Message languajesServerToClient!

cookie

	^cookie!

cookie: anObject

	cookie := anObject!

encryptionClientToServerAlgorithms

	^encryptionClientToServerAlgorithms!

encryptionClientToServerAlgorithms: anObject

	encryptionClientToServerAlgorithms := anObject!

encryptionServerToClientAlgorithms

	^encryptionServerToClientAlgorithms!

encryptionServerToClientAlgorithms: anObject

	encryptionServerToClientAlgorithms := anObject!

identifier

	^identifier!

identifier: anObject

	identifier := anObject!

kexInitPayload

	^kexInitPayload!

keyExchangeAlgorithms

	^keyExchangeAlgorithms!

keyExchangeAlgorithms: anObject

	keyExchangeAlgorithms := anObject!

languajesClientToServer

	^languajesClientToServer!

languajesClientToServer: anObject

	languajesClientToServer := anObject!

languajesServerToClient

	^languajesServerToClient!

languajesServerToClient: anObject

	languajesServerToClient := anObject!

macClientToServerAlgorithms

	^macClientToServerAlgorithms!

macClientToServerAlgorithms: anObject

	macClientToServerAlgorithms := anObject!

macServerToClientAlgorithms

	^macServerToClientAlgorithms!

macServerToClientAlgorithms: anObject

	macServerToClientAlgorithms := anObject!

messageForKeyExchange

	| message |
	message := SSH2Message 
							messageKexInitCookie: cookie
							keyExchangeAlgorithms: keyExchangeAlgorithms
							serverHostKeyAlgorithms: serverHostKeysAlgorithms
							encryptionClientToServerAlgorithms: encryptionClientToServerAlgorithms
							encryptionServerToClientAlgorithms: encryptionServerToClientAlgorithms
							macAlgorithmsClientToServer: macClientToServerAlgorithms
							macAlgorithmsServerToClient: macServerToClientAlgorithms
							compressionAlgorithmsClientToServer: compressionClientToServerAlgorithms
							compressionAlgorithmsServerToClient: compressionServerToClientAlgorithms
							languajesClientToServer: languajesClientToServer
							languajesServerToClient: languajesServerToClient.
	kexInitPayload := message contents.
	^message!

privateKey

	^privateKey!

privateKey: anObject

	privateKey := anObject!

publicKey

	^publicKey!

publicKey: anObject

	publicKey := anObject!

publicKeyData

	^publicKeyData!

serverHostKeysAlgorithms

	^serverHostKeysAlgorithms!

serverHostKeysAlgorithms: anObject

	serverHostKeysAlgorithms := anObject! !

SSHHostConfiguration initializeAfterLoad!


Object subclass: #SSHMessageField
    instanceVariableNames: 'selector '
    classVariableNames: ''
    poolDictionaries: ''!

!SSHMessageField class publicMethods !

for: aSymbol

	^self new
		selector: aSymbol;
		yourself! !

!SSHMessageField publicMethods !

build: anObject from: aStream

	anObject 
		perform: self setterSelector 
		with: (self fromBinary: aStream)!

byteFromBinary: aString

	| value |
	value := 0.
	aString reverse doWithIndex: [:each :index | 
		each = $1 ifTrue: [value := value + (2 raisedTo: index - 1)]].
	^value asCharacter!

contentsFor: anObject
	"Answer binary contents of the receiver on <anObject>."

	| value |
	value := anObject perform: self selector.
	^self toBinary: value!

describeString: aString
	"Answer a binary representation for <aString>."

	^(self integerToString: aString size), aString


!

integerToString: anInteger
	"Answer a string representing <anInteger> in little endian format, padded to 32 bits."

	^self integerToString: anInteger bits: 32!

integerToString: anInteger bits: aNumber
	"Answer a string representing <anInteger> in little endian format, padded to <aNumber> bits."

	| stream index binary |
	binary := ''.
	stream := ReadWriteStream on: ''.
	index := 0.

	(anInteger printStringRadix: 2 padTo: aNumber) reverse do: [:each | 
		index := index + 1.
		binary := binary, each asString.
		index = 8 ifTrue: [
			index := 0. 
			stream nextPut: (self byteFromBinary: binary reverse).
			binary := '' ]].

	index > 0 ifTrue: [
		1 to: 8 - index do: [:each | binary := $0 asString, binary].
		stream nextPut: (self byteFromBinary: binary)].
	
	^stream contents reverse
	!

selector

	^selector!

selector: anObject

	selector := anObject!

setterSelector
	"Answer the setter selector for the receiver."

	^(self selector asString, ':') asSymbol
! !

SSHMessageField initializeAfterLoad!


SSHMessageField subclass: #SSHMessageFieldBoolean
    instanceVariableNames: ''
    classVariableNames: ''
    poolDictionaries: ''!

!SSHMessageFieldBoolean publicMethods !

fromBinary: aStream
	
	 ^aStream next value = 1
!

toBinary: anObject
	"Answer a Collection with binary values of the receiver on <anObject>."

	 ^(anObject ifTrue: [1] ifFalse: [0]) 
			asCharacter asString
! !

SSHMessageFieldBoolean initializeAfterLoad!


SSHMessageField subclass: #SSHMessageFieldByte
    instanceVariableNames: ''
    classVariableNames: ''
    poolDictionaries: ''!

!SSHMessageFieldByte publicMethods !

fromBinary: aStream
	
	 ^aStream next value!

toBinary: anObject
	"Answer a Collection with binary values of the receiver on <anObject>."

	^anObject asCharacter asString
! !

SSHMessageFieldByte initializeAfterLoad!


SSHMessageField subclass: #SSHMessageFieldFixedString
    instanceVariableNames: 'size '
    classVariableNames: ''
    poolDictionaries: ''!

!SSHMessageFieldFixedString class publicMethods !

for: aSymbol size: anInteger

	^self new
		selector: aSymbol;
	 	size: anInteger;
		yourself! !

!SSHMessageFieldFixedString publicMethods !

fromBinary: aStream
	
	 ^aStream next: size
!

size

	^size!

size: anObject

	size := anObject!

toBinary: anObject
	"Answer a Collection with binary values of the receiver on <anObject>."
	
	^anObject! !

SSHMessageFieldFixedString initializeAfterLoad!


SSHMessageField subclass: #SSHMessageFieldHole
    instanceVariableNames: 'contents '
    classVariableNames: ''
    poolDictionaries: ''!

!SSHMessageFieldHole class publicMethods !

for: aString

	^self new
		contents: aString;
		yourself! !

!SSHMessageFieldHole publicMethods !

build: anObject from: aStream
	
	aStream next: contents size!

contents

	^contents!

contents: anObject

	contents := anObject!

contentsFor: anObject

	^contents! !

SSHMessageFieldHole initializeAfterLoad!


SSHMessageField subclass: #SSHMessageFieldInteger
    instanceVariableNames: ''
    classVariableNames: ''
    poolDictionaries: ''!

!SSHMessageFieldInteger publicMethods !

fromBinary: aStream
	
	 ^(aStream next: 4) sshLong!

toBinary: anObject
	"Answer a Collection with binary values of the receiver on <anObject>."

	^self integerToString: anObject! !

SSHMessageFieldInteger initializeAfterLoad!


SSHMessageField subclass: #SSHMessageFieldString
    instanceVariableNames: ''
    classVariableNames: ''
    poolDictionaries: ''!

!SSHMessageFieldString publicMethods !

fromBinary: aStream
	
	| length |
	length := (aStream next: 4) sshLong.
	^aStream next: length!

toBinary: anObject
	"Answer a Collection with binary values of the receiver on <anObject>."
	
	^self describeString: anObject! !

SSHMessageFieldString initializeAfterLoad!


SSHMessageField subclass: #SSHMessageFieldStringCollection
    instanceVariableNames: ''
    classVariableNames: ''
    poolDictionaries: ''!

!SSHMessageFieldStringCollection publicMethods !

describeCollection: aCollection

	| stream |
	stream := ReadWriteStream on: ''.
	aCollection 
		do: [:each | stream nextPutAll: each]	
		separatedBy: [stream nextPut: $,].
	^(self integerToString: stream contents size), stream contents


!

descriptionIn: aString at: anInteger

	| start length result |
	start := 1.
	length := 0.
	anInteger timesRepeat: [
		start := start + length.
		length := aString sshLongAt: 1 from: start.
		start := start + 4].
	result := aString copyFrom: start to: start + length - 1.
	^result isEmpty ifTrue: [#()] ifFalse: [result subStrings: $,]!

fromBinary: aStream
	
	| length |
	length := (aStream next: 4) sshLong.
	^(aStream next: length) subStrings: $,!

toBinary: anObject
	"Answer a Collection with binary values of the receiver on <anObject>."

	^self describeCollection: anObject! !

SSHMessageFieldStringCollection initializeAfterLoad!